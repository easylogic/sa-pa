import{createClass as e,classCallCheck as t,defineProperty as i,toConsumableArray as n,slicedToArray as l}from"../_virtual/_rollupPluginBabelHelpers.js";import{DomDiff as r}from"./DomDiff.js";var s=function(){function s(e,i,n){if(t(this,s),"string"!=typeof e)this.el=e;else{var l=document.createElement(e);for(var r in i&&(l.className=i),n=n||{})l.setAttribute(r,n[r]);this.el=l}}return e(s,[{key:"setAttr",value:function(e){var t=this;return Object.keys(e).forEach((function(i){t.attr(i,e[i])})),this}},{key:"setAttrNS",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"http://www.w3.org/2000/svg";return Object.keys(e).forEach((function(n){t.attr(n,e[n],i)})),this}},{key:"setProp",value:function(e){var t=this;return Object.keys(e).forEach((function(i){t.el[i]!=e[i]&&(t.el[i]=e[i])})),this}},{key:"data",value:function(e,t){return 1===arguments.length?this.attr("data-"+e):2===arguments.length?this.attr("data-"+e,t):this}},{key:"attr",value:function(e,t){return 1==arguments.length?this.el.getAttribute(e):(this.el.getAttribute(e)!=t&&this.el.setAttribute(e,t),this)}},{key:"attrNS",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"http://www.w3.org/2000/svg";return 1==arguments.length?this.el.getAttributeNS(i,e):(this.el.getAttributeNS(i,e)!=t&&this.el.setAttributeNS(i,e,t),this)}},{key:"attrKeyValue",value:function(e){return i({},this.el.getAttribute(e),this.val())}},{key:"attrs",value:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return i.map((function(t){return e.el.getAttribute(t)}))}},{key:"styles",value:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return i.map((function(t){return e.el.style[t]}))}},{key:"removeAttr",value:function(e){return this.el.removeAttribute(e),this}},{key:"removeStyle",value:function(e){return this.el.style.removeProperty(e),this}},{key:"is",value:function(e){return this.el===(e.el||e)}},{key:"isTag",value:function(e){return this.el.tagName.toLowerCase()===e.toLowerCase()}},{key:"closest",value:function(e){for(var t=this,i=!1;!(i=t.hasClass(e));){if(!t.el.parentNode)return null;t=s.create(t.el.parentNode)}return i?t:null}},{key:"path",value:function(){if(!this.el)return[];var e=this.parent();return e?[].concat(n(e.path()),[this]):[this]}},{key:"parent",value:function(){return s.create(this.el.parentNode)}},{key:"hasParent",value:function(){return!!this.el.parentNode}},{key:"removeClass",value:function(){var e;return(e=this.el.classList).remove.apply(e,arguments),this}},{key:"hasClass",value:function(e){return!!this.el.classList&&this.el.classList.contains(e)}},{key:"addClass",value:function(){var e;return(e=this.el.classList).add.apply(e,arguments),this}},{key:"onlyOneClass",value:function(e){this.parent().children().forEach((function(t){t.removeClass(e)})),this.addClass(e)}},{key:"toggleClass",value:function(e,t){return this.el.classList.toggle(e,t),this}},{key:"html",value:function(e){return void 0===e?this.el.innerHTML:("string"==typeof e?this.el.innerHTML=e:this.empty().append(e),this)}},{key:"htmlDiff",value:function(e){r(this,e)}},{key:"updateDiff",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div";r(this,s.create(t).html(e))}},{key:"updateSVGDiff",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div";r(this,s.create(t).html("<svg>".concat(e,"</svg>")).firstChild.firstChild)}},{key:"find",value:function(e){return this.el.querySelector(e)}},{key:"$",value:function(e){var t=this.find(e);return t?s.create(t):null}},{key:"findAll",value:function(e){return n(this.el.querySelectorAll(e))}},{key:"$$",value:function(e){return this.findAll(e).map((function(e){return s.create(e)}))}},{key:"empty",value:function(){for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild);return this}},{key:"append",value:function(e){return"string"==typeof e?this.el.appendChild(document.createTextNode(e)):this.el.appendChild(e.el||e),this}},{key:"prepend",value:function(e){return"string"==typeof e?this.el.prepend(document.createTextNode(e)):this.el.prepend(e.el||e),this}},{key:"prependHTML",value:function(e){var t=s.create("div").html(e);return this.prepend(t.createChildrenFragment()),t}},{key:"appendHTML",value:function(e){var t=s.create("div").html(e);return this.append(t.createChildrenFragment()),t}},{key:"createChildrenFragment",value:function(){var e=this.children(),t=document.createDocumentFragment();return e.forEach((function(e){return t.appendChild(e.el)})),t}},{key:"appendTo",value:function(e){return(e.el?e.el:e).appendChild(this.el),this}},{key:"remove",value:function(){return this.el.parentNode&&this.el.parentNode.removeChild(this.el),this}},{key:"removeChild",value:function(e){return this.el.removeChild(e.el||e),this}},{key:"text",value:function(e){if(void 0===e)return this.el.textContent;var t=e;return e instanceof s&&(t=e.text()),this.el.textContent!==t&&(this.el.textContent=t),this}},{key:"css",value:function(e,t){var i=this;if(void 0!==e&&void 0!==t)0===e.indexOf("--")&&void 0!==t?this.el.style.setProperty(e,t):this.el.style[e]=t;else if(void 0!==e){if("string"==typeof e)return getComputedStyle(this.el)[e];Object.entries(e).forEach((function(e){var t=l(e,2),n=t[0],r=t[1];0===n.indexOf("--")&&void 0!==r?i.el.style.setProperty(n,r):i.el.style[n]=r}))}return this}},{key:"getComputedStyle",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){for(var e=getComputedStyle(this.el),t={},i=arguments.length,n=new Array(i),l=0;l<i;l++)n[l]=arguments[l];return n.forEach((function(i){t[i]=e[i]})),t}))},{key:"getStyleList",value:function(){for(var e=this,t={},i=this.el.style.length,n=0;n<i;n++){var l=this.el.style[n];t[l]=this.el.style[l]}for(var r=arguments.length,s=new Array(r),u=0;u<r;u++)s[u]=arguments[u];return s.forEach((function(i){t[i]=e.css(i)})),t}},{key:"cssText",value:function(e){return void 0===e?this.el.style.cssText:(e!=this.el.tempCssText&&(this.el.style.cssText=e,this.el.tempCssText=e),this)}},{key:"cssArray",value:function(e){return e[0]&&(this.el.style[e[0]]=e[1]),e[2]&&(this.el.style[e[2]]=e[3]),e[4]&&(this.el.style[e[4]]=e[5]),e[6]&&(this.el.style[e[6]]=e[7]),e[8]&&(this.el.style[e[8]]=e[9]),this}},{key:"cssFloat",value:function(e){return parseFloat(this.css(e))}},{key:"cssInt",value:function(e){return parseInt(this.css(e))}},{key:"px",value:function(e,t){return this.css(e,"".concat(t,"px"))}},{key:"rect",value:function(){return this.el.getBoundingClientRect()}},{key:"bbox",value:function(){return this.el.getBBox()}},{key:"isSVG",value:function(){return"SVG"===this.el.tagName.toUpperCase()}},{key:"offsetRect",value:function(){if(this.isSVG()){var e=this.parent().rect(),t=this.rect();return{x:t.x-e.x,y:t.y-e.y,top:t.x-e.x,left:t.y-e.y,width:t.width,height:t.height}}return{x:this.el.offsetLeft,y:this.el.offsetTop,top:this.el.offsetTop,left:this.el.offsetLeft,width:this.el.offsetWidth,height:this.el.offsetHeight}}},{key:"offset",value:function(){var e=this.rect(),t=s.getScrollTop(),i=s.getScrollLeft();return{top:e.top+t,left:e.left+i}}},{key:"offsetLeft",value:function(){return this.offset().left}},{key:"offsetTop",value:function(){return this.offset().top}},{key:"position",value:function(){return this.el.style.top?{top:parseFloat(this.css("top")),left:parseFloat(this.css("left"))}:this.rect()}},{key:"size",value:function(){return[this.width(),this.height()]}},{key:"width",value:function(){return this.el.offsetWidth||this.rect().width}},{key:"contentWidth",value:function(){return this.width()-this.cssFloat("padding-left")-this.cssFloat("padding-right")}},{key:"height",value:function(){return this.el.offsetHeight||this.rect().height}},{key:"contentHeight",value:function(){return this.height()-this.cssFloat("padding-top")-this.cssFloat("padding-bottom")}},{key:"val",value:function(e){if(void 0===e)return this.el.value;if(void 0!==e){var t=e;e instanceof s&&(t=e.val()),this.el.value=t}return this}},{key:"matches",value:function(e){return this.el&&this.el.matches?this.el.matches(e)?this:this.parent().matches(e):null}},{key:"value",get:function(){return this.el.value}},{key:"naturalWidth",get:function(){return this.el.naturalWidth}},{key:"naturalHeight",get:function(){return this.el.naturalHeight}},{key:"files",get:function(){return this.el.files?n(this.el.files):[]}},{key:"realVal",value:function(){switch(this.el.nodeType){case"INPUT":var e=this.attr("type");if("checkbox"==e||"radio"==e)return this.checked();case"SELECT":case"TEXTAREA":return this.el.value}return""}},{key:"int",value:function(){return parseInt(this.val(),10)}},{key:"float",value:function(){return parseFloat(this.val())}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"block";return this.el.style.display="none"!=e?e:"block",this}},{key:"hide",value:function(){return this.el.style.display="none",this}},{key:"isHide",value:function(){return"none"===this.el.style.display}},{key:"isShow",value:function(){return!this.isHide()}},{key:"toggle",value:function(e){var t=this.isHide();return 1==arguments.length?e?this.show():this.hide():t?this.show():this.hide()}},{key:"totalLength",get:function(){return this.el.getTotalLength()}},{key:"scrollIntoView",value:function(){this.el.scrollIntoView()}},{key:"addScrollLeft",value:function(e){return this.el.scrollLeft+=e,this}},{key:"addScrollTop",value:function(e){return this.el.scrollTop+=e,this}},{key:"setScrollTop",value:function(e){return this.el.scrollTop=e,this}},{key:"setScrollLeft",value:function(e){return this.el.scrollLeft=e,this}},{key:"scrollTop",value:function(){return this.el===document.body?s.getScrollTop():this.el.scrollTop}},{key:"scrollLeft",value:function(){return this.el===document.body?s.getScrollLeft():this.el.scrollLeft}},{key:"scrollHeight",value:function(){return this.el.scrollHeight}},{key:"scrollWidth",value:function(){return this.el.scrollWidth}},{key:"on",value:function(e,t,i,n){return this.el.addEventListener(e,t,i,n),this}},{key:"off",value:function(e,t){return this.el.removeEventListener(e,t),this}},{key:"getElement",value:function(){return this.el}},{key:"createChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=s.create(e,t,i);return l.css(n),this.append(l),l}},{key:"firstChild",get:function(){return s.create(this.el.firstElementChild)}},{key:"children",value:function(){var e=this.el.firstElementChild;if(!e)return[];var t=[];do{t.push(s.create(e)),e=e.nextElementSibling}while(e);return t}},{key:"childLength",value:function(){return this.el.children.length}},{key:"replace",value:function(e){return this.el.parentNode&&this.el.parentNode.replaceChild(e.el||e,this.el),this}},{key:"replaceChild",value:function(e,t){return this.el.replaceChild(t.el||t,e.el||e),this}},{key:"checked",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return 0==arguments.length?!!this.el.checked:(this.el.checked=!!e,this)}},{key:"click",value:function(){return this.el.click(),this}},{key:"focus",value:function(){return this.el.focus(),this}},{key:"select",value:function(){if("true"===this.attr("contenteditable")){var e=document.createRange();e.selectNodeContents(this.el);var t=window.getSelection();t.removeAllRanges(),t.addRange(e)}else this.el.select();return this}},{key:"blur",value:function(){return this.el.blur(),this}},{key:"context",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"2d";return this._initContext||(this._initContext=this.el.getContext(e)),this._initContext}},{key:"resize",value:function(e){var t=e.width,i=e.height;this._initContext=null;var n=this.context(),l=window.devicePixelRatio||1;this.px("width",+t),this.px("height",+i),this.el.width=t*l,this.el.height=i*l,n.scale(l,l)}},{key:"toDataURL",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/png",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.el.toDataURL(e,t)}},{key:"clear",value:function(){this.context().clearRect(0,0,this.el.width,this.el.height)}},{key:"update",value:function(e){this.clear(),e.call(this,this)}},{key:"drawImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this.context(),l=window.devicePixelRatio||1;n.drawImage(e,t,i,e.width,e.height,0,0,this.el.width/l,this.el.height/l)}},{key:"drawOption",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.context();Object.assign(t,e)}},{key:"drawLine",value:function(e,t,i,n){var l=this.context();l.beginPath(),l.moveTo(e,t),l.lineTo(i,n),l.stroke(),l.closePath()}},{key:"drawPath",value:function(){var e=this.context();e.beginPath();for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];i.forEach((function(t,i){0==i?e.moveTo(t[0],t[1]):e.lineTo(t[0],t[1])})),e.stroke(),e.fill(),e.closePath()}},{key:"drawCircle",value:function(e,t,i){var n=this.context();n.beginPath(),n.arc(e,t,i,0,2*Math.PI),n.stroke(),n.fill()}},{key:"drawText",value:function(e,t,i){this.context().fillText(i,e,t)}}],[{key:"create",value:function(e,t,i){return new s(e,t,i)}},{key:"createByHTML",value:function(e){var t=s.create("div").html(e).children();return t.length?s.create(t[0].el):null}},{key:"getScrollTop",value:function(){return Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop)}},{key:"getScrollLeft",value:function(){return Math.max(window.pageXOffset,document.documentElement.scrollLeft,document.body.scrollLeft)}},{key:"parse",value:function(e){return DOMParser().parseFromString(e,"text/htmll")}},{key:"body",value:function(){return s.create(document.body)}}]),s}();export{s as default};
