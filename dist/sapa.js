!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).sapa=t()}(this,(function(){"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function t(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?e(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t,n,r,i,o,a){try{var l=e[o](a),u=l.value}catch(e){return void n(e)}l.done?t(u):Promise.resolve(u).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var a=e.apply(t,n);function l(e){r(a,i,o,l,u,"next",e)}function u(e){r(a,i,o,l,u,"throw",e)}l(void 0)}))}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var i=c(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f(this,n)}}function d(e,t,n){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function y(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function p(e,t){return k(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,o=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){l=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(l)throw i}}return o}(e,t)||E(e,t)||C()}function g(e){return k(e)||b(e)||E(e)||C()}function m(e){return function(e){if(Array.isArray(e))return T(e)}(e)||b(e)||E(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e){if(Array.isArray(e))return e}function b(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function E(e,t){if(e){if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(e,t):void 0}}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function C(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var A="@magic:",O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return" ".concat(t," ").concat(e)},w=/domevent (.*)/gi,S=/load (.*)/gi,x=/bind (.*)/gi,N=/subscribe (.*)/gi,R=":",M="|",_="".concat(A,"domevent "),D="".concat(A,"load "),P="".concat(A,"bind "),L="".concat(A,"subscribe "),I=" ",j={},U=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.join(R);return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return _+[r].concat(t).join(I)}},B=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return L+t.join(M)},$=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return O(e,t)},H=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return O("after(".concat(e,")"),t)},F=$,V=$,K=$("ArrowUp"),G=$("ArrowDown"),z=$("ArrowLeft"),W=$("ArrowRight"),X=$("Enter"),Y=$("Space"),q=$("Escape"),J=$("isAltKey"),Z=$("isShiftKey"),Q=$("isMetaKey"),ee=$("isCtrlKey"),te=$("hasMouse"),ne=$("hasTouch"),re=$("hasPen"),ie=$("self"),oe=$("isMouseLeftButton"),ae=$("isMouseRightButton"),le=$("fit"),ue=$("passive"),se=$("domdiff"),ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return $("debounce(".concat(e,")"))},he=ce(1e3),fe=$("allTrigger()"),ve=$("selfTrigger()"),de=$("capture()"),ye=H("preventDefault"),pe=H("stopPropagation"),ge=B,me=U,ke=U("click"),be=U("dblclick"),Ee=U("mousedown"),Te=U("mouseup"),Ce=U("mousemove"),Ae=U("mouseover"),Oe=U("mouseout"),we=U("mouseenter"),Se=U("mouseleave"),xe=U("touchstart"),Ne=U("touchmove"),Re=U("touchend"),Me=U("keydown"),_e=U("keyup"),De=U("keypress"),Pe=U("drag"),Le=U("dragstart"),Ie=U("drop"),je=U("dragover"),Ue=U("dragenter"),Be=U("dragleave"),$e=U("dragexit"),He=U("dragout"),Fe=U("dragend"),Ve=U("contextmenu"),Ke=U("change"),Ge=U("input"),ze=U("focus"),We=U("focusin"),Xe=U("focusout"),Ye=U("blur"),qe=U("paste"),Je=U("resize"),Ze=U("scroll"),Qe=U("submit"),et=me("pointerover"),tt=me("pointerenter"),nt=me("pointerout"),rt=me("pointermove"),it=me("pointerup"),ot=me("change","input"),at=me("wheel","mousewheel","DOMMouseScroll"),lt=U("animationstart"),ut=U("animationend"),st=U("animationiteration"),ct=U("transitionstart"),ht=U("transitionend"),ft=U("transitionrun"),vt=U("transitioncancel"),dt=me("doubletab"),yt=function(e){return j[e]||""},pt=function(e){return function(){return this.prevState[e]!=this.state[e]}},gt=function(){return!0};function mt(e,t){return Math.sign(e)*Math.min(t,Math.abs(e))}var kt={addDomEvent:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e&&e.addEventListener(t,n,r)},removeDomEvent:function(e,t,n){e&&e.removeEventListener(t,n)},pos:function(e){return e.touches&&e.touches[0]?e.touches[0]:e},posXY:function(e){var t=this.pos(e);return{x:t.pageX,y:t.pageY}}},bt=Object.freeze({__proto__:null,MAGIC_METHOD:A,makeEventChecker:O,CHECK_DOM_EVENT_PATTERN:w,CHECK_LOAD_PATTERN:S,CHECK_BIND_PATTERN:x,CHECK_SUBSCRIBE_PATTERN:N,PIPE:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.join("|")},NAME_SAPARATOR:R,CHECK_SAPARATOR:M,DOM_EVENT_SAPARATOR:_,LOAD_SAPARATOR:D,BIND_SAPARATOR:P,SUBSCRIBE_SAPARATOR:L,SAPARATOR:I,CHECKER:$,AFTER:H,BEFORE:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return O("before(".concat(e,")"),t)},IF:F,KEY:V,ARROW_UP:K,ARROW_DOWN:G,ARROW_LEFT:z,ARROW_RIGHT:W,ENTER:X,SPACE:Y,ESCAPE:q,ALT:J,SHIFT:Z,META:Q,CONTROL:ee,MOUSE:te,TOUCH:ne,PEN:re,SELF:ie,LEFT_BUTTON:oe,RIGHT_BUTTON:ae,FIT:le,PASSIVE:ue,DOMDIFF:se,DEBOUNCE:ce,DELAY:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300;return $("delay(".concat(e,")"))},D1000:he,THROTTLE:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return $("throttle(".concat(e,")"))},ALL_TRIGGER:fe,SELF_TRIGGER:ve,CAPTURE:de,PREVENT:ye,STOP:pe,SUBSCRIBE:ge,SUBSCRIBE_ALL:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return B.apply(void 0,t.concat([fe]))},SUBSCRIBE_SELF:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return B.apply(void 0,t.concat([ve]))},CONFIG:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return B.apply(void 0,["config:".concat(e)].concat(n))},CUSTOM:me,CLICK:ke,DOUBLECLICK:be,MOUSEDOWN:Ee,MOUSEUP:Te,MOUSEMOVE:Ce,MOUSEOVER:Ae,MOUSEOUT:Oe,MOUSEENTER:we,MOUSELEAVE:Se,TOUCHSTART:xe,TOUCHMOVE:Ne,TOUCHEND:Re,KEYDOWN:Me,KEYUP:_e,KEYPRESS:De,DRAG:Pe,DRAGSTART:Le,DROP:Ie,DRAGOVER:je,DRAGENTER:Ue,DRAGLEAVE:Be,DRAGEXIT:$e,DRAGOUT:He,DRAGEND:Fe,CONTEXTMENU:Ve,CHANGE:Ke,INPUT:Ge,FOCUS:ze,FOCUSIN:We,FOCUSOUT:Xe,BLUR:Ye,PASTE:qe,RESIZE:Je,SCROLL:Ze,SUBMIT:Qe,POINTERSTART:function(){return me("pointerdown").apply(void 0,arguments)+oe},POINTEROVER:et,POINTERENTER:tt,POINTEROUT:nt,POINTERMOVE:rt,POINTEREND:it,CHANGEINPUT:ot,WHEEL:at,ANIMATIONSTART:lt,ANIMATIONEND:ut,ANIMATIONITERATION:st,TRANSITIONSTART:ct,TRANSITIONEND:ht,TRANSITIONRUN:ft,TRANSITIONCANCEL:vt,DOUBLETAB:dt,LOAD:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"$el";return D+e},getRef:yt,BIND_CHECK_FUNCTION:pt,BIND_CHECK_DEFAULT_FUNCTION:gt,BIND:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"$el";return P+e},normalizeWheelEvent:function(e){var t=e.deltaX,n=e.deltaY;if(0===t&&e.shiftKey){var r=[t,n];n=r[0],t=r[1]}return e.deltaMode===WheelEvent.DOM_DELTA_LINE?n*=8:e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(n*=24),[mt(t,24),mt(n,24),0]},default:kt}),Et=function(e,t,n,r){n?r&&n===r||function(e,t,n){"boolean"==typeof n?function(e,t,n){n?(e.setAttribute(t,t),e[t]=n):(e.removeAttribute(t),e[t]=n)}(e,t,n):e.setAttribute(t,n)}(e,t,n):function(e,t,n){"boolean"==typeof n?function(e,t){e.removeAttribute(t),e[t]=!1}(e,t):t&&function(e,t){e.removeAttribute(t)}(e,t)}(e,t,r)};function Tt(e){return e.nodeType!==Node.TEXT_NODE&&"true"===e.getAttribute("data-domdiff-pass")}function Ct(e){for(var t={},n=e.length,r=0;r<n;r++){var i=e[r];t[i.name]=i.value}return t}function At(e,t,n,r){if(t)if(n){if(Tt(t)||Tt(n));else if(u=t,(l=n).nodeType===Node.TEXT_NODE&&l.textContent!==u.textContent||l.nodeName!==u.nodeName||function(e){return e.nodeType!==Node.TEXT_NODE&&e.getAttribute("refClass")}(n))e.replaceChild(n.cloneNode(!0),t);else if(n.nodeType!==Node.TEXT_NODE&&n.nodeType!==Node.COMMENT_NODE&&"[object HTMLUnknownElement]"!==n.toString()){!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[];r.push.apply(r,Object.keys(t)),r.push.apply(r,Object.keys(n));for(var i=m(new Set(r)),o=0,a=i.length;o<a;o++){var l=i[o];Et(e,l,t[l],n[l])}}(t,Ct(n.attributes),Ct(t.attributes));var i=Ot(t),o=Ot(n),a=Math.max(i.length,o.length);for(r=0;r<a;r++)At(t,i[r],o[r],r)}}else e.removeChild(t);else e.appendChild(n.cloneNode(!0));var l,u}var Ot=function(e){var t=e.firstChild;if(!t)return[];var n=[];do{n.push(t),t=t.nextSibling}while(t);return n};function wt(e,t){e=e.el||e,t=t.el||t;for(var n=Ot(e),r=Ot(t),i=Math.max(n.length,r.length),o=0;o<i;o++)At(e,n[o],r[o],o)}var St,xt=function(){function e(t,n,r){if(o(this,e),"string"!=typeof t)this.el=t;else{var i=document.createElement(t);for(var a in n&&(i.className=n),r=r||{})i.setAttribute(a,r[a]);this.el=i}}return l(e,[{key:"setAttr",value:function(e){var t=this;return Object.keys(e).forEach((function(n){t.attr(n,e[n])})),this}},{key:"setAttrNS",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"http://www.w3.org/2000/svg";return Object.keys(e).forEach((function(r){t.attr(r,e[r],n)})),this}},{key:"setProp",value:function(e){var t=this;return Object.keys(e).forEach((function(n){t.el[n]!=e[n]&&(t.el[n]=e[n])})),this}},{key:"data",value:function(e,t){return 1===arguments.length?this.attr("data-"+e):2===arguments.length?this.attr("data-"+e,t):this}},{key:"attr",value:function(e,t){return 1==arguments.length?this.el.getAttribute(e):(this.el.getAttribute(e)!=t&&this.el.setAttribute(e,t),this)}},{key:"attrNS",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"http://www.w3.org/2000/svg";return 1==arguments.length?this.el.getAttributeNS(n,e):(this.el.getAttributeNS(n,e)!=t&&this.el.setAttributeNS(n,e,t),this)}},{key:"attrKeyValue",value:function(e){return u({},this.el.getAttribute(e),this.val())}},{key:"attrs",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.map((function(t){return e.el.getAttribute(t)}))}},{key:"styles",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.map((function(t){return e.el.style[t]}))}},{key:"removeAttr",value:function(e){return this.el.removeAttribute(e),this}},{key:"removeStyle",value:function(e){return this.el.style.removeProperty(e),this}},{key:"is",value:function(e){return this.el===(e.el||e)}},{key:"isTag",value:function(e){return this.el.tagName.toLowerCase()===e.toLowerCase()}},{key:"closest",value:function(t){for(var n=this,r=!1;!(r=n.hasClass(t));){if(!n.el.parentNode)return null;n=e.create(n.el.parentNode)}return r?n:null}},{key:"path",value:function(){if(!this.el)return[];var e=this.parent();return e?[].concat(m(e.path()),[this]):[this]}},{key:"parent",value:function(){return e.create(this.el.parentNode)}},{key:"hasParent",value:function(){return!!this.el.parentNode}},{key:"removeClass",value:function(){var e;return(e=this.el.classList).remove.apply(e,arguments),this}},{key:"hasClass",value:function(e){return!!this.el.classList&&this.el.classList.contains(e)}},{key:"addClass",value:function(){var e;return(e=this.el.classList).add.apply(e,arguments),this}},{key:"onlyOneClass",value:function(e){this.parent().children().forEach((function(t){t.removeClass(e)})),this.addClass(e)}},{key:"toggleClass",value:function(e,t){return this.el.classList.toggle(e,t),this}},{key:"html",value:function(e){return void 0===e?this.el.innerHTML:("string"==typeof e?this.el.innerHTML=e:this.empty().append(e),this)}},{key:"htmlDiff",value:function(e){wt(this,e)}},{key:"updateDiff",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div";wt(this,e.create(n).html(t))}},{key:"updateSVGDiff",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div";wt(this,e.create(n).html("<svg>".concat(t,"</svg>")).firstChild.firstChild)}},{key:"find",value:function(e){return this.el.querySelector(e)}},{key:"$",value:function(t){var n=this.find(t);return n?e.create(n):null}},{key:"findAll",value:function(e){return m(this.el.querySelectorAll(e))}},{key:"$$",value:function(t){return this.findAll(t).map((function(t){return e.create(t)}))}},{key:"empty",value:function(){for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild);return this}},{key:"append",value:function(e){return"string"==typeof e?this.el.appendChild(document.createTextNode(e)):this.el.appendChild(e.el||e),this}},{key:"prepend",value:function(e){return"string"==typeof e?this.el.prepend(document.createTextNode(e)):this.el.prepend(e.el||e),this}},{key:"prependHTML",value:function(t){var n=e.create("div").html(t);return this.prepend(n.createChildrenFragment()),n}},{key:"appendHTML",value:function(t){var n=e.create("div").html(t);return this.append(n.createChildrenFragment()),n}},{key:"createChildrenFragment",value:function(){var e=this.children(),t=document.createDocumentFragment();return e.forEach((function(e){return t.appendChild(e.el)})),t}},{key:"appendTo",value:function(e){return(e.el?e.el:e).appendChild(this.el),this}},{key:"remove",value:function(){return this.el.parentNode&&this.el.parentNode.removeChild(this.el),this}},{key:"removeChild",value:function(e){return this.el.removeChild(e.el||e),this}},{key:"text",value:function(t){if(void 0===t)return this.el.textContent;var n=t;return t instanceof e&&(n=t.text()),this.el.textContent!==n&&(this.el.textContent=n),this}},{key:"css",value:function(e,t){var n=this;if(void 0!==e&&void 0!==t)0===e.indexOf("--")&&void 0!==t?this.el.style.setProperty(e,t):this.el.style[e]=t;else if(void 0!==e){if("string"==typeof e)return getComputedStyle(this.el)[e];Object.entries(e).forEach((function(e){var t=p(e,2),r=t[0],i=t[1];0===r.indexOf("--")&&void 0!==i?n.el.style.setProperty(r,i):n.el.style[r]=i}))}return this}},{key:"getComputedStyle",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){for(var e=getComputedStyle(this.el),t={},n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return r.forEach((function(n){t[n]=e[n]})),t}))},{key:"getStyleList",value:function(){for(var e=this,t={},n=this.el.style.length,r=0;r<n;r++){var i=this.el.style[r];t[i]=this.el.style[i]}for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return a.forEach((function(n){t[n]=e.css(n)})),t}},{key:"cssText",value:function(e){return void 0===e?this.el.style.cssText:(e!=this.el.tempCssText&&(this.el.style.cssText=e,this.el.tempCssText=e),this)}},{key:"cssArray",value:function(e){return e[0]&&(this.el.style[e[0]]=e[1]),e[2]&&(this.el.style[e[2]]=e[3]),e[4]&&(this.el.style[e[4]]=e[5]),e[6]&&(this.el.style[e[6]]=e[7]),e[8]&&(this.el.style[e[8]]=e[9]),this}},{key:"cssFloat",value:function(e){return parseFloat(this.css(e))}},{key:"cssInt",value:function(e){return parseInt(this.css(e))}},{key:"px",value:function(e,t){return this.css(e,"".concat(t,"px"))}},{key:"rect",value:function(){return this.el.getBoundingClientRect()}},{key:"bbox",value:function(){return this.el.getBBox()}},{key:"isSVG",value:function(){return"SVG"===this.el.tagName.toUpperCase()}},{key:"offsetRect",value:function(){if(this.isSVG()){var e=this.parent().rect(),t=this.rect();return{x:t.x-e.x,y:t.y-e.y,top:t.x-e.x,left:t.y-e.y,width:t.width,height:t.height}}return{x:this.el.offsetLeft,y:this.el.offsetTop,top:this.el.offsetTop,left:this.el.offsetLeft,width:this.el.offsetWidth,height:this.el.offsetHeight}}},{key:"offset",value:function(){var t=this.rect(),n=e.getScrollTop(),r=e.getScrollLeft();return{top:t.top+n,left:t.left+r}}},{key:"offsetLeft",value:function(){return this.offset().left}},{key:"offsetTop",value:function(){return this.offset().top}},{key:"position",value:function(){return this.el.style.top?{top:parseFloat(this.css("top")),left:parseFloat(this.css("left"))}:this.rect()}},{key:"size",value:function(){return[this.width(),this.height()]}},{key:"width",value:function(){return this.el.offsetWidth||this.rect().width}},{key:"contentWidth",value:function(){return this.width()-this.cssFloat("padding-left")-this.cssFloat("padding-right")}},{key:"height",value:function(){return this.el.offsetHeight||this.rect().height}},{key:"contentHeight",value:function(){return this.height()-this.cssFloat("padding-top")-this.cssFloat("padding-bottom")}},{key:"val",value:function(t){if(void 0===t)return this.el.value;if(void 0!==t){var n=t;t instanceof e&&(n=t.val()),this.el.value=n}return this}},{key:"matches",value:function(e){return this.el&&this.el.matches?this.el.matches(e)?this:this.parent().matches(e):null}},{key:"value",get:function(){return this.el.value}},{key:"naturalWidth",get:function(){return this.el.naturalWidth}},{key:"naturalHeight",get:function(){return this.el.naturalHeight}},{key:"files",get:function(){return this.el.files?m(this.el.files):[]}},{key:"realVal",value:function(){switch(this.el.nodeType){case"INPUT":var e=this.attr("type");if("checkbox"==e||"radio"==e)return this.checked();case"SELECT":case"TEXTAREA":return this.el.value}return""}},{key:"int",value:function(){return parseInt(this.val(),10)}},{key:"float",value:function(){return parseFloat(this.val())}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"block";return this.el.style.display="none"!=e?e:"block",this}},{key:"hide",value:function(){return this.el.style.display="none",this}},{key:"isHide",value:function(){return"none"===this.el.style.display}},{key:"isShow",value:function(){return!this.isHide()}},{key:"toggle",value:function(e){var t=this.isHide();return 1==arguments.length?e?this.show():this.hide():t?this.show():this.hide()}},{key:"totalLength",get:function(){return this.el.getTotalLength()}},{key:"scrollIntoView",value:function(){this.el.scrollIntoView()}},{key:"addScrollLeft",value:function(e){return this.el.scrollLeft+=e,this}},{key:"addScrollTop",value:function(e){return this.el.scrollTop+=e,this}},{key:"setScrollTop",value:function(e){return this.el.scrollTop=e,this}},{key:"setScrollLeft",value:function(e){return this.el.scrollLeft=e,this}},{key:"scrollTop",value:function(){return this.el===document.body?e.getScrollTop():this.el.scrollTop}},{key:"scrollLeft",value:function(){return this.el===document.body?e.getScrollLeft():this.el.scrollLeft}},{key:"scrollHeight",value:function(){return this.el.scrollHeight}},{key:"scrollWidth",value:function(){return this.el.scrollWidth}},{key:"on",value:function(e,t,n,r){return this.el.addEventListener(e,t,n,r),this}},{key:"off",value:function(e,t){return this.el.removeEventListener(e,t),this}},{key:"getElement",value:function(){return this.el}},{key:"createChild",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=e.create(t,n,r);return o.css(i),this.append(o),o}},{key:"firstChild",get:function(){return e.create(this.el.firstElementChild)}},{key:"children",value:function(){var t=this.el.firstElementChild;if(!t)return[];var n=[];do{n.push(e.create(t)),t=t.nextElementSibling}while(t);return n}},{key:"childLength",value:function(){return this.el.children.length}},{key:"replace",value:function(e){return this.el.parentNode&&this.el.parentNode.replaceChild(e.el||e,this.el),this}},{key:"replaceChild",value:function(e,t){return this.el.replaceChild(t.el||t,e.el||e),this}},{key:"checked",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return 0==arguments.length?!!this.el.checked:(this.el.checked=!!e,this)}},{key:"click",value:function(){return this.el.click(),this}},{key:"focus",value:function(){return this.el.focus(),this}},{key:"select",value:function(){if("true"===this.attr("contenteditable")){var e=document.createRange();e.selectNodeContents(this.el);var t=window.getSelection();t.removeAllRanges(),t.addRange(e)}else this.el.select();return this}},{key:"blur",value:function(){return this.el.blur(),this}},{key:"context",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"2d";return this._initContext||(this._initContext=this.el.getContext(e)),this._initContext}},{key:"resize",value:function(e){var t=e.width,n=e.height;this._initContext=null;var r=this.context(),i=window.devicePixelRatio||1;this.px("width",+t),this.px("height",+n),this.el.width=t*i,this.el.height=n*i,r.scale(i,i)}},{key:"toDataURL",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/png",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.el.toDataURL(e,t)}},{key:"clear",value:function(){this.context().clearRect(0,0,this.el.width,this.el.height)}},{key:"update",value:function(e){this.clear(),e.call(this,this)}},{key:"drawImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.context(),i=window.devicePixelRatio||1;r.drawImage(e,t,n,e.width,e.height,0,0,this.el.width/i,this.el.height/i)}},{key:"drawOption",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.context();Object.assign(t,e)}},{key:"drawLine",value:function(e,t,n,r){var i=this.context();i.beginPath(),i.moveTo(e,t),i.lineTo(n,r),i.stroke(),i.closePath()}},{key:"drawPath",value:function(){var e=this.context();e.beginPath();for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t,n){0==n?e.moveTo(t[0],t[1]):e.lineTo(t[0],t[1])})),e.stroke(),e.fill(),e.closePath()}},{key:"drawCircle",value:function(e,t,n){var r=this.context();r.beginPath(),r.arc(e,t,n,0,2*Math.PI),r.stroke(),r.fill()}},{key:"drawText",value:function(e,t,n){this.context().fillText(n,e,t)}}],[{key:"create",value:function(t,n,r){return new e(t,n,r)}},{key:"createByHTML",value:function(t){var n=e.create("div").html(t).children();return n.length?e.create(n[0].el):null}},{key:"getScrollTop",value:function(){return Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop)}},{key:"getScrollLeft",value:function(){return Math.max(window.pageXOffset,document.documentElement.scrollLeft,document.body.scrollLeft)}},{key:"parse",value:function(e){return DOMParser().parseFromString(e,"text/htmll")}},{key:"body",value:function(){return e.create(document.body)}}]),e}(),Nt=function(){return!0};function Rt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0===t)return e;var n=void 0;return function(r,i,o,a,l){n&&clearTimeout(n),n=setTimeout((function(){e(r,i,o,a,l)}),t||300)}}function Mt(e,t){var n=void 0;return function(r,i,o,a,l){n||(n=setTimeout((function(){e(r,i,o,a,l),n=null}),t||300))}}function _t(e,t,n){return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];var a=n.every((function(e){return t[e.target].apply(t,i)}));a&&e.apply(t,i)}}function Dt(e,t){Object.keys(e).forEach((function(n,r){t(n,e[n],r)}))}function Pt(e){return!1===function(e){return null==e}(e)}function Lt(e){return"string"==typeof e}function It(e){return"function"==typeof e}var jt=/\<(\w*)([^\>]*)\/\>/gim,Ut=(u(St={image:!0,input:!0,br:!0,path:!0,line:!0,circle:!0,rect:!0},"path",!0),u(St,"polygon",!0),u(St,"polyline",!0),u(St,"use",!0),St),Bt=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=e.map((function(e,t){var r=n[t]||"";return It(r)&&console.log(r),Array.isArray(r)||(r=[r]),e+(r=r.join(""))})).join("");return i=i.replace(jt,(function(e,t){return Ut[t.toLowerCase()]?e:e.replace("/>","></".concat(t,">"))}))},$t=function(e,t){var n=e.filter((function(e){return e.indexOf("".concat(t,"("))>-1})),r=n.map((function(e){var n=p(e.split("".concat(t,"("))[1].split(")")[0].trim().split(" "),2);return{target:n[0],param:n[1]}}));return[n,r]},Ht=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,e),this.context=t,this.options=n}return l(e,[{key:"initialize",value:function(){}},{key:"load",value:function(){}},{key:"refresh",value:function(){}},{key:"render",value:function(){}},{key:"getRef",value:function(e){return this.context.getRef(e)}},{key:"run",value:function(){}},{key:"destroy",value:function(){}}]),e}(),Ft={touchstart:!0,touchmove:!0,mousedown:!0,mouseup:!0,mousemove:!0},Vt={doubletab:"touchend"},Kt={doubletab:!0},Gt=function(e){s(n,e);var t=v(n);function n(){return o(this,n),t.apply(this,arguments)}return l(n,[{key:"initialize",value:function(){var e=this;this.destroy(),this._domEvents||(this._domEvents=this.context.filterProps(w)),this._domEvents.forEach((function(t){return e.parseDomEvent(t)}))}},{key:"destroy",value:function(){this.removeEventAll()}},{key:"removeEventAll",value:function(){var e=this;this.getBindings().forEach((function(t){e.removeDomEvent(t)})),this.initBindings()}},{key:"removeDomEvent",value:function(e){var t=e.eventName,n=e.dom,r=e.callback;kt.removeDomEvent(n,t,r)}},{key:"getBindings",value:function(){return this._bindings||this.initBindings(),this._bindings}},{key:"addBinding",value:function(e){this.getBindings().push(e)}},{key:"initBindings",value:function(){this._bindings=[]}},{key:"matchPath",value:function(e,t){return e?e.matches(t)?e:this.matchPath(e.parentElement,t):null}},{key:"hasDelegate",value:function(e,t){return this.matchPath(e.target||e.srcElement,t.delegate)}},{key:"makeCallback",value:function(e,t){return e.delegate?this.makeDelegateCallback(e,t):this.makeDefaultCallback(e,t)}},{key:"makeDefaultCallback",value:function(e,t){var n=this;return function(r){var i=n.runEventCallback(r,e,t);if(Pt(i))return i}}},{key:"makeDelegateCallback",value:function(e,t){var n=this;return function(r){var i=n.hasDelegate(r,e);if(i){r.$dt=xt.create(i);var o=n.runEventCallback(r,e,t);if(Pt(o))return o}}}},{key:"runEventCallback",value:function(e,t,n){var r=this.context;if(e.xy=kt.posXY(e),t.beforeMethods.length&&t.beforeMethods.every((function(t){return r[t.target].call(r,e,t.param)})),this.checkEventType(e,t)){var i=n(e,e.$dt,e.xy);return!1!==i&&t.afterMethods.length&&t.afterMethods.forEach((function(t){return r[t.target].call(r,e,t.param)})),i}}},{key:"checkEventType",value:function(e,t){var n=this.context,r=!0;t.codes.length&&(r=!!e.code&&t.codes.indexOf(e.code.toLowerCase())>-1||!!e.key&&t.codes.indexOf(e.key.toLowerCase())>-1);var i=!0;return t.checkMethodList.length&&(i=t.checkMethodList.every((function(t){var r=n[t];return It(r)&&r?r.call(n,e):!Pt(r)||!!r}))),r&&i}},{key:"getDefaultDomElement",value:function(e){var t,n=this.context;return(t=e?n.refs[e]||n[e]||window[e]:n.el||n.$el||n.$root)instanceof xt?t.getElement():t}},{key:"getRealEventName",value:function(e){return Vt[e]||e}},{key:"getCustomEventName",value:function(e){return Kt[e]?e:""}},{key:"getDefaultEventObject",value:function(e,t){var n=this.context,r=t,i=r.filter((function(e){return!!n[e]})),o=p($t(r,"after"),2),a=o[0],l=o[1],u=p($t(r,"before"),2),s=u[0],c=u[1],h=p($t(r,"debounce"),2),f=h[0],v=h[1],d=p($t(r,"delay"),2),y=d[0],g=d[1],k=p($t(r,"throttle"),2),b=k[0],E=k[1],T=p($t(r,"capture"),1)[0],C=[].concat(m(i),m(a),m(s),m(y),m(f),m(b),m(T)),A=r.filter((function(e){return-1===C.indexOf(e)})).map((function(e){return e.toLowerCase()}));return{eventName:this.getRealEventName(e),customEventName:this.getCustomEventName(e),codes:A,captures:T,afterMethods:l,beforeMethods:c,delayMethods:g,debounceMethods:v,throttleMethods:E,checkMethodList:i}}},{key:"addDomEvent",value:function(e,t){e.callback=this.makeCallback(e,t),this.addBinding(e);var n=!!e.captures.length;Ft[e.eventName]&&(n={passive:!0,capture:n}),kt.addDomEvent(e.dom,e.eventName,e.callback,n)}},{key:"makeCustomEventCallback",value:function(e,t){var n=this;if("doubletab"===e.customEventName){var r=300;return e.delayMethods.length&&(r=+e.delayMethods[0].target),function(){n.doubleTab?(performance.now()-n.doubleTab.time<r&&t.apply(void 0,arguments),n.doubleTab=null):n.doubleTab={time:performance.now()}}}return t}},{key:"bindingDomEvent",value:function(e,t,n){var r=g(e),i=r[0],o=r[1],a=r.slice(2),l=this.getDefaultEventObject(i,t);if(l.dom=this.getDefaultDomElement(o),l.delegate=a.join(I),l.debounceMethods.length)n=Rt(n,+l.debounceMethods[0].target);else if(l.throttleMethods.length){n=Mt(n,+l.throttleMethods[0].target)}n=this.makeCustomEventCallback(l,n),this.addDomEvent(l,n)}},{key:"getEventNames",value:function(e){var t=[];return e.split(R).forEach((function(e){var n=e.split(R);t.push.apply(t,n)})),t}},{key:"parseDomEvent",value:function(e){for(var t=this.context,n=e.split(M).map((function(e){return e.trim()})).filter(Boolean),r=n.shift().split(_)[1].split(I),i=this.getEventNames(r[0]),o=t[e].bind(t),a=0,l=i.length;a<l;a++)r[0]=i[a],this.bindingDomEvent(r,n,o)}}]),n}(Ht),zt=function(e,t,r){if("cssText"!==t)if("style"!==t)if("class"!==t)"callback"!==t||"function"!=typeof r?void 0===r?e.removeAttr(t):"TEXTAREA"===e.el.nodeName&&"value"===t||"text"===t||"textContent"===t?e.text(r):"innerHTML"===t||"html"===t?e.html(r):"htmlDiff"===t?e.updateDiff(r):"svgDiff"===t?e.updateSVGDiff(r):"value"===t?e.val(r):e.attr(t,r):r();else if(Array.isArray(r))e.addClass.apply(e,m(r.filter(Boolean)));else if(function(e){return"object"==n(e)&&!Array.isArray(e)&&!function(e){return"number"==typeof e}(e)&&!Lt(e)&&null!==e}(r))for(var i=Object.keys(r),o=0,a=i.length;o<a;o++){var l=i[o],u=r[l];e.toggleClass(l,u)}else e.el.className=r;else"string"!=typeof r&&e.css(r);else e.cssText(r)},Wt=function(e){s(n,e);var t=v(n);function n(){return o(this,n),t.apply(this,arguments)}return l(n,[{key:"load",value:function(){this.bindData.apply(this,arguments)}},{key:"bindData",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._bindMethods||(this._bindMethods=this.context.filterProps(x));var o=this._bindMethods.filter((function(e){if(!n.length)return!0;var t=p(e.split(M),2),r=t[0];t[1];var i=p(r.split(" "),2);i[0];var o=i[1];return n.indexOf(o)>-1}));o.forEach(function(){var t=i(regeneratorRuntime.mark((function t(r){var i,o,a,l,u,s,c,h,f,v,d,y,g,m,k;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.context[r],o=r.split(M),a=p(o,2),r=a[0],l=a[1],u=e.getRef(l),s=gt,""!=u&&"string"==typeof u?s=pt(u):"function"==typeof u&&(s=u),c=r.split(P)[1],h=e.context.refs[c],f="function"==typeof s&&s.call(e.context),!h||!f){t.next=16;break}return t.next=11,i.call.apply(i,[e.context].concat(n));case 11:if(v=t.sent){t.next=14;break}return t.abrupt("return");case 14:for(d=Object.keys(v),y=0,g=d.length;y<g;y++)m=d[y],k=v[m],zt(h,m,k);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"destroy",value:function(){this._bindMethods=void 0}}]),n}(Ht),Xt=new Map;var Yt,qt,Jt=/[xy]/g;function Zt(){var e=(new Date).getTime();return"xxx12-xx-34xx".replace(Jt,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)}))}function Qt(){var e=(new Date).getTime();return"idxxxxxxx".replace(Jt,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)}))}var en="ref",tn=xt.create("div"),nn="[".concat(en,"]"),rn="refclass",on="[".concat(rn,"]"),an=function(){function e(t,n){o(this,e),this.state={},this.prevState={},this.refs={},this.children={},this._bindings=[],this.id=Zt(),this.__tempVariables=new Map,this.handlers=this.initializeHandler(),this.initializeProperty(t,n),this.initComponents()}var n;return l(e,[{key:"initializeProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.opt=e||{},this.parent=this.opt,this.props=t,this.source=Zt(),this.sourceName=this.constructor.name}},{key:"initComponents",value:function(){this.childComponents=this.components()}},{key:"initializeHandler",value:function(){return[new Wt(this),new Gt(this)]}},{key:"initState",value:function(){return{}}},{key:"setState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.prevState=this.state,this.state=Object.assign({},this.state,e),t&&this.load()}},{key:"toggleState",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.setState(u({},e,!this.state[e]),t)}},{key:"variable",value:function(e){var t="".concat("__ref__variable:").concat(Qt());return this.__tempVariables.set(t,e),t}},{key:"recoverVariable",value:function(e){if(!1===Lt(e))return e;var t=e;return this.__tempVariables.has(e)&&(t=this.__tempVariables.get(e),this.__tempVariables.delete(e)),t}},{key:"_reload",value:function(e){this.props=e,this.state={},this.setState(this.initState(),!1),this.refresh(!0)}},{key:"render",value:function(e){this.$el=this.parseTemplate(Bt(Yt||(Yt=y(["\n        ","\n      "])),this.template())),this.refs.$el=this.$el,e&&e.append(this.$el),this.load(),this.afterRender()}},{key:"initialize",value:function(){this.state=this.initState()}},{key:"afterRender",value:function(){}},{key:"components",value:function(){return{}}},{key:"getRef",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.join("");return this.refs[r]}},{key:"parseTemplate",value:function(e,t){Array.isArray(e)&&(e=e.join("")),e=e.trim();for(var n=tn.html(e).children(),r=0,i=n.length;r<i;r++){var o=n[r],a=o.attr(en);a&&(this.refs[a]=o);for(var l=o.$$(nn),u={},s=0,c=l.length;s<c;s++){var h=l[s],f=h.attr(en);u[f]?console.warn("".concat(a," is duplicated. - ").concat(this.sourceName),this):u[f]=!0,this.refs[f]=h}}return t?tn.createChildrenFragment():n[0]}},{key:"parseProperty",value:function(e){var n,r={},i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=E(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}(e.el.attributes);try{for(i.s();!(n=i.n()).done;){var o=n.value;r[o.nodeName]=this.recoverVariable(o.nodeValue)}}catch(e){i.e(e)}finally{i.f()}return r.props&&(r=t(t({},r),yt(r.props))),e.$$("property").forEach((function(e){var t=p(e.attrs("name","value","valueType"),3),n=t[0],i=t[1],o=t[2],a=i||e.text();"json"===o&&(a=JSON.parse(a)),r[n]=a})),r}},{key:"parseSourceName",value:function(e){return e.parent?[e.sourceName].concat(m(this.parseSourceName(e.parent))):[e.sourceName]}},{key:"getEventMachineComponent",value:function(e){var t;return t=e,Xt.get(t)||this.childComponents[e]}},{key:"parseComponent",value:function(){var e=this;this.$el.$$(on).forEach((function(t){var n=e.getEventMachineComponent(t.attr(rn));if(n){var r,i=e.parseProperty(t),o=t.attr(en),a=null;if(e.children[o]?(a=e.children[o])._reload(i):(a=new n(e,i),e.children[o||a.id]=a,a.render()),a.renderTarget)null===(r=a.$el)||void 0===r||r.appendTo(a.renderTarget),t.remove();else t.replace(a.$el)}else t.remove()})),Dt(this.children,(function(t,n){n&&n.clean()&&delete e.children[t]}))}},{key:"clean",value:function(){if(this.$el&&!this.$el.hasParent())return Dt(this.children,(function(e,t){t.clean()})),this.destroy(),this.$el=null,!0}},{key:"refresh",value:function(){this.load()}},{key:"_afterLoad",value:function(){this.runHandlers("initialize"),this.bindData(),this.parseComponent()}},{key:"load",value:(n=i(regeneratorRuntime.mark((function e(){var t,n,r,o,a=this,l=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=l.length,n=new Array(t),r=0;r<t;r++)n[r]=l[r];return this._loadMethods||(this._loadMethods=this.filterProps(S)),o=this._loadMethods.filter((function(e){var t=e.split(D)[1].split(M).map((function(e){return e.trim()}))[0];return!n.length||n.indexOf(t)>-1})),e.next=5,o.forEach(function(){var e=i(regeneratorRuntime.mark((function e(t){var r,i,o,l,u,s,c,h,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.split(D)[1],i=r.split(M).map((function(e){return e.trim()})),o=g(i),l=o[0],u=(u=o.slice(1)).map((function(e){return e.trim()})),s=Boolean(u.filter((function(e){return se.includes(e)})).length),!a.refs[l]){e.next=11;break}return e.next=7,(c=a[t]).call.apply(c,[a].concat(n));case 7:h=e.sent,Array.isArray(h)&&(h=h.join("")),f=a.parseTemplate(Bt(qt||(qt=y(["",""])),h),!0),s?a.refs[l].htmlDiff(f):a.refs[l].html(f);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:this._afterLoad();case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"runHandlers",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"run",t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.handlers.forEach((function(t){return t[e].apply(t,n)}))}},{key:"bindData",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.runHandlers.apply(this,["load"].concat(t))}},{key:"template",value:function(){return"<div></div>"}},{key:"eachChildren",value:function(e){It(e)&&Dt(this.children,(function(t,n){e(n)}))}},{key:"rerender",value:function(){var e=this.$el.parent();this.destroy(),this.render(e)}},{key:"destroy",value:function(){this.eachChildren((function(e){e.destroy()})),this.runHandlers("destroy"),this.$el&&this.$el.remove(),this.$el=null,this.refs={},this.children={}}},{key:"collectProps",value:function(){return this.__cachedMethodList||(this.__cachedMethodList=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Nt,n=e,r=[];do{if(!1===n instanceof Object)break;var i=Object.getOwnPropertyNames(n).filter((function(n){return e&&It(e[n])&&t(n)}));r.push.apply(r,i)}while(n=Object.getPrototypeOf(n));return r}(this,(function(e){return 0===e.indexOf(A)}))),this.__cachedMethodList}},{key:"filterProps",value:function(e){return this.collectProps().filter((function(t){return t.match(e)}))}},{key:"self",value:function(e){return e&&e.$dt&&e.$dt.is(e.target)}},{key:"isAltKey",value:function(e){return e.altKey}},{key:"isCtrlKey",value:function(e){return e.ctrlKey}},{key:"isShiftKey",value:function(e){return e.shiftKey}},{key:"isMetaKey",value:function(e){return e.metaKey||"Meta"==e.key||e.code.indexOf("Meta")>-1}},{key:"isMouseLeftButton",value:function(e){return 1===e.buttons}},{key:"isMouseRightButton",value:function(e){return 2===e.buttons}},{key:"hasMouse",value:function(e){return"mouse"===e.pointerType}},{key:"hasTouch",value:function(e){return"touch"===e.pointerType}},{key:"hasPen",value:function(e){return"pen"===e.pointerType}},{key:"preventDefault",value:function(e){return e.preventDefault(),!0}},{key:"stopPropagation",value:function(e){return e.stopPropagation(),!0}}]),e}(),ln=function(){function e(t){o(this,e),this.cachedCallback={},this.callbacks={},this.commandes=[],this.editor=t}return l(e,[{key:"getCallbacks",value:function(e){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e]}},{key:"setCallbacks",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.callbacks[e]=t}},{key:"debug",value:function(){var e;this.editor&&this.editor.config.get("debug")&&(e=console).debug.apply(e,arguments)}},{key:"on",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],s=t;return i>0?s=Rt(t,i):o>0&&(s=Mt(t,o)),u.length&&(s=_t(s,n,u)),this.getCallbacks(e).push({event:e,callback:s,context:n,originalCallback:t,enableAllTrigger:a,enableSelfTrigger:l}),this.debug("add message event",e,n.sourceName),function(){r.off(e,t)}}},{key:"off",value:function(e,t){this.debug("off message event",e),1==arguments.length?this.setCallbacks(e):2==arguments.length&&this.setCallbacks(e,this.getCallbacks(e).filter((function(e){return e.originalCallback!==t})))}},{key:"offAll",value:function(e){var t=this;Object.keys(this.callbacks).forEach((function(n){t.setCallbacks(n,t.getCallbacks(n).filter((function(t){return t.context!==e})))})),this.debug("off all message",e.sourceName)}},{key:"getCachedCallbacks",value:function(e){return this.getCallbacks(e)}},{key:"sendMessage",value:function(e,t){for(var n=this,r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];Promise.resolve().then((function(){var r=n.getCachedCallbacks(t);if(r)for(var o=0,a=r.length;o<a;o++){var l=r[o];l.enableSelfTrigger||(l.enableAllTrigger||l.originalCallback.source!==e)&&l.callback.apply(l.context,i)}}))}},{key:"nextSendMessage",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];Promise.resolve().then((function(){t.apply(void 0,r)}))}},{key:"triggerMessage",value:function(e,t){for(var n=this,r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];Promise.resolve().then((function(){var r=n.getCachedCallbacks(t);if(r)for(var o=0,a=r.length;o<a;o++){var l=r[o];l.originalCallback.source===e&&l.callback.apply(l.context,i)}else console.warn(t," is not valid event")}))}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];It(e)?e.apply(void 0,n):this.sendMessage.apply(this,[this.source,e].concat(n))}},{key:"nextTick",value:function(e){this.nextSendMessage(this.source,e)}},{key:"trigger",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];It(e)?e.apply(void 0,n):this.triggerMessage.apply(this,[this.source,e].concat(n))}}]),e}();return t(t({start:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=xt.create(n.container||document.body),i=new e(n,t(t({},n),{},{store:n.store||new ln}));return i.render(r),i},UIElement:function(e){s(n,e);var t=v(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o(this,n),(r=t.call(this,e,i)).__UID=new Set,i.store&&(r.__storeInstance=i.store),r.created(),r.initialize(),r.initializeStoreEvent(),r}return l(n,[{key:"setStore",value:function(e){this.__storeInstance=e}},{key:"$store",get:function(){return this.__storeInstance||this.parent.$store}},{key:"created",value:function(){}},{key:"getRealEventName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:MULTI_PREFIX,n=e.indexOf(t);return e.substr(n<0?0:n+t.length)}},{key:"splitMethod",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=$t(e,t),i=p(r,2),o=i[0],a=i[1];return[o.length?+a[0].target:n,o,a]}},{key:"createLocalCallback",value:function(e,t){var n=t.bind(this);return n.displayName="".concat(this.sourceName,".").concat(e),n.source=this.source,n}},{key:"initializeStoreEvent",value:function(){var e=this;this.filterProps(N).forEach((function(t){var n=e.getRealEventName(t,L),r=g(n.split(M));r[0];var i=r.slice(1),o=i.map((function(e){return e.trim()})).filter((function(t){return e[t]})).map((function(e){return{target:e}})),a=p(e.splitMethod(i,"debounce"),2),l=a[0],u=a[1],s=p(e.splitMethod(i,"throttle"),2),c=s[0],h=s[1],f=p(e.splitMethod(i,"allTrigger"),2);f[0];var v=f[1],d=p(e.splitMethod(i,"selfTrigger"),2);d[0];var y=d[1];n.split(M).filter((function(e){return-1===o.indexOf(e)&&-1===u.indexOf(e)&&-1===v.indexOf(e)&&-1===y.indexOf(e)&&-1===h.indexOf(e)})).map((function(e){return e.trim()})).filter(Boolean).forEach((function(n){if(It(e[t])){var r=e.createLocalCallback(n,e[t]);e.$store.on(n,r,e,l,c,v.length,y.length,o)}}))}))}},{key:"destoryStoreSUBSCRIBE",value:function(){this.$store.offAll(this)}},{key:"destroy",value:function(){d(c(n.prototype),"destroy",this).call(this),this.destoryStoreSUBSCRIBE()}},{key:"rerender",value:function(){d(c(n.prototype),"rerender",this).call(this),this.initialize(),this.initializeStoreEvent()}},{key:"emit",value:function(e){var t;this.$store.source=this.source,this.$store.sourceContext=this;for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=this.$store).emit.apply(t,[e].concat(r))}},{key:"nextTick",value:function(e){this.$store.nextTick(e)}},{key:"trigger",value:function(e){var t;this.$store.source=this.source;for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=this.$store).trigger.apply(t,[e].concat(r))}},{key:"broadcast",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];Object.keys(this.children).forEach((function(n){var i;(i=t.children[n]).trigger.apply(i,[e].concat(r))}))}},{key:"on",value:function(e,t){this.$store.on(e,t)}},{key:"off",value:function(e,t){this.$store.off(e,t)}},{key:"subscribe",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r="subscribe.".concat(Qt()),i=this.createLocalCallback(r,e);return this.$store.on(r,i,this,t,n,!1,!0),r}}]),n}(an),BaseStore:ln,Dom:xt},bt),{},{registElement:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.keys(e).forEach((function(t){Xt.has(t)||Xt.set(t,e[t])}))}})}));
