!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).sapa=t()}(this,(function(){"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function t(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?e(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t,n,r,i,o,a){try{var l=e[o](a),u=l.value}catch(e){return void n(e)}l.done?t(u):Promise.resolve(u).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var a=e.apply(t,n);function l(e){r(a,i,o,l,u,"next",e)}function u(e){r(a,i,o,l,u,"throw",e)}l(void 0)}))}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var i=c(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f(this,n)}}function d(e,t,n){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function y(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function p(e,t){return k(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,o=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){l=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(l)throw i}}return o}(e,t)||E(e,t)||C()}function g(e){return k(e)||b(e)||E(e)||C()}function m(e){return function(e){if(Array.isArray(e))return T(e)}(e)||b(e)||E(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e){if(Array.isArray(e))return e}function b(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function E(e,t){if(e){if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(e,t):void 0}}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function C(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var A=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P;return" ".concat(t," ").concat(e)},O=/^domevent (.*)/gi,S=/^load (.*)/gi,w=/^bind (.*)/gi,N=/^subscribe (.*)/gi,x=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.join("|")},R=function(){return"ME@"+x.apply(void 0,arguments)},M=R,_=R,D=":",P="|",L="domevent ",I="load ",j="bind ",U="subscribe ",B=" ",$={},H=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.join(D);return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return L+[r].concat(t).join(B)}},F=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return U+t.join(P)},K=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P;return A(e,t)},V=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P;return A("after(".concat(e,")"),t)},z=K,G=K,W=K("ArrowUp"),X=K("ArrowDown"),Y=K("ArrowLeft"),q=K("ArrowRight"),J=K("Enter"),Z=K("Space"),Q=K("Escape"),ee=K("isAltKey"),te=K("isShiftKey"),ne=K("isMetaKey"),re=K("isCtrlKey"),ie=K("hasMouse"),oe=K("hasTouch"),ae=K("hasPen"),le=K("self"),ue=K("isMouseLeftButton"),se=K("isMouseRightButton"),ce=K("fit"),he=K("passive"),fe=K("domdiff"),ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return K("debounce(".concat(e,")"))},de=ve(1e3),ye=K("allTrigger()"),pe=K("selfTrigger()"),ge=K("capture()"),me=V("preventDefault"),ke=V("stopPropagation"),be=F,Ee=H,Te=H("click"),Ce=H("dblclick"),Ae=H("mousedown"),Oe=H("mouseup"),Se=H("mousemove"),we=H("mouseover"),Ne=H("mouseout"),xe=H("mouseenter"),Re=H("mouseleave"),Me=H("touchstart"),_e=H("touchmove"),De=H("touchend"),Pe=H("keydown"),Le=H("keyup"),Ie=H("keypress"),je=H("drag"),Ue=H("dragstart"),Be=H("drop"),$e=H("dragover"),He=H("dragenter"),Fe=H("dragleave"),Ke=H("dragexit"),Ve=H("dragout"),ze=H("dragend"),Ge=H("contextmenu"),We=H("change"),Xe=H("input"),Ye=H("focus"),qe=H("focusin"),Je=H("focusout"),Ze=H("blur"),Qe=H("paste"),et=H("resize"),tt=H("scroll"),nt=H("submit"),rt=Ee("pointerover"),it=Ee("pointerenter"),ot=Ee("pointerout"),at=Ee("pointermove"),lt=Ee("pointerup"),ut=Ee("change","input"),st=Ee("wheel","mousewheel","DOMMouseScroll"),ct=H("animationstart"),ht=H("animationend"),ft=H("animationiteration"),vt=H("transitionstart"),dt=H("transitionend"),yt=H("transitionrun"),pt=H("transitioncancel"),gt=Ee("doubletab"),mt=function(e){return $[e]||""},kt=function(e){return function(){return this.prevState[e]!=this.state[e]}},bt=function(){return!0};function Et(e,t){return Math.sign(e)*Math.min(t,Math.abs(e))}var Tt={addDomEvent:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e&&e.addEventListener(t,n,r)},removeDomEvent:function(e,t,n){e&&e.removeEventListener(t,n)},pos:function(e){return e.touches&&e.touches[0]?e.touches[0]:e},posXY:function(e){var t=this.pos(e);return{x:t.pageX,y:t.pageY}}},Ct=Object.freeze({__proto__:null,makeEventChecker:A,CHECK_DOM_EVENT_PATTERN:O,CHECK_LOAD_PATTERN:S,CHECK_BIND_PATTERN:w,CHECK_SUBSCRIBE_PATTERN:N,PIPE:x,EVENT:R,COMMAND:M,ON:_,NAME_SAPARATOR:D,CHECK_SAPARATOR:P,DOM_EVENT_SAPARATOR:L,LOAD_SAPARATOR:I,BIND_SAPARATOR:j,SUBSCRIBE_SAPARATOR:U,SAPARATOR:B,CHECKER:K,AFTER:V,BEFORE:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P;return A("before(".concat(e,")"),t)},IF:z,KEY:G,ARROW_UP:W,ARROW_DOWN:X,ARROW_LEFT:Y,ARROW_RIGHT:q,ENTER:J,SPACE:Z,ESCAPE:Q,ALT:ee,SHIFT:te,META:ne,CONTROL:re,MOUSE:ie,TOUCH:oe,PEN:ae,SELF:le,LEFT_BUTTON:ue,RIGHT_BUTTON:se,FIT:ce,PASSIVE:he,DOMDIFF:fe,DEBOUNCE:ve,DELAY:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300;return K("delay(".concat(e,")"))},D1000:de,THROTTLE:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return K("throttle(".concat(e,")"))},ALL_TRIGGER:ye,SELF_TRIGGER:pe,CAPTURE:ge,PREVENT:me,STOP:ke,SUBSCRIBE:be,SUBSCRIBE_ALL:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return F.apply(void 0,t.concat([ye]))},SUBSCRIBE_SELF:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return F.apply(void 0,t.concat([pe]))},CONFIG:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return F.apply(void 0,["config:".concat(e)].concat(n))},CUSTOM:Ee,CLICK:Te,DOUBLECLICK:Ce,MOUSEDOWN:Ae,MOUSEUP:Oe,MOUSEMOVE:Se,MOUSEOVER:we,MOUSEOUT:Ne,MOUSEENTER:xe,MOUSELEAVE:Re,TOUCHSTART:Me,TOUCHMOVE:_e,TOUCHEND:De,KEYDOWN:Pe,KEYUP:Le,KEYPRESS:Ie,DRAG:je,DRAGSTART:Ue,DROP:Be,DRAGOVER:$e,DRAGENTER:He,DRAGLEAVE:Fe,DRAGEXIT:Ke,DRAGOUT:Ve,DRAGEND:ze,CONTEXTMENU:Ge,CHANGE:We,INPUT:Xe,FOCUS:Ye,FOCUSIN:qe,FOCUSOUT:Je,BLUR:Ze,PASTE:Qe,RESIZE:et,SCROLL:tt,SUBMIT:nt,POINTERSTART:function(){return Ee("pointerdown").apply(void 0,arguments)+ue},POINTEROVER:rt,POINTERENTER:it,POINTEROUT:ot,POINTERMOVE:at,POINTEREND:lt,CHANGEINPUT:ut,WHEEL:st,ANIMATIONSTART:ct,ANIMATIONEND:ht,ANIMATIONITERATION:ft,TRANSITIONSTART:vt,TRANSITIONEND:dt,TRANSITIONRUN:yt,TRANSITIONCANCEL:pt,DOUBLETAB:gt,LOAD:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"$el";return I+e},getRef:mt,BIND_CHECK_FUNCTION:kt,BIND_CHECK_DEFAULT_FUNCTION:bt,BIND:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"$el";return j+e},normalizeWheelEvent:function(e){var t=e.deltaX,n=e.deltaY;if(0===t&&e.shiftKey){var r=[t,n];n=r[0],t=r[1]}return e.deltaMode===WheelEvent.DOM_DELTA_LINE?n*=8:e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(n*=24),[Et(t,24),Et(n,24),0]},default:Tt}),At=function(e,t,n,r){n?r&&n===r||function(e,t,n){"boolean"==typeof n?function(e,t,n){n?(e.setAttribute(t,t),e[t]=n):(e.removeAttribute(t),e[t]=n)}(e,t,n):e.setAttribute(t,n)}(e,t,n):function(e,t,n){"boolean"==typeof n?function(e,t){e.removeAttribute(t),e[t]=!1}(e,t):t&&function(e,t){e.removeAttribute(t)}(e,t)}(e,t,r)};function Ot(e){return e.nodeType!==Node.TEXT_NODE&&"true"===e.getAttribute("data-domdiff-pass")}function St(e){for(var t={},n=e.length,r=0;r<n;r++){var i=e[r];t[i.name]=i.value}return t}function wt(e,t,n,r){if(t)if(n){if(Ot(t)||Ot(n));else if(u=t,(l=n).nodeType===Node.TEXT_NODE&&l.textContent!==u.textContent||l.nodeName!==u.nodeName||function(e){return e.nodeType!==Node.TEXT_NODE&&e.getAttribute("refClass")}(n))e.replaceChild(n.cloneNode(!0),t);else if(n.nodeType!==Node.TEXT_NODE&&n.nodeType!==Node.COMMENT_NODE&&"[object HTMLUnknownElement]"!==n.toString()){!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[];r.push.apply(r,Object.keys(t)),r.push.apply(r,Object.keys(n));for(var i=m(new Set(r)),o=0,a=i.length;o<a;o++){var l=i[o];At(e,l,t[l],n[l])}}(t,St(n.attributes),St(t.attributes));var i=Nt(t),o=Nt(n),a=Math.max(i.length,o.length);for(r=0;r<a;r++)wt(t,i[r],o[r],r)}}else e.removeChild(t);else e.appendChild(n.cloneNode(!0));var l,u}var Nt=function(e){var t=e.firstChild;if(!t)return[];var n=[];do{n.push(t),t=t.nextSibling}while(t);return n};function xt(e,t){e=e.el||e,t=t.el||t;for(var n=Nt(e),r=Nt(t),i=Math.max(n.length,r.length),o=0;o<i;o++)wt(e,n[o],r[o],o)}var Rt,Mt=function(){function e(t,n,r){if(o(this,e),"string"!=typeof t)this.el=t;else{var i=document.createElement(t);for(var a in n&&(i.className=n),r=r||{})i.setAttribute(a,r[a]);this.el=i}}return l(e,[{key:"setAttr",value:function(e){var t=this;return Object.keys(e).forEach((function(n){t.attr(n,e[n])})),this}},{key:"setAttrNS",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"http://www.w3.org/2000/svg";return Object.keys(e).forEach((function(r){t.attr(r,e[r],n)})),this}},{key:"setProp",value:function(e){var t=this;return Object.keys(e).forEach((function(n){t.el[n]!=e[n]&&(t.el[n]=e[n])})),this}},{key:"data",value:function(e,t){return 1===arguments.length?this.attr("data-"+e):2===arguments.length?this.attr("data-"+e,t):this}},{key:"attr",value:function(e,t){return 1==arguments.length?this.el.getAttribute(e):(this.el.getAttribute(e)!=t&&this.el.setAttribute(e,t),this)}},{key:"attrNS",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"http://www.w3.org/2000/svg";return 1==arguments.length?this.el.getAttributeNS(n,e):(this.el.getAttributeNS(n,e)!=t&&this.el.setAttributeNS(n,e,t),this)}},{key:"attrKeyValue",value:function(e){return u({},this.el.getAttribute(e),this.val())}},{key:"attrs",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.map((function(t){return e.el.getAttribute(t)}))}},{key:"styles",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.map((function(t){return e.el.style[t]}))}},{key:"removeAttr",value:function(e){return this.el.removeAttribute(e),this}},{key:"removeStyle",value:function(e){return this.el.style.removeProperty(e),this}},{key:"is",value:function(e){return this.el===(e.el||e)}},{key:"isTag",value:function(e){return this.el.tagName.toLowerCase()===e.toLowerCase()}},{key:"closest",value:function(t){for(var n=this,r=!1;!(r=n.hasClass(t));){if(!n.el.parentNode)return null;n=e.create(n.el.parentNode)}return r?n:null}},{key:"path",value:function(){if(!this.el)return[];var e=this.parent();return e?[].concat(m(e.path()),[this]):[this]}},{key:"parent",value:function(){return e.create(this.el.parentNode)}},{key:"hasParent",value:function(){return!!this.el.parentNode}},{key:"removeClass",value:function(){var e;return(e=this.el.classList).remove.apply(e,arguments),this}},{key:"hasClass",value:function(e){return!!this.el.classList&&this.el.classList.contains(e)}},{key:"addClass",value:function(){var e;return(e=this.el.classList).add.apply(e,arguments),this}},{key:"onlyOneClass",value:function(e){this.parent().children().forEach((function(t){t.removeClass(e)})),this.addClass(e)}},{key:"toggleClass",value:function(e,t){return this.el.classList.toggle(e,t),this}},{key:"html",value:function(e){return void 0===e?this.el.innerHTML:("string"==typeof e?this.el.innerHTML=e:this.empty().append(e),this)}},{key:"htmlDiff",value:function(e){xt(this,e)}},{key:"updateDiff",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div";xt(this,e.create(n).html(t))}},{key:"updateSVGDiff",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div";xt(this,e.create(n).html("<svg>".concat(t,"</svg>")).firstChild.firstChild)}},{key:"find",value:function(e){return this.el.querySelector(e)}},{key:"$",value:function(t){var n=this.find(t);return n?e.create(n):null}},{key:"findAll",value:function(e){return m(this.el.querySelectorAll(e))}},{key:"$$",value:function(t){return this.findAll(t).map((function(t){return e.create(t)}))}},{key:"empty",value:function(){for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild);return this}},{key:"append",value:function(e){return"string"==typeof e?this.el.appendChild(document.createTextNode(e)):this.el.appendChild(e.el||e),this}},{key:"prepend",value:function(e){return"string"==typeof e?this.el.prepend(document.createTextNode(e)):this.el.prepend(e.el||e),this}},{key:"prependHTML",value:function(t){var n=e.create("div").html(t);return this.prepend(n.createChildrenFragment()),n}},{key:"appendHTML",value:function(t){var n=e.create("div").html(t);return this.append(n.createChildrenFragment()),n}},{key:"createChildrenFragment",value:function(){var e=this.children(),t=document.createDocumentFragment();return e.forEach((function(e){return t.appendChild(e.el)})),t}},{key:"appendTo",value:function(e){return(e.el?e.el:e).appendChild(this.el),this}},{key:"remove",value:function(){return this.el.parentNode&&this.el.parentNode.removeChild(this.el),this}},{key:"removeChild",value:function(e){return this.el.removeChild(e.el||e),this}},{key:"text",value:function(t){if(void 0===t)return this.el.textContent;var n=t;return t instanceof e&&(n=t.text()),this.el.textContent!==n&&(this.el.textContent=n),this}},{key:"css",value:function(e,t){var n=this;if(void 0!==e&&void 0!==t)0===e.indexOf("--")&&void 0!==t?this.el.style.setProperty(e,t):this.el.style[e]=t;else if(void 0!==e){if("string"==typeof e)return getComputedStyle(this.el)[e];Object.entries(e).forEach((function(e){var t=p(e,2),r=t[0],i=t[1];0===r.indexOf("--")&&void 0!==i?n.el.style.setProperty(r,i):n.el.style[r]=i}))}return this}},{key:"getComputedStyle",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){for(var e=getComputedStyle(this.el),t={},n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return r.forEach((function(n){t[n]=e[n]})),t}))},{key:"getStyleList",value:function(){for(var e=this,t={},n=this.el.style.length,r=0;r<n;r++){var i=this.el.style[r];t[i]=this.el.style[i]}for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return a.forEach((function(n){t[n]=e.css(n)})),t}},{key:"cssText",value:function(e){return void 0===e?this.el.style.cssText:(e!=this.el.tempCssText&&(this.el.style.cssText=e,this.el.tempCssText=e),this)}},{key:"cssArray",value:function(e){return e[0]&&(this.el.style[e[0]]=e[1]),e[2]&&(this.el.style[e[2]]=e[3]),e[4]&&(this.el.style[e[4]]=e[5]),e[6]&&(this.el.style[e[6]]=e[7]),e[8]&&(this.el.style[e[8]]=e[9]),this}},{key:"cssFloat",value:function(e){return parseFloat(this.css(e))}},{key:"cssInt",value:function(e){return parseInt(this.css(e))}},{key:"px",value:function(e,t){return this.css(e,"".concat(t,"px"))}},{key:"rect",value:function(){return this.el.getBoundingClientRect()}},{key:"bbox",value:function(){return this.el.getBBox()}},{key:"isSVG",value:function(){return"SVG"===this.el.tagName.toUpperCase()}},{key:"offsetRect",value:function(){if(this.isSVG()){var e=this.parent().rect(),t=this.rect();return{x:t.x-e.x,y:t.y-e.y,top:t.x-e.x,left:t.y-e.y,width:t.width,height:t.height}}return{x:this.el.offsetLeft,y:this.el.offsetTop,top:this.el.offsetTop,left:this.el.offsetLeft,width:this.el.offsetWidth,height:this.el.offsetHeight}}},{key:"offset",value:function(){var t=this.rect(),n=e.getScrollTop(),r=e.getScrollLeft();return{top:t.top+n,left:t.left+r}}},{key:"offsetLeft",value:function(){return this.offset().left}},{key:"offsetTop",value:function(){return this.offset().top}},{key:"position",value:function(){return this.el.style.top?{top:parseFloat(this.css("top")),left:parseFloat(this.css("left"))}:this.rect()}},{key:"size",value:function(){return[this.width(),this.height()]}},{key:"width",value:function(){return this.el.offsetWidth||this.rect().width}},{key:"contentWidth",value:function(){return this.width()-this.cssFloat("padding-left")-this.cssFloat("padding-right")}},{key:"height",value:function(){return this.el.offsetHeight||this.rect().height}},{key:"contentHeight",value:function(){return this.height()-this.cssFloat("padding-top")-this.cssFloat("padding-bottom")}},{key:"val",value:function(t){if(void 0===t)return this.el.value;if(void 0!==t){var n=t;t instanceof e&&(n=t.val()),this.el.value=n}return this}},{key:"matches",value:function(e){return this.el&&this.el.matches?this.el.matches(e)?this:this.parent().matches(e):null}},{key:"value",get:function(){return this.el.value}},{key:"naturalWidth",get:function(){return this.el.naturalWidth}},{key:"naturalHeight",get:function(){return this.el.naturalHeight}},{key:"files",get:function(){return this.el.files?m(this.el.files):[]}},{key:"realVal",value:function(){switch(this.el.nodeType){case"INPUT":var e=this.attr("type");if("checkbox"==e||"radio"==e)return this.checked();case"SELECT":case"TEXTAREA":return this.el.value}return""}},{key:"int",value:function(){return parseInt(this.val(),10)}},{key:"float",value:function(){return parseFloat(this.val())}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"block";return this.el.style.display="none"!=e?e:"block",this}},{key:"hide",value:function(){return this.el.style.display="none",this}},{key:"isHide",value:function(){return"none"===this.el.style.display}},{key:"isShow",value:function(){return!this.isHide()}},{key:"toggle",value:function(e){var t=this.isHide();return 1==arguments.length?e?this.show():this.hide():t?this.show():this.hide()}},{key:"totalLength",get:function(){return this.el.getTotalLength()}},{key:"scrollIntoView",value:function(){this.el.scrollIntoView()}},{key:"addScrollLeft",value:function(e){return this.el.scrollLeft+=e,this}},{key:"addScrollTop",value:function(e){return this.el.scrollTop+=e,this}},{key:"setScrollTop",value:function(e){return this.el.scrollTop=e,this}},{key:"setScrollLeft",value:function(e){return this.el.scrollLeft=e,this}},{key:"scrollTop",value:function(){return this.el===document.body?e.getScrollTop():this.el.scrollTop}},{key:"scrollLeft",value:function(){return this.el===document.body?e.getScrollLeft():this.el.scrollLeft}},{key:"scrollHeight",value:function(){return this.el.scrollHeight}},{key:"scrollWidth",value:function(){return this.el.scrollWidth}},{key:"on",value:function(e,t,n,r){return this.el.addEventListener(e,t,n,r),this}},{key:"off",value:function(e,t){return this.el.removeEventListener(e,t),this}},{key:"getElement",value:function(){return this.el}},{key:"createChild",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=e.create(t,n,r);return o.css(i),this.append(o),o}},{key:"firstChild",get:function(){return e.create(this.el.firstElementChild)}},{key:"children",value:function(){var t=this.el.firstElementChild;if(!t)return[];var n=[];do{n.push(e.create(t)),t=t.nextElementSibling}while(t);return n}},{key:"childLength",value:function(){return this.el.children.length}},{key:"replace",value:function(e){return this.el.parentNode&&this.el.parentNode.replaceChild(e.el||e,this.el),this}},{key:"replaceChild",value:function(e,t){return this.el.replaceChild(t.el||t,e.el||e),this}},{key:"checked",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return 0==arguments.length?!!this.el.checked:(this.el.checked=!!e,this)}},{key:"click",value:function(){return this.el.click(),this}},{key:"focus",value:function(){return this.el.focus(),this}},{key:"select",value:function(){if("true"===this.attr("contenteditable")){var e=document.createRange();e.selectNodeContents(this.el);var t=window.getSelection();t.removeAllRanges(),t.addRange(e)}else this.el.select();return this}},{key:"blur",value:function(){return this.el.blur(),this}},{key:"context",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"2d";return this._initContext||(this._initContext=this.el.getContext(e)),this._initContext}},{key:"resize",value:function(e){var t=e.width,n=e.height;this._initContext=null;var r=this.context(),i=window.devicePixelRatio||1;this.px("width",+t),this.px("height",+n),this.el.width=t*i,this.el.height=n*i,r.scale(i,i)}},{key:"toDataURL",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/png",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.el.toDataURL(e,t)}},{key:"clear",value:function(){this.context().clearRect(0,0,this.el.width,this.el.height)}},{key:"update",value:function(e){this.clear(),e.call(this,this)}},{key:"drawImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.context(),i=window.devicePixelRatio||1;r.drawImage(e,t,n,e.width,e.height,0,0,this.el.width/i,this.el.height/i)}},{key:"drawOption",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.context();Object.assign(t,e)}},{key:"drawLine",value:function(e,t,n,r){var i=this.context();i.beginPath(),i.moveTo(e,t),i.lineTo(n,r),i.stroke(),i.closePath()}},{key:"drawPath",value:function(){var e=this.context();e.beginPath();for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t,n){0==n?e.moveTo(t[0],t[1]):e.lineTo(t[0],t[1])})),e.stroke(),e.fill(),e.closePath()}},{key:"drawCircle",value:function(e,t,n){var r=this.context();r.beginPath(),r.arc(e,t,n,0,2*Math.PI),r.stroke(),r.fill()}},{key:"drawText",value:function(e,t,n){this.context().fillText(n,e,t)}}],[{key:"create",value:function(t,n,r){return new e(t,n,r)}},{key:"createByHTML",value:function(t){var n=e.create("div").html(t).children();return n.length?e.create(n[0].el):null}},{key:"getScrollTop",value:function(){return Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop)}},{key:"getScrollLeft",value:function(){return Math.max(window.pageXOffset,document.documentElement.scrollLeft,document.body.scrollLeft)}},{key:"parse",value:function(e){return DOMParser().parseFromString(e,"text/htmll")}},{key:"body",value:function(){return e.create(document.body)}}]),e}();function _t(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0===t)return e;var n=void 0;return function(r,i,o,a,l){n&&clearTimeout(n),n=setTimeout((function(){e(r,i,o,a,l)}),t||300)}}function Dt(e,t){var n=void 0;return function(r,i,o,a,l){n||(n=setTimeout((function(){e(r,i,o,a,l),n=null}),t||300))}}function Pt(e,t,n){return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];var a=n.every((function(e){return t[e.target].apply(t,i)}));a&&e.apply(t,i)}}function Lt(e,t){Object.keys(e).forEach((function(n,r){t(n,e[n],r)}))}function It(e){return!1===function(e){return null==e}(e)}function jt(e){return"string"==typeof e}function Ut(e){return"function"==typeof e}var Bt=/\<(\w*)([^\>]*)\/\>/gim,$t=(u(Rt={image:!0,input:!0,br:!0,path:!0,line:!0,circle:!0,rect:!0},"path",!0),u(Rt,"polygon",!0),u(Rt,"polyline",!0),u(Rt,"use",!0),Rt),Ht=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=e.map((function(e,t){var r=n[t]||"";return Ut(r)&&console.log(r),Array.isArray(r)||(r=[r]),e+(r=r.join(""))})).join("");return i=i.replace(Bt,(function(e,t){return $t[t.toLowerCase()]?e:e.replace("/>","></".concat(t,">"))}))},Ft=function(e,t){var n=e.filter((function(e){return e.indexOf("".concat(t,"("))>-1})),r=n.map((function(e){var n=p(e.split("".concat(t,"("))[1].split(")")[0].trim().split(" "),2);return{target:n[0],param:n[1]}}));return[n,r]},Kt=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,e),this.context=t,this.options=n}return l(e,[{key:"initialize",value:function(){}},{key:"load",value:function(){}},{key:"refresh",value:function(){}},{key:"render",value:function(){}},{key:"getRef",value:function(e){return this.context.getRef(e)}},{key:"run",value:function(){}},{key:"destroy",value:function(){}}]),e}(),Vt={touchstart:!0,touchmove:!0,mousedown:!0,mouseup:!0,mousemove:!0},zt={doubletab:"touchend"},Gt={doubletab:!0},Wt=function(e){s(n,e);var t=v(n);function n(){return o(this,n),t.apply(this,arguments)}return l(n,[{key:"initialize",value:function(){var e=this;this.destroy(),this._domEvents||(this._domEvents=this.context.filterProps(O)),this._domEvents.forEach((function(t){return e.parseDomEvent(t)}))}},{key:"destroy",value:function(){this.removeEventAll()}},{key:"removeEventAll",value:function(){var e=this;this.getBindings().forEach((function(t){e.removeDomEvent(t)})),this.initBindings()}},{key:"removeDomEvent",value:function(e){var t=e.eventName,n=e.dom,r=e.callback;Tt.removeDomEvent(n,t,r)}},{key:"getBindings",value:function(){return this._bindings||this.initBindings(),this._bindings}},{key:"addBinding",value:function(e){this.getBindings().push(e)}},{key:"initBindings",value:function(){this._bindings=[]}},{key:"matchPath",value:function(e,t){return e?e.matches(t)?e:this.matchPath(e.parentElement,t):null}},{key:"hasDelegate",value:function(e,t){return this.matchPath(e.target||e.srcElement,t.delegate)}},{key:"makeCallback",value:function(e,t){return e.delegate?this.makeDelegateCallback(e,t):this.makeDefaultCallback(e,t)}},{key:"makeDefaultCallback",value:function(e,t){var n=this;return function(r){var i=n.runEventCallback(r,e,t);if(It(i))return i}}},{key:"makeDelegateCallback",value:function(e,t){var n=this;return function(r){var i=n.hasDelegate(r,e);if(i){r.$dt=Mt.create(i);var o=n.runEventCallback(r,e,t);if(It(o))return o}}}},{key:"runEventCallback",value:function(e,t,n){var r=this.context;if(e.xy=Tt.posXY(e),t.beforeMethods.length&&t.beforeMethods.every((function(t){return r[t.target].call(r,e,t.param)})),this.checkEventType(e,t)){var i=n(e,e.$dt,e.xy);return!1!==i&&t.afterMethods.length&&t.afterMethods.forEach((function(t){return r[t.target].call(r,e,t.param)})),i}}},{key:"checkEventType",value:function(e,t){var n=this.context,r=!0;t.codes.length&&(r=!!e.code&&t.codes.indexOf(e.code.toLowerCase())>-1||!!e.key&&t.codes.indexOf(e.key.toLowerCase())>-1);var i=!0;return t.checkMethodList.length&&(i=t.checkMethodList.every((function(t){var r=n[t];return Ut(r)&&r?r.call(n,e):!It(r)||!!r}))),r&&i}},{key:"getDefaultDomElement",value:function(e){var t,n=this.context;return(t=e?n.refs[e]||n[e]||window[e]:n.el||n.$el||n.$root)instanceof Mt?t.getElement():t}},{key:"getRealEventName",value:function(e){return zt[e]||e}},{key:"getCustomEventName",value:function(e){return Gt[e]?e:""}},{key:"getDefaultEventObject",value:function(e,t){var n=this.context,r=t,i=r.filter((function(e){return!!n[e]})),o=p(Ft(r,"after"),2),a=o[0],l=o[1],u=p(Ft(r,"before"),2),s=u[0],c=u[1],h=p(Ft(r,"debounce"),2),f=h[0],v=h[1],d=p(Ft(r,"delay"),2),y=d[0],g=d[1],k=p(Ft(r,"throttle"),2),b=k[0],E=k[1],T=p(Ft(r,"capture"),1)[0],C=[].concat(m(i),m(a),m(s),m(y),m(f),m(b),m(T)),A=r.filter((function(e){return-1===C.indexOf(e)})).map((function(e){return e.toLowerCase()}));return{eventName:this.getRealEventName(e),customEventName:this.getCustomEventName(e),codes:A,captures:T,afterMethods:l,beforeMethods:c,delayMethods:g,debounceMethods:v,throttleMethods:E,checkMethodList:i}}},{key:"addDomEvent",value:function(e,t){e.callback=this.makeCallback(e,t),this.addBinding(e);var n=!!e.captures.length;Vt[e.eventName]&&(n={passive:!0,capture:n}),Tt.addDomEvent(e.dom,e.eventName,e.callback,n)}},{key:"makeCustomEventCallback",value:function(e,t){var n=this;if("doubletab"===e.customEventName){var r=300;return e.delayMethods.length&&(r=+e.delayMethods[0].target),function(){n.doubleTab?(performance.now()-n.doubleTab.time<r&&t.apply(void 0,arguments),n.doubleTab=null):n.doubleTab={time:performance.now()}}}return t}},{key:"bindingDomEvent",value:function(e,t,n){var r=g(e),i=r[0],o=r[1],a=r.slice(2),l=this.getDefaultEventObject(i,t);if(l.dom=this.getDefaultDomElement(o),l.delegate=a.join(B),l.debounceMethods.length)n=_t(n,+l.debounceMethods[0].target);else if(l.throttleMethods.length){n=Dt(n,+l.throttleMethods[0].target)}n=this.makeCustomEventCallback(l,n),this.addDomEvent(l,n)}},{key:"getEventNames",value:function(e){var t=[];return e.split(D).forEach((function(e){var n=e.split(D);t.push.apply(t,n)})),t}},{key:"parseDomEvent",value:function(e){for(var t=this.context,n=e.split(P).map((function(e){return e.trim()})).filter(Boolean),r=n.shift().split(L)[1].split(B),i=this.getEventNames(r[0]),o=t[e].bind(t),a=0,l=i.length;a<l;a++)r[0]=i[a],this.bindingDomEvent(r,n,o)}}]),n}(Kt),Xt=function(e,t,r){if("cssText"!==t)if("style"!==t)if("class"!==t)"callback"!==t||"function"!=typeof r?void 0===r?e.removeAttr(t):"TEXTAREA"===e.el.nodeName&&"value"===t||"text"===t||"textContent"===t?e.text(r):"innerHTML"===t||"html"===t?e.html(r):"htmlDiff"===t?e.updateDiff(r):"svgDiff"===t?e.updateSVGDiff(r):"value"===t?e.val(r):e.attr(t,r):r();else if(Array.isArray(r))e.addClass.apply(e,m(r.filter(Boolean)));else if(function(e){return"object"==n(e)&&!Array.isArray(e)&&!function(e){return"number"==typeof e}(e)&&!jt(e)&&null!==e}(r))for(var i=Object.keys(r),o=0,a=i.length;o<a;o++){var l=i[o],u=r[l];e.toggleClass(l,u)}else e.el.className=r;else"string"!=typeof r&&e.css(r);else e.cssText(r)},Yt=function(e){s(n,e);var t=v(n);function n(){return o(this,n),t.apply(this,arguments)}return l(n,[{key:"load",value:function(){this.bindData.apply(this,arguments)}},{key:"bindData",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._bindMethods||(this._bindMethods=this.context.filterProps(w));var o=this._bindMethods.filter((function(e){if(!n.length)return!0;var t=p(e.split(P),2),r=t[0];t[1];var i=p(r.split(" "),2);i[0];var o=i[1];return n.indexOf(o)>-1}));o.forEach(function(){var t=i(regeneratorRuntime.mark((function t(r){var i,o,a,l,u,s,c,h,f,v,d,y,g,m,k;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.context[r],o=r.split(P),a=p(o,2),r=a[0],l=a[1],u=e.getRef(l),s=bt,""!=u&&"string"==typeof u?s=kt(u):"function"==typeof u&&(s=u),c=r.split(j)[1],h=e.context.refs[c],f="function"==typeof s&&s.call(e.context),!h||!f){t.next=16;break}return t.next=11,i.call.apply(i,[e.context].concat(n));case 11:if(v=t.sent){t.next=14;break}return t.abrupt("return");case 14:for(d=Object.keys(v),y=0,g=d.length;y<g;y++)m=d[y],k=v[m],Xt(h,m,k);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"destroy",value:function(){this._bindMethods=void 0}}]),n}(Kt),qt=new Map;var Jt,Zt,Qt,en=/[xy]/g;function tn(){var e=(new Date).getTime();return"xxx12-xx-34xx".replace(en,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)}))}function nn(){var e=(new Date).getTime();return"idxxxxxxx".replace(en,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)}))}var rn="ref",on=Mt.create("div"),an="[".concat(rn,"]"),ln="refclass",un="[".concat(ln,"]"),sn=(u(Jt={constructor:!0,initState:!0,updateData:!0},"constructor",!0),u(Jt,"initializeProperty",!0),u(Jt,"created",!0),u(Jt,"getRealEventName",!0),u(Jt,"initializeStoreEvent",!0),u(Jt,"destoryStoreEvent",!0),u(Jt,"destroy",!0),u(Jt,"emit",!0),u(Jt,"trigger",!0),u(Jt,"on",!0),u(Jt,"off",!0),u(Jt,"setState",!0),u(Jt,"_reload",!0),u(Jt,"render",!0),u(Jt,"initialize",!0),u(Jt,"afterRender",!0),u(Jt,"components",!0),u(Jt,"getRef",!0),u(Jt,"parseTemplate",!0),u(Jt,"parseProperty",!0),u(Jt,"parseSourceName",!0),u(Jt,"parseComponent",!0),u(Jt,"clean",!0),u(Jt,"refresh",!0),u(Jt,"load",!0),u(Jt,"bindData",!0),u(Jt,"template",!0),u(Jt,"eachChildren",!0),u(Jt,"destroy",!0),u(Jt,"collectProps",!0),u(Jt,"filterProps",!0),u(Jt,"self",!0),u(Jt,"isAltKey",!0),u(Jt,"isCtrlKey",!0),u(Jt,"isShiftKey",!0),u(Jt,"isMetaKey",!0),u(Jt,"preventDefault",!0),u(Jt,"stopPropagation",!0),u(Jt,"bodyMouseMove",!0),u(Jt,"bodyMouseUp",!0),Jt),cn=function(){function e(t,n){o(this,e),this.state={},this.prevState={},this.refs={},this.children={},this._bindings=[],this.id=tn(),this.__tempVariables=new Map,this.handlers=this.initializeHandler(),this.initializeProperty(t,n),this.initComponents()}var n;return l(e,[{key:"initializeProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.opt=e||{},this.parent=this.opt,this.props=t,this.source=tn(),this.sourceName=this.constructor.name}},{key:"initComponents",value:function(){this.childComponents=this.components()}},{key:"initializeHandler",value:function(){return[new Yt(this),new Wt(this)]}},{key:"initState",value:function(){return{}}},{key:"setState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.prevState=this.state,this.state=Object.assign({},this.state,e),t&&this.load()}},{key:"toggleState",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.setState(u({},e,!this.state[e]),t)}},{key:"variable",value:function(e){var t="".concat("__ref__variable:").concat(nn());return this.__tempVariables.set(t,e),t}},{key:"recoverVariable",value:function(e){if(!1===jt(e))return e;var t=e;return this.__tempVariables.has(e)&&(t=this.__tempVariables.get(e),this.__tempVariables.delete(e)),t}},{key:"_reload",value:function(e){this.props=e,this.state={},this.setState(this.initState(),!1),this.refresh(!0)}},{key:"render",value:function(e){this.$el=this.parseTemplate(Ht(Zt||(Zt=y(["\n        ","\n      "])),this.template())),this.refs.$el=this.$el,e&&e.append(this.$el),this.load(),this.afterRender()}},{key:"initialize",value:function(){this.state=this.initState()}},{key:"afterRender",value:function(){}},{key:"components",value:function(){return{}}},{key:"getRef",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.join("");return this.refs[r]}},{key:"parseTemplate",value:function(e,t){Array.isArray(e)&&(e=e.join("")),e=e.trim();for(var n=on.html(e).children(),r=0,i=n.length;r<i;r++){var o=n[r],a=o.attr(rn);a&&(this.refs[a]=o);for(var l=o.$$(an),u={},s=0,c=l.length;s<c;s++){var h=l[s],f=h.attr(rn);u[f]?console.warn("".concat(a," is duplicated. - ").concat(this.sourceName),this):u[f]=!0,this.refs[f]=h}}return t?on.createChildrenFragment():n[0]}},{key:"parseProperty",value:function(e){var n,r={},i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=E(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}(e.el.attributes);try{for(i.s();!(n=i.n()).done;){var o=n.value;r[o.nodeName]=this.recoverVariable(o.nodeValue)}}catch(e){i.e(e)}finally{i.f()}return r.props&&(r=t(t({},r),mt(r.props))),e.$$("property").forEach((function(e){var t=p(e.attrs("name","value","valueType"),3),n=t[0],i=t[1],o=t[2],a=i||e.text();"json"===o&&(a=JSON.parse(a)),r[n]=a})),r}},{key:"parseSourceName",value:function(e){return e.parent?[e.sourceName].concat(m(this.parseSourceName(e.parent))):[e.sourceName]}},{key:"getEventMachineComponent",value:function(e){var t;return t=e,qt.get(t)||this.childComponents[e]}},{key:"parseComponent",value:function(){var e=this;this.$el.$$(un).forEach((function(t){var n=e.getEventMachineComponent(t.attr(ln));if(n){var r,i=e.parseProperty(t),o=t.attr(rn),a=null;if(e.children[o]?(a=e.children[o])._reload(i):(a=new n(e,i),e.children[o||a.id]=a,a.render()),a.renderTarget)null===(r=a.$el)||void 0===r||r.appendTo(a.renderTarget),t.remove();else t.replace(a.$el)}else t.remove()})),Lt(this.children,(function(t,n){n&&n.clean()&&delete e.children[t]}))}},{key:"clean",value:function(){if(this.$el&&!this.$el.hasParent())return Lt(this.children,(function(e,t){t.clean()})),this.destroy(),this.$el=null,!0}},{key:"refresh",value:function(){this.load()}},{key:"_afterLoad",value:function(){this.runHandlers("initialize"),this.bindData(),this.parseComponent()}},{key:"load",value:(n=i(regeneratorRuntime.mark((function e(){var t,n,r,o,a=this,l=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=l.length,n=new Array(t),r=0;r<t;r++)n[r]=l[r];return this._loadMethods||(this._loadMethods=this.filterProps(S)),o=this._loadMethods.filter((function(e){var t=e.split(I)[1].split(P).map((function(e){return e.trim()}))[0];return!n.length||n.indexOf(t)>-1})),e.next=5,o.forEach(function(){var e=i(regeneratorRuntime.mark((function e(t){var r,i,o,l,u,s,c,h,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.split(I)[1],i=r.split(P).map((function(e){return e.trim()})),o=g(i),l=o[0],u=(u=o.slice(1)).map((function(e){return e.trim()})),s=Boolean(u.filter((function(e){return fe.includes(e)})).length),!a.refs[l]){e.next=11;break}return e.next=7,(c=a[t]).call.apply(c,[a].concat(n));case 7:h=e.sent,Array.isArray(h)&&(h=h.join("")),f=a.parseTemplate(Ht(Qt||(Qt=y(["",""])),h),!0),s?a.refs[l].htmlDiff(f):a.refs[l].html(f);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:this._afterLoad();case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"runHandlers",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"run",t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.handlers.forEach((function(t){return t[e].apply(t,n)}))}},{key:"bindData",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.runHandlers.apply(this,["load"].concat(t))}},{key:"template",value:function(){return"<div></div>"}},{key:"eachChildren",value:function(e){Ut(e)&&Lt(this.children,(function(t,n){e(n)}))}},{key:"rerender",value:function(){var e=this.$el.parent();this.destroy(),this.render(e)}},{key:"destroy",value:function(){this.eachChildren((function(e){e.destroy()})),this.runHandlers("destroy"),this.$el&&this.$el.remove(),this.$el=null,this.refs={},this.children={}}},{key:"collectProps",value:function(){return this.__cachedMethodList||(this.__cachedMethodList=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e,r=[];do{if(!1===n instanceof Object)break;var i=Object.getOwnPropertyNames(n).filter((function(n){return e&&Ut(e[n])&&!t[n]}));r.push.apply(r,i)}while(n=Object.getPrototypeOf(n));return r}(this,sn)),this.__cachedMethodList}},{key:"filterProps",value:function(e){return this.collectProps().filter((function(t){return t.match(e)}))}},{key:"self",value:function(e){return e&&e.$dt&&e.$dt.is(e.target)}},{key:"isAltKey",value:function(e){return e.altKey}},{key:"isCtrlKey",value:function(e){return e.ctrlKey}},{key:"isShiftKey",value:function(e){return e.shiftKey}},{key:"isMetaKey",value:function(e){return e.metaKey||"Meta"==e.key||e.code.indexOf("Meta")>-1}},{key:"isMouseLeftButton",value:function(e){return 1===e.buttons}},{key:"isMouseRightButton",value:function(e){return 2===e.buttons}},{key:"hasMouse",value:function(e){return"mouse"===e.pointerType}},{key:"hasTouch",value:function(e){return"touch"===e.pointerType}},{key:"hasPen",value:function(e){return"pen"===e.pointerType}},{key:"preventDefault",value:function(e){return e.preventDefault(),!0}},{key:"stopPropagation",value:function(e){return e.stopPropagation(),!0}}]),e}(),hn=function(){function e(t){o(this,e),this.cachedCallback={},this.callbacks={},this.commandes=[],this.editor=t}return l(e,[{key:"getCallbacks",value:function(e){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e]}},{key:"setCallbacks",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.callbacks[e]=t}},{key:"debug",value:function(){var e;this.editor&&this.editor.config.get("debug")&&(e=console).debug.apply(e,arguments)}},{key:"on",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],s=t;return i>0?s=_t(t,i):o>0&&(s=Dt(t,o)),u.length&&(s=Pt(s,n,u)),this.getCallbacks(e).push({event:e,callback:s,context:n,originalCallback:t,enableAllTrigger:a,enableSelfTrigger:l}),this.debug("add message event",e,n.sourceName),function(){r.off(e,t)}}},{key:"off",value:function(e,t){this.debug("off message event",e),1==arguments.length?this.setCallbacks(e):2==arguments.length&&this.setCallbacks(e,this.getCallbacks(e).filter((function(e){return e.originalCallback!==t})))}},{key:"offAll",value:function(e){var t=this;Object.keys(this.callbacks).forEach((function(n){t.setCallbacks(n,t.getCallbacks(n).filter((function(t){return t.context!==e})))})),this.debug("off all message",e.sourceName)}},{key:"getCachedCallbacks",value:function(e){return this.getCallbacks(e)}},{key:"sendMessage",value:function(e,t){for(var n=this,r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];Promise.resolve().then((function(){var r=n.getCachedCallbacks(t);if(r)for(var o=0,a=r.length;o<a;o++){var l=r[o];l.enableSelfTrigger||(l.enableAllTrigger||l.originalCallback.source!==e)&&l.callback.apply(l.context,i)}}))}},{key:"nextSendMessage",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];Promise.resolve().then((function(){t.apply(void 0,r)}))}},{key:"triggerMessage",value:function(e,t){for(var n=this,r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];Promise.resolve().then((function(){var r=n.getCachedCallbacks(t);if(r)for(var o=0,a=r.length;o<a;o++){var l=r[o];l.originalCallback.source===e&&l.callback.apply(l.context,i)}else console.warn(t," is not valid event")}))}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Ut(e)?e.apply(void 0,n):this.sendMessage.apply(this,[this.source,e].concat(n))}},{key:"nextTick",value:function(e){this.nextSendMessage(this.source,e)}},{key:"trigger",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Ut(e)?e.apply(void 0,n):this.triggerMessage.apply(this,[this.source,e].concat(n))}}]),e}();return t(t({start:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Mt.create(n.container||document.body),i=new e(n,t(t({},n),{},{store:n.store||new hn}));return i.render(r),i},UIElement:function(e){s(n,e);var t=v(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o(this,n),(r=t.call(this,e,i)).__UID=new Set,i.store&&(r.__storeInstance=i.store),r.created(),r.initialize(),r.initializeStoreEvent(),r}return l(n,[{key:"setStore",value:function(e){this.__storeInstance=e}},{key:"$store",get:function(){return this.__storeInstance||this.parent.$store}},{key:"created",value:function(){}},{key:"getRealEventName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:MULTI_PREFIX,n=e.indexOf(t);return e.substr(n<0?0:n+t.length)}},{key:"splitMethod",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Ft(e,t),i=p(r,2),o=i[0],a=i[1];return[o.length?+a[0].target:n,o,a]}},{key:"createLocalCallback",value:function(e,t){var n=t.bind(this);return n.displayName="".concat(this.sourceName,".").concat(e),n.source=this.source,n}},{key:"initializeStoreEvent",value:function(){var e=this;this.filterProps(N).forEach((function(t){var n=e.getRealEventName(t,U),r=g(n.split(P));r[0];var i=r.slice(1),o=i.map((function(e){return e.trim()})).filter((function(t){return e[t]})).map((function(e){return{target:e}})),a=p(e.splitMethod(i,"debounce"),2),l=a[0],u=a[1],s=p(e.splitMethod(i,"throttle"),2),c=s[0],h=s[1],f=p(e.splitMethod(i,"allTrigger"),2);f[0];var v=f[1],d=p(e.splitMethod(i,"selfTrigger"),2);d[0];var y=d[1];n.split(P).filter((function(e){return-1===o.indexOf(e)&&-1===u.indexOf(e)&&-1===v.indexOf(e)&&-1===y.indexOf(e)&&-1===h.indexOf(e)})).map((function(e){return e.trim()})).filter(Boolean).forEach((function(n){if(Ut(e[t])){var r=e.createLocalCallback(n,e[t]);e.$store.on(n,r,e,l,c,v.length,y.length,o)}}))}))}},{key:"destoryStoreSUBSCRIBE",value:function(){this.$store.offAll(this)}},{key:"destroy",value:function(){d(c(n.prototype),"destroy",this).call(this),this.destoryStoreSUBSCRIBE()}},{key:"rerender",value:function(){d(c(n.prototype),"rerender",this).call(this),this.initialize(),this.initializeStoreEvent()}},{key:"emit",value:function(e){var t;this.$store.source=this.source,this.$store.sourceContext=this;for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=this.$store).emit.apply(t,[e].concat(r))}},{key:"nextTick",value:function(e){this.$store.nextTick(e)}},{key:"trigger",value:function(e){var t;this.$store.source=this.source;for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=this.$store).trigger.apply(t,[e].concat(r))}},{key:"broadcast",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];Object.keys(this.children).forEach((function(n){var i;(i=t.children[n]).trigger.apply(i,[e].concat(r))}))}},{key:"on",value:function(e,t){this.$store.on(e,t)}},{key:"off",value:function(e,t){this.$store.off(e,t)}},{key:"subscribe",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r="subscribe.".concat(nn()),i=this.createLocalCallback(r,e);return this.$store.on(r,i,this,t,n,!1,!0),r}}]),n}(cn),BaseStore:hn,Dom:Mt},Ct),{},{registElement:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.keys(e).forEach((function(t){qt.has(t)||qt.set(t,e[t])}))}})}));
