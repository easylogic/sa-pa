var rr=Object.defineProperty,ir=Object.defineProperties;var nr=Object.getOwnPropertyDescriptors;var Ot=Object.getOwnPropertySymbols;var ar=Object.prototype.hasOwnProperty,lr=Object.prototype.propertyIsEnumerable;var q=(i,g,C)=>g in i?rr(i,g,{enumerable:!0,configurable:!0,writable:!0,value:C}):i[g]=C,Lt=(i,g)=>{for(var C in g||(g={}))ar.call(g,C)&&q(i,C,g[C]);if(Ot)for(var C of Ot(g))lr.call(g,C)&&q(i,C,g[C]);return i},Mt=(i,g)=>ir(i,nr(g));var u=(i,g,C)=>(q(i,typeof g!="symbol"?g+"":g,C),C);(function(i,g){typeof exports=="object"&&typeof module!="undefined"?g(exports):typeof define=="function"&&define.amd?define(["exports"],g):(i=typeof globalThis!="undefined"?globalThis:i||self,g(i.sapa={}))})(this,function(i){"use strict";const g=/^@magic\:([a-zA-Z][a-zA-Z0-9]*)[\W]{1}(.*)*$/g,C="@magic:",O="|",kt=/(([\$a-z_\-]+)\([^\(\)]*\)|([a-z_\-]+))/gi,Z="(",_t=")";class L{static make(t,...e){return`${C}${t} ${e.join(O)}`}static check(t){return t.match(g)!==null}static parse(t){const e=t.match(g);if(!e)return;const s=e[0].split("@magic:")[1].split(O).map(c=>c.trim());let[n,...a]=s;const[l,...o]=n.split(" "),E=a.map(c=>this.parsePipe(c)).filter(c=>c.value),m={function:[],keyword:[],value:[]};return E.forEach(c=>{c.type==="function"?m.function.push(c):c.type==="keyword"?m.keyword.push(c):m.value.push(c)}),{originalMethod:t,method:l,args:o,pipes:E,keys:m}}static parsePipe(t){const e=t.match(kt);if(!e)return{type:"value",value:t};const[s]=e;if(s.includes(Z)){const[n,a]=s.split(Z),[l]=a.split(_t);return{type:"function",value:s,func:n,args:l.split(",").map(o=>o.trim()).filter(Boolean)}}return{type:"keyword",value:e[0]}}}const I=(r,t=O)=>` ${t} ${r}`,Pt="ME@",Q=(...r)=>r.join(O),F=(...r)=>Pt+Q(...r),It=F,Dt=F,D=":",J=" ",Ut={},h=(...r)=>{var t=r.join(D);return(...e)=>{const[s,...n]=e;return L.make("domevent",[t,s].join(" "),...n)}},U=(...r)=>L.make("subscribe",...r),Bt=(...r)=>L.make("callback",...r),f=(r,t=O)=>I(r,t),$=(r,t=O)=>I(`after(${r})`,t),wt=(r,t=O)=>I(`before(${r})`,t),Ft=f,$t=f,Vt=f("ArrowUp"),Ht=f("ArrowDown"),Gt=f("ArrowLeft"),Kt=f("ArrowRight"),Wt=f("Enter"),zt=f("Space"),Yt=f("Escape"),Xt=f("Backspace"),jt=f("Delete"),qt=f("Equal"),Zt=f("Minus"),Qt=f("BracketRight"),Jt=f("BracketLeft"),xt=f("isAltKey"),te=f("isShiftKey"),ee=f("isMetaKey"),se=f("isCtrlKey"),re=f("hasMouse"),ie=f("hasTouch"),ne=f("hasPen"),ae=f("self"),x=f("isMouseLeftButton"),le=f("isMouseRightButton"),oe=f("fit"),he=f("passive"),ce=f("domdiff"),tt=(r=100)=>f(`debounce(${r})`),ue=(r=300)=>f(`delay(${r})`),fe=tt(1e3),de=(r=100)=>f(`throttle(${r})`),et=f("allTrigger()"),st=f("selfTrigger()"),Ee=f("frame()"),me=r=>f(`params(${K(r)})`),ge=f("capture()"),Te=$("preventDefault"),pe=$("stopPropagation"),be=U,Ce=(...r)=>U(...r,et),Ae=(...r)=>U(...r,st),Re=(r,...t)=>U(`config:${r}`,...t),rt=Bt,ve=rt("requestAnimationFrame"),N=h,Ne=h("click"),ye=h("dblclick"),Se=h("mousedown"),Oe=h("mouseup"),Le=h("mousemove"),Me=h("mouseover"),ke=h("mouseout"),_e=h("mouseenter"),Pe=h("mouseleave"),Ie=h("touchstart"),De=h("touchmove"),Ue=h("touchend"),Be=h("keydown"),we=h("keyup"),Fe=h("keypress"),$e=h("drag"),Ve=h("dragstart"),He=h("drop"),Ge=h("dragover"),Ke=h("dragenter"),We=h("dragleave"),ze=h("dragexit"),Ye=h("dragout"),Xe=h("dragend"),je=h("contextmenu"),qe=h("change"),Ze=h("input"),Qe=h("focus"),Je=h("focusin"),xe=h("focusout"),ts=h("blur"),es=h("paste"),ss=h("resize"),rs=h("scroll"),is=h("submit"),ns=(...r)=>N("pointerdown")(...r)+x,as=N("pointerover"),ls=N("pointerenter"),os=N("pointerout"),hs=N("pointermove"),cs=N("pointerup"),us=N("change","input"),fs=N("wheel","mousewheel","DOMMouseScroll"),ds=h("animationstart"),Es=h("animationend"),ms=h("animationiteration"),gs=h("transitionstart"),Ts=h("transitionend"),ps=h("transitionrun"),bs=h("transitioncancel"),Cs=N("doubletab"),As=(r="$el")=>L.make("load",r),Rs=r=>Ut[r]||"",it=r=>function(){return this.prevState[r]!=this.state[r]},nt=()=>!0,vs=(r="$el")=>L.make("bind",r);function Ns(r){let t=r.deltaX,e=r.deltaY;return t===0&&r.shiftKey&&([e,t]=[t,e]),r.deltaMode===WheelEvent.DOM_DELTA_LINE?e*=8:r.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(e*=24),[at(t,24),at(e,24),0]}function at(r,t){return Math.sign(r)*Math.min(t,Math.abs(r))}var V={addDomEvent(r,t,e,s=!1){r&&r.addEventListener(t,e,s)},removeDomEvent(r,t,e){r&&r.removeEventListener(t,e)},pos(r){return r.touches&&r.touches[0]?r.touches[0]:r},posXY(r){var t=this.pos(r);return{x:t.pageX,y:t.pageY}}};const ys=()=>!0;function Ss(r,t=ys){let e=r,s=[];do{if(e instanceof Object===!1)break;const a=Object.getOwnPropertyNames(e).filter(l=>r&&v(r[l])&&t(l));s.push.apply(s,a)}while(e=Object.getPrototypeOf(e));return s}function lt(r,t=0){if(t===0)return r;var e=void 0;return function(...s){e&&clearTimeout(e),e=setTimeout(function(){r(...s)},t||300)}}function Os(r,t){return(...e)=>{requestAnimationFrame(()=>{r.apply(t,e)})}}function ot(r,t){var e=void 0;return function(...s){e||(e=setTimeout(function(){r(...s),e=null},t||300))}}function Ls(r,t,e){return(...s)=>{e.every(a=>t[a.target].apply(t,s))&&r.apply(t,s)}}function H(r,t){Object.keys(r).forEach((e,s)=>{t(e,r[e],s)})}function Ms(r){return typeof r=="undefined"||r===null}function M(r){return Ms(r)===!1}function ht(r){return typeof r=="string"}function ct(r){return typeof r=="object"&&!Array.isArray(r)&&!ut(r)&&!ht(r)&&r!==null}function v(r){return typeof r=="function"}function ut(r){return typeof r=="number"}const ft=/[xy]/g;function dt(){var r=new Date().getTime(),t="xxx12-xx-34xx".replace(ft,function(e){var s=(r+Math.random()*16)%16|0;return r=Math.floor(r/16),(e=="x"?s:s&3|8).toString(16)});return t}function Et(){var r=new Date().getTime(),t="idxxxxxxx".replace(ft,function(e){var s=(r+Math.random()*16)%16|0;return r=Math.floor(r/16),(e=="x"?s:s&3|8).toString(16)});return t}const G=new Map,mt={},y=new Map,_=new Map,gt="v:";function K(r,t=""){const e=`${gt}${Et()}`;return y.set(e,r),t&&(_.has(t)||_.set(t,new Set),_.get(t).add(e)),e}function ks(r){_.has(r)&&(_.get(r).forEach(t=>{y.delete(t)}),_.delete(r))}function W(r,t=!0){if(ht(r)===!1)return r;let e=r;return y.has(r)&&(e=y.get(r),t&&y.delete(r)),e}function k(r){return y.has(r)?y.get(r):r}function Tt(r){return y.has(r)}function pt(r){return Object.entries(r).map(([t,e])=>`${t}=${K(e)}`).join(" ")}function _s(r={}){Object.keys(r).forEach(t=>{G.has(t)||G.set(t,r[t])})}function Ps(r,t){mt[r]=t}function Is(r){return mt[r]}function bt(r){return G.get(r)}class z{constructor(t){u(this,"cachedCallback");u(this,"callbacks");u(this,"editor");u(this,"source");u(this,"promiseProxy");this.cachedCallback={},this.callbacks={},this.editor=t,this.promiseProxy=new Proxy(this,{get:(e,s)=>this.makePromiseEvent(s)})}getCallbacks(t){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t]}setCallbacks(t,e=[]){this.callbacks[t]=e}on(t,e,s,n=0,a=0,l=!1,o=!1,E=[],m=!1){var c=e;return n>0?c=lt(e,n):a>0&&(c=ot(e,a)),E.length&&(c=Ls(c,s,E)),m&&(c=Os(c,s)),this.getCallbacks(t).push({event:t,callback:c,context:s,originalCallback:e,enableAllTrigger:l,enableSelfTrigger:o}),this.debug("add message event",t,s==null?void 0:s.sourceName),()=>{this.off(t,e)}}debug(t,e,s){}off(t,e){this.debug("off message event",t),arguments.length==1?this.setCallbacks(t):arguments.length==2&&this.setCallbacks(t,this.getCallbacks(t).filter(s=>s.originalCallback!==e))}offAll(t){Object.keys(this.callbacks).forEach(e=>{this.setCallbacks(e,this.getCallbacks(e).filter(s=>s.context!==t))}),this.debug("off all message",t.sourceName)}getCachedCallbacks(t){return this.getCallbacks(t)}get promise(){return this.promiseProxy}get p(){return this.promise}makePromiseEvent(t){var e=this.getCachedCallbacks(t);const s=this.source;return(...n)=>Promise.all(e.filter(a=>!a.enableSelfTrigger).filter(a=>a.enableAllTrigger||a.originalCallback.source!==s).map(a=>new Promise((l,o)=>{l(a.callback.apply(a.context,n))})))}sendMessage(t,e,...s){this.sendMessageList(t,[[e,...s]])}sendMessageList(t,e=[]){Promise.resolve().then(()=>{e.forEach(([s,...n])=>{var a=this.getCachedCallbacks(s);if(a&&a.length){const l=a.filter(o=>!o.enableSelfTrigger).filter(o=>o.enableAllTrigger||o.originalCallback.source!==t);for(const o of l){const E=o.callback.apply(o.context,n);if(M(E)){if(E===!1)return;if(v(E)){E();return}}}}})})}nextSendMessage(t,e,...s){Promise.resolve().then(()=>{e(...s)})}triggerMessage(t,e,...s){Promise.resolve().then(()=>{var n=this.getCachedCallbacks(e);if(n)for(var a=0,l=n.length;a<l;a++){const o=n[a];o.originalCallback.source===t&&o.callback.apply(o.context,s)}else console.warn(e," is not valid event")})}emit(t,...e){v(t)?t(...e):Array.isArray(t)?this.sendMessageList(this.source,t):this.sendMessage(this.source,t,...e)}nextTick(t){this.nextSendMessage(this.source,t)}trigger(t,...e){v(t)?t(...e):this.triggerMessage(this.source,t,...e)}}const Ds=(r,t,e)=>{e?(r.setAttribute(t,t),r[t]=e):(r.removeAttribute(t),r[t]=e)},Us=(r,t,e)=>{typeof e=="boolean"?Ds(r,t,e):r.setAttribute(t,e)},Bs=(r,t)=>{r.removeAttribute(t),r[t]=!1},ws=(r,t)=>{r.removeAttribute(t)},Fs=(r,t,e)=>{typeof e=="boolean"?Bs(r,t):t&&ws(r,t)},$s=(r,t,e,s)=>{e?(!s||e!==s)&&Us(r,t,e):Fs(r,t,s)},Vs=(r,t={},e={})=>{const s=[];s.push.apply(s,Object.keys(t)),s.push.apply(s,Object.keys(e));const n=[...new Set(s)];for(var a=0,l=n.length;a<l;a++){const o=n[a];$s(r,o,t[o],e[o])}};function Hs(r,t){return r.nodeType===Node.TEXT_NODE&&r.textContent!==t.textContent||r.nodeName!==t.nodeName}function Ct(r){return(r==null?void 0:r.nodeType)===8?!0:r.nodeType!==Node.TEXT_NODE&&r.getAttribute("data-domdiff-pass")==="true"}function Gs(r){return r.nodeType!==Node.TEXT_NODE&&r.getAttribute("refClass")}function At(r){var t={};const e=r.length;for(let s=0;s<e;s++){const n=r[s];t[n.name]=n.value}return t}function Rt(r,t,e,s,n={}){if(!t)r.appendChild(e.cloneNode(!0));else if(!e)r.removeChild(t);else if(!(Ct(t)||Ct(e))){if(Hs(e,t)||Gs(e))r.replaceChild(e.cloneNode(!0),t);else if(e.nodeType!==Node.TEXT_NODE&&e.nodeType!==Node.COMMENT_NODE&&e.toString()!=="[object HTMLUnknownElement]"){n.checkPassed&&n.checkPassed(t,e)||Vs(t,At(e.attributes),At(t.attributes));for(var a=B(t),l=B(e),o=Math.max(a.length,l.length),s=0;s<o;s++)Rt(t,a[s],l[s],s)}}}const B=r=>{var t=r.firstChild;if(!t)return[];var e=[];do e.push(t),t=t.nextSibling;while(t);return e};function Y(r,t,e={}){e.checkPassed=v(e.checkPassed)?e.checkPassed:void 0,e.removedElements=[],r=r.el||r,t=t.el||t;for(var s=B(r),n=B(t),a=Math.max(s.length,n.length),l=0;l<a;l++)Rt(r,s[l],n[l],l,e)}class d{constructor(t,e="",s={}){u(this,"el");if(typeof t!="string")this.el=t;else{var n=document.createElement(t);e&&(n.className=e);for(var a in s)n.setAttribute(a,s[a]);this.el=n}}static create(t,e="",s={}){return new d(t,e,s)}static createByHTML(t){var e=d.create("div"),s=e.html(t).children();return s.length?d.create(s[0].el):null}static getScrollTop(){return Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop)}static getScrollLeft(){return Math.max(window.pageXOffset,document.documentElement.scrollLeft,document.body.scrollLeft)}static parse(t){var e=new DOMParser;return e.parseFromString(t,"text/html")}static body(){return d.create(document.body)}get htmlEl(){return this.el}get inputEl(){return this.el}get svgEl(){return this.el}setAttr(t){return Object.keys(t).forEach(e=>{this.attr(e,t[e])}),this}setAttrNS(t,e="http://www.w3.org/2000/svg"){return Object.keys(t).forEach(s=>{this.attrNS(s,t[s],e)}),this}setProp(t){return Object.keys(t).forEach(e=>{this.htmlEl[e]!=t[e]&&(this.htmlEl[e]=t[e])}),this}data(t,e){return arguments.length===1?this.attr("data-"+t):arguments.length===2?this.attr("data-"+t,e):this}attr(t,e){var s,n;return arguments.length==1?(n=(s=this.htmlEl).getAttribute)==null?void 0:n.call(s,t):(this.htmlEl.getAttribute(t)!=e&&this.htmlEl.setAttribute(t,`${e}`),this)}attrNS(t,e,s="http://www.w3.org/2000/svg"){return arguments.length==1?this.svgEl.getAttributeNS(s,t):(this.svgEl.getAttributeNS(s,t)!=e&&this.svgEl.setAttributeNS(s,t,e),this)}attrKeyValue(t){return{[`${this.htmlEl.getAttribute(t)}`]:this.val()}}attrs(...t){return t.map(e=>this.htmlEl.getAttribute(e))}styles(...t){return t.map(e=>this.htmlEl.style[e])}removeAttr(t){return this.htmlEl.removeAttribute(t),this}removeStyle(t){return this.htmlEl.style.removeProperty(t),this}is(t){return this.htmlEl===(t.el||t)}isTag(t){return this.htmlEl.tagName.toLowerCase()===t.toLowerCase()}closest(t){for(var e=this,s=!1;!(s=e.hasClass(t));)if(e.el.parentNode)e=d.create(e.el.parentNode);else return null;return s?e:null}path(){if(!this.htmlEl)return[];let t=[this],e=this.parent();if(!e.el)return t;for(;e&&(t.unshift(e),e=e.parent(),!!e.el););return t}get $parent(){return this.parent()}parent(){return d.create(this.htmlEl.parentNode)}hasParent(){return!!this.htmlEl.parentNode}removeClass(...t){return this.htmlEl.classList.remove(...t),this}hasClass(t){return this.htmlEl.classList?this.htmlEl.classList.contains(t):!1}addClass(...t){return this.htmlEl.classList.add(...t),this}onlyOneClass(t){var e=this.parent();e.children().forEach(s=>{s.removeClass(t)}),this.addClass(t)}toggleClass(t,e){return this.htmlEl.classList.toggle(t,e),this}html(t){try{return typeof t=="undefined"?this.htmlEl.innerHTML:(typeof t=="string"?Object.assign(this.el,{innerHTML:t}):this.empty().append(t),this)}catch(e){return console.log(e,t),this}}htmlDiff(t){Y(this,t)}updateDiff(t,e="div"){Y(this,d.create(e).html(t))}updateSVGDiff(t,e="div"){Y(this,d.create(e).html(`<svg>${t}</svg>`).firstChild.firstChild)}find(t){return this.htmlEl.querySelector(t)}$(t){var e=this.find(t);return e?d.create(e):null}findAll(t){return Array.from(this.htmlEl.querySelectorAll(t))}$$(t){var e=this.findAll(t);return e.map(s=>d.create(s))}empty(){for(;this.htmlEl.firstChild;)this.htmlEl.removeChild(this.htmlEl.firstChild);return this}append(t){return typeof t=="string"?this.htmlEl.appendChild(document.createTextNode(t)):this.htmlEl.appendChild(t.el||t),this}prepend(t){return typeof t=="string"?this.htmlEl.prepend(document.createTextNode(t)):this.htmlEl.prepend(t.el||t),this}prependHTML(t){var e=d.create("div").html(t);return this.prepend(e.createChildrenFragment()),e}appendHTML(t){var e=d.create("div").html(t);return this.append(e.createChildrenFragment()),e}createChildrenFragment(){const t=this.children();var e=document.createDocumentFragment();return t.forEach(s=>e.appendChild(s.el)),e}appendTo(t){var e=t.el?t.el:t;return e.appendChild(this.htmlEl),this}remove(){return this.htmlEl.parentNode&&this.htmlEl.parentNode.removeChild(this.htmlEl),this}removeChild(t){return this.htmlEl.removeChild(t.el||t),this}text(t){if(typeof t=="undefined")return this.htmlEl.textContent;var e=t;return t instanceof d&&(e=t.text()),this.htmlEl.textContent!==e&&(this.htmlEl.textContent=e),this}css(t,e){const s=this.htmlEl;if(typeof t=="string"&&typeof e!="undefined")t.indexOf("--")===0&&typeof e!="undefined"?s.style.setProperty(t,e):s.style[t]=e;else if(typeof t!="undefined"){if(typeof t=="string")return getComputedStyle(s)[t];Object.entries(t).forEach(([n,a])=>{n.indexOf("--")===0&&typeof a!="undefined"?s.style.setProperty(n,a):s.style[n]=a})}return this}getComputedStyle(...t){var e=getComputedStyle(this.htmlEl),s={};return t.forEach(n=>{s[n]=e[n]}),s}getStyleList(...t){const e=this.htmlEl;for(var s={},n=e.style.length,a=0;a<n;a++){var l=e.style[a];s[l]=e.style[l]}return t.forEach(o=>{s[o]=this.css(o)}),s}cssText(t){const e=this.htmlEl;return typeof t=="undefined"?e.style.cssText:this}cssFloat(t){return parseFloat(this.css(t))}cssInt(t){return parseInt(this.css(t))}px(t,e){return this.css(t,`${e}px`)}rect(){return this.htmlEl.getBoundingClientRect()}bbox(){return this.el.getBBox()}isSVG(){return this.htmlEl.tagName.toUpperCase()==="SVG"}offsetRect(){const t=this.htmlEl;if(this.isSVG()){const e=this.parent().rect(),s=this.rect();return{x:s.x-e.x,y:s.y-e.y,top:s.x-e.x,left:s.y-e.y,width:s.width,height:s.height}}return{x:t.offsetLeft,y:t.offsetTop,top:t.offsetTop,left:t.offsetLeft,width:t.offsetWidth,height:t.offsetHeight}}offset(){var t=this.rect(),e=d.getScrollTop(),s=d.getScrollLeft();return{top:t.top+e,left:t.left+s}}offsetLeft(){return this.offset().left}offsetTop(){return this.offset().top}position(){return this.htmlEl.style.top?{top:parseFloat(this.css("top")),left:parseFloat(this.css("left"))}:this.rect()}size(){return[this.width(),this.height()]}width(){return this.htmlEl.offsetWidth||this.rect().width}contentWidth(){return this.width()-this.cssFloat("padding-left")-this.cssFloat("padding-right")}height(){return this.htmlEl.offsetHeight||this.rect().height}contentHeight(){return this.height()-this.cssFloat("padding-top")-this.cssFloat("padding-bottom")}val(t){if(typeof t=="undefined")return this.inputEl.value;if(typeof t!="undefined"){var e=t;t instanceof d?e=t.val():this.inputEl.value=e}return this}matches(t){return this.htmlEl&&this.htmlEl.matches?this.htmlEl.matches(t)?this:this.parent().matches(t):null}get value(){return this.inputEl.value}get files(){return this.inputEl.files?Array.from(this.inputEl.files):[]}show(t="block"){return this.htmlEl.style.display=t!="none"?t:"block",this}hide(){return this.htmlEl.style.display="none",this}isHide(){return this.htmlEl.style.display==="none"}isShow(){return!this.isHide()}toggle(t){var e=this.isHide();return arguments.length==1?t?this.show():this.hide():e?this.show():this.hide()}scrollIntoView(){this.htmlEl.scrollIntoView()}addScrollLeft(t){return this.htmlEl.scrollLeft+=t,this}addScrollTop(t){return this.htmlEl.scrollTop+=t,this}setScrollTop(t){return this.htmlEl.scrollTop=t,this}setScrollLeft(t){return this.htmlEl.scrollLeft=t,this}scrollTop(){return this.htmlEl===document.body?d.getScrollTop():this.htmlEl.scrollTop}scrollLeft(){return this.htmlEl===document.body?d.getScrollLeft():this.htmlEl.scrollLeft}scrollHeight(){return this.htmlEl.scrollHeight}scrollWidth(){return this.htmlEl.scrollWidth}on(t,e,s){return this.htmlEl.addEventListener(t,e,s),this}off(t,e){return this.htmlEl.removeEventListener(t,e),this}getElement(){return this.htmlEl}createChild(t,e="",s={},n={}){let a=d.create(t,e,s);return a.css(n),this.append(a),a}get firstChild(){return d.create(this.htmlEl.firstElementChild)}children(){var t=this.htmlEl.firstElementChild;if(!t)return[];var e=[];do e.push(d.create(t)),t=t.nextElementSibling;while(t);return e}childLength(){return this.htmlEl.children.length}replace(t){return this.htmlEl.parentNode&&this.htmlEl.parentNode.replaceChild(t.el||t,this.htmlEl),this}replaceChild(t,e){return this.htmlEl.replaceChild(e.el||e,t.el||t),this}checked(t=!1){return arguments.length==0?!!this.inputEl.checked:(this.inputEl.checked=!!t,this)}click(){return this.htmlEl.click(),this}focus(){return this.htmlEl.focus(),this}select(){if(this.attr("contenteditable")==="true"){var t=document.createRange();t.selectNodeContents(this.htmlEl);var e=window.getSelection();e==null||e.removeAllRanges(),e==null||e.addRange(t)}else this.inputEl.select();return this}blur(){return this.htmlEl.blur(),this}}class X{constructor(t,e={}){u(this,"context");u(this,"options");this.context=t,this.options=e}initialize(){}load(){}refresh(){}render(){}getRef(t){return this.context.getRef(t)}run(){}destroy(){}}const Ks={touchstart:!0,touchmove:!0,mousedown:!0,mouseup:!0,mousemove:!0},Ws={doubletab:"touchend"},zs={doubletab:!0};class Ys extends X{constructor(){super(...arguments);u(this,"_domEvents");u(this,"_bindings");u(this,"doubleTab")}initialize(){this.destroy(),!(this._domEvents&&this.context.notEventRedefine)&&(this._domEvents||(this._domEvents=this.context.filterProps("domevent")),this._domEvents.forEach(t=>this.parseDomEvent(t)))}destroy(){this.context.notEventRedefine||this.removeEventAll()}removeEventAll(){var t;(t=this.getBindings())==null||t.forEach(e=>{this.removeDomEvent(e)}),this.initBindings()}removeDomEvent({eventName:t,dom:e,callback:s}){e&&V.removeDomEvent(e,t,s)}getBindings(){return this._bindings||this.initBindings(),this._bindings}addBinding(t){var e;(e=this.getBindings())==null||e.push(t)}initBindings(){this._bindings=[]}matchPath(t,e){return t?t.matches(e)?t:this.matchPath(t.parentElement,e):null}hasDelegate(t,e){return this.matchPath(t.target||t.srcElement,e.delegate)}makeCallback(t,e,s){return t.delegate?this.makeDelegateCallback(t,e,s):this.makeDefaultCallback(t,e,s)}makeDefaultCallback(t,e,s){return n=>{var a=this.runEventCallback(n,t,e,s);if(M(a))return a}}makeDelegateCallback(t,e,s){return n=>{const a=this.hasDelegate(n,t);if(a){n.$dt=d.create(a);var l=this.runEventCallback(n,t,e,s);if(M(l))return l}}}runEventCallback(t,e,s,n){const a=this.context;if(t.xy=V.posXY(t),e.beforeMethods.length&&e.beforeMethods.every(o=>a[o.target].call(a,t,o.param)),this.checkEventType(t,e)){var l=n(t,t.$dt,t.xy);return l!==!1&&e.afterMethods.length&&e.afterMethods.forEach(o=>a[o.target].call(a,t,o.param)),l}}checkEventType(t,e){const s=this.context;var n=!0;e.codes.length&&(n=(t.code?e.codes.indexOf(t.code.toLowerCase())>-1:!1)||(t.key?e.codes.indexOf(t.key.toLowerCase())>-1:!1));var a=!0;return e.checkMethodList.length&&(a=e.checkMethodList.every(l=>{var o=s[l];return v(o)&&o?o.call(s,t):M(o)?!!o:!0})),n&&a}getDefaultDomElement(t){const e=this.context;let s;return typeof t=="string"&&t?s=e.refs[t]||e[t]||window[t]:s=e.el||e.$el||e.$root,s instanceof d?s.getElement():s}getRealEventName(t){return Ws[t]||t}getCustomEventName(t){return zs[t]?t:""}getDefaultEventObject(t,e,s,n,a){const l={eventName:this.getRealEventName(t),customEventName:this.getCustomEventName(t),callback:a},[o,E,...m]=n.args;return l.dom=this.getDefaultDomElement(e),l.delegate=m.join(J),l.beforeMethods=[],l.afterMethods=[],l.codes=[],l.checkMethodList=[],n.pipes.forEach(c=>{var p,R,b,S,P,yt;if(c.type==="function")switch(c.func){case"debounce":var T=+(((p=c.args)==null?void 0:p[0])||0);l.callback=lt(a,T);break;case"throttle":var A=+(((R=c.args)==null?void 0:R[0])||0);l.callback=ot(a,A);break;case"before":l.beforeMethods.push({target:`${(b=c.args)==null?void 0:b[0]}`,param:(S=c.args)==null?void 0:S[1]});break;case"after":l.afterMethods.push({target:`${(P=c.args)==null?void 0:P[0]}`,param:(yt=c.args)==null?void 0:yt[1]});break}else if(c.type==="keyword"){l.codes.push(`${c.value}`.toLowerCase());const St=`${c.value}`;this.context[St]&&l.checkMethodList.push(St)}}),l}addDomEvent(t,e,s){t.callback=this.makeCallback(t,e,s),this.addBinding(t);var n=!1;e.pipes.forEach(a=>{if(a.type==="keyword")switch(a.value){case"capture":n=!0;break}}),Ks[t.eventName]&&(n={passive:!0,capture:n}),(t==null?void 0:t.dom)&&V.addDomEvent(t==null?void 0:t.dom,t.eventName,t.callback,n)}makeCustomEventCallback(t,e,s){if(t.customEventName==="doubletab"){var n=300;return e.pipes.forEach(a=>{var l;if(a.type==="function")switch(a.func){case"delay":n=+(((l=a.args)==null?void 0:l[0])||0);break}}),(...a)=>{this.doubleTab?(performance.now()-this.doubleTab.time<n&&(s==null||s(...a)),this.doubleTab=null):this.doubleTab={time:performance.now()}}}return s}bindingDomEvent([t,e,...s],n,a){let l=this.getDefaultEventObject(t,e,s,n,a);l.callback=this.makeCustomEventCallback(l,n,l.callback),this.addDomEvent(l,n,l.callback)}getEventNames(t){let e=[];return t.split(D).forEach(s=>{var n=s.split(D);e.push.apply(e,n)}),e}parseDomEvent(t){const e=this.context;var s=t.args;if(s){var n=this.getEventNames(s[0]),a=e[t.originalMethod].bind(e);for(let l=0,o=n.length;l<o;l++)s[0]=n[l],this.bindingDomEvent(s,t,a)}}}const Xs=(r,t)=>{if(ut(t))switch(r){case"width":case"height":case"top":case"left":case"right":case"bottom":return t+"px"}return t},vt=(r,t,e)=>{if(t==="cssText"){r.cssText(e);return}else if(t==="style"){if(typeof e!="string"){const a={};Object.entries(e).forEach(([l,o])=>{a[l]=Xs(l,o)}),r.css(e)}return}else if(t==="class"){if(Array.isArray(e))r.addClass(...e==null?void 0:e.filter(Boolean));else if(ct(e)){const a=Object.keys(e);for(var s=0,n=a.length;s<n;s++){const l=a[s],o=e[l];r.toggleClass(l,o)}}else r.htmlEl.className=e;return}else if(t==="callback"&&typeof e=="function"){e();return}typeof e=="undefined"?r.removeAttr(t):r.el.nodeName==="TEXTAREA"&&t==="value"||t==="text"||t==="textContent"?r.text(e):t==="innerHTML"||t==="html"?r.html(e):t==="htmlDiff"?r.updateDiff(e):t==="svgDiff"?r.updateSVGDiff(e):t==="value"?r.val(e):r.attr(t,e)};class js extends X{constructor(){super(...arguments);u(this,"_bindMethods")}load(...t){this.bindData(...t)}async bindLocalValue(t){let e=this.context.refBindVariables;t&&(e={[t]:this.context.refBindVariables[t]}),Object.values(e).forEach(async s=>{const n=s.callback;let a=this.context.refs[s.ref];if(a){const E=await n.call(this.context);if(!E)return;const m=Object.keys(E);for(var l=0,o=m.length;l<o;l++){const c=m[l],T=E[c];vt(a,c,T)}}})}bindData(...t){var s;this._bindMethods||(this._bindMethods=this.context.filterProps("bind")),this.bindLocalValue(...t);const e=(s=this._bindMethods)==null?void 0:s.filter(n=>t.length?t.indexOf(n.args[0])>-1:!0);e==null||e.forEach(async n=>{const a=this.context[n.originalMethod];let l=null;n.pipes.forEach(p=>{p.type==="keyword"&&(l=this.getRef(`${p.value}`))});let o=nt;typeof l=="string"&&l!==""?o=it(l):typeof l=="function"&&(o=l);const E=n.args[0];let m=this.context.refs[E];const c=typeof o=="function"&&o.call(this.context);if(m&&c){const p=await a.call(this.context,...t);if(!p)return;const R=Object.keys(p);for(var T=0,A=R.length;T<A;T++){const b=R[T],S=p[b];vt(m,b,S)}}})}destroy(){this._bindMethods=void 0}}class qs extends X{constructor(){super(...arguments);u(this,"_callbacks",[]);u(this,"_bindings")}initialize(){this.destroy(),this._callbacks||(this._callbacks=this.context.filterProps("callback")),this._callbacks.forEach(t=>this.parseCallback(t))}destroy(){this.context.notEventRedefine||this.removeCallbackAll()}removeCallbackAll(){this.getBindings().forEach(t=>{this.removeCallback(t)}),this.initBindings()}removeCallback({animationFrameId:t}){cancelAnimationFrame(t)}getBindings(){return this._bindings||this.initBindings(),this._bindings}addBinding(t){this.getBindings().push(t)}initBindings(){this._bindings=[]}makeCallback(t,e){const s=n=>{e(n),t.requestId=requestAnimationFrame(s)};return()=>{t.requestId=requestAnimationFrame(s)}}getDefaultCallbackObject(t,e){const s=this.context;e.filter(a=>!!s[a])}addCallback(t,e){t.callback=this.makeCallback(t,e),this.addBinding(t),t.callback()}bindingCallback(t,e,s){}parseCallback(t){}}const w="ref",Zs="bind",Qs="load",Nt=d.create("div"),Js=`[${w}]`,j="refclass",xs=`[${j}]`;class tr{constructor(t,e){u(this,"state");u(this,"prevState");u(this,"children");u(this,"id");u(this,"__tempVariables");u(this,"handlers");u(this,"_loadMethods");u(this,"__cachedMethodList");u(this,"el");u(this,"$el");u(this,"$root");u(this,"refs");u(this,"opt");u(this,"parent");u(this,"props");u(this,"source");u(this,"sourceName");u(this,"childComponents");u(this,"_localTimestamp");u(this,"refLoadVariables");u(this,"refBindVariables");u(this,"_$store");this.state={},this.prevState={},this.refs={},this.refLoadVariables={},this.refBindVariables={},this.children={},this._localTimestamp=0,this.id=dt(),this.__tempVariables=new Map,this.handlers=this.initializeHandler(),this.initializeProperty(t,e),this.initComponents()}get $store(){return this._$store}set $store(t){this._$store=t}get _timestamp(){return this._localTimestamp++}get target(){var t;return(t=this.$el)==null?void 0:t.el}initializeProperty(t,e={}){this.opt=t||{},this.parent=this.opt,this.props=e,this.source=dt(),this.sourceName=this.constructor.name}initComponents(){this.childComponents=this.components()}initializeHandler(){return[new js(this),new Ys(this),new qs(this)]}initState(){return{}}setState(t={},e=!0){this.prevState=this.state,this.state=Object.assign({},this.state,t),e&&this.load()}toggleState(t,e=!0){this.setState({[t]:!this.state[t]},e)}apply(t){return pt(t)}_reload(t,e){e&&this.render(e),this.props=t,this.state={},this.setState(this.initState(),!1),this.refresh()}render(t){this.$el=this.parseTemplate(`${this.template()}`),this.refs.$el=this.$el,t&&t.append(this.$el),this.load(),this.afterRender()}initialize(){this.state=this.initState()}afterRender(){}components(){return{}}getRef(...t){const e=t.join("");return this.refs[e]}parseTemplate(t,e=!1){Array.isArray(t)&&(t=t.join("")),t=t.trim();const s=Nt.html(t).children();for(var n=0,a=s.length;n<a;n++){const T=s[n];var l=T.attr(w);l&&(this.refs[l]=T);for(var o=T.$$(Js),E={},m=0,c=o.length;m<c;m++){const A=o[m],p=A.attr(w);E[p]?console.warn(`${l} is duplicated. - ${this.sourceName}`,this):E[p]=!0,this.refs[p]=A;const R=A.attr(Qs),b=k(R),S=A.attr(Zs),P=k(S);R&&v(b)&&(this.refLoadVariables[p]={key:R,ref:p,callback:b}),S&&v(P)&&(this.refBindVariables[p]={key:S,ref:p,callback:P})}}return!e&&s.length?s[0]:d.create(Nt.createChildrenFragment())}parsePropertyInfo(t){let e={};for(var s of t.htmlEl.attributes)if(Tt(s.nodeName)){const a=k(s.nodeName);ct(a)?e=Object.assign(e,a):e[s.nodeName]=k(s.nodeValue)}else e[s.nodeName]=k(s.nodeValue);const n=t.html();return n&&(e.content=n,e.contentChildren=this.parseContent(e.content)),e}parseSourceName(t){return t.parent?[t.sourceName,...this.parseSourceName(t.parent)]:[t.sourceName]}getEventMachineComponent(t){var e=bt(t)||this.childComponents[t];return e}createInstanceForComponent(t,e,s={}){return t.__proto__.name==="ProxyComponent"?new t({target:e,props:s}):new t(this,s)}renderComponent({$dom:t,refName:e,component:s,props:n}){var l;var a=null;this.children[e]?(a=this.children[e],a.__timestamp=this._localTimestamp,a._reload(n)):(a=this.createInstanceForComponent(s,t.$parent.el,n),a.__timestamp=this._localTimestamp,this.children[e||a.id]=a,v(a.render)&&a.render()),a.renderTarget?((l=a.$el)==null||l.appendTo(a.renderTarget),t.remove()):a.$el?t.replace(a.$el):t.remove()}parseContent(t,e=[]){return d.create("div").html(t).children().map(s=>this._getComponentInfo(s)).filter(s=>e.length===0?!0:e.includes(s.refClass))}_getComponentInfo(t){const e=t.attr(j),s=this.getEventMachineComponent(e);if(s){let n=this.parsePropertyInfo(t),a=t.attr(w);return{$dom:t,refClass:e,props:n,refName:a||n.ref,component:s}}else return{notUsed:!0,$dom:t}}getComponentInfoList(t){if(!t)return[];const e=[];return t.$$(xs).filter(n=>n.path().filter(a=>a.attr(j)).length===1).forEach(n=>{e.push(this._getComponentInfo(n))}),e}parseComponent(){const t=this.$el;this.getComponentInfoList(t).forEach(s=>{s.notUsed?s.$dom.remove():this.renderComponent(s)}),H(this.children,(s,n)=>{n.__timestamp!==this._localTimestamp&&n.clean()})}clean(){if(this.$el&&!this.$el.hasParent())return H(this.children,(t,e)=>{v(e==null?void 0:e.clean)&&e.clean()}),this.destroy(),this.$el=null,!0}refresh(){this.load()}_afterLoad(){this.runHandlers("initialize"),this.bindData(),this.parseComponent()}async loadLocalValue(t){let e=this.refLoadVariables;t&&(e={[t]:this.refLoadVariables[t]}),Object.keys(e).forEach(async s=>{const n=this.refLoadVariables[s],a=n.domdiff;var l=await n.callback.call(this);Array.isArray(l)&&(l=l.join(""));const o=this.parseTemplate(l,!0);a?this.refs[n.ref].htmlDiff(o):this.refs[n.ref].html(o)})}async load(...t){this._loadMethods||(this._loadMethods=this.filterProps("load")),await this.loadLocalValue(...t),this._loadMethods.filter(s=>t.length===0?!0:s.args[0]===t[0]).forEach(async s=>{const[n,...a]=s.args,l=!!s.keys.domdiff;if(this.refs[n]){var E=await this[s.originalMethod].call(this,...a);Array.isArray(E)&&(E=E.join(""));const m=this.parseTemplate(E,!0);l?this.refs[n].htmlDiff(m):this.refs[n].html(m)}}),this._afterLoad()}runHandlers(t="run",...e){this.handlers.forEach(s=>s[t](...e))}bindData(...t){this.runHandlers("load",...t)}template(){return null}eachChildren(t){!v(t)||H(this.children,(e,s)=>{t(s)})}rerender(){var t=this.$el.parent();this.destroy(),this.render(t)}destroy(){this.eachChildren(t=>{t.destroy()}),this.runHandlers("destroy"),this.$el&&this.$el.remove(),this.$el=null,this.refs={},this.children={},Object.values(this.refLoadVariables).forEach(t=>{W(t.key,!0)}),Object.values(this.refBindVariables).forEach(t=>{W(t.key,!0)}),this.refLoadVariables={},this.refBindVariables={}}collectProps(){return this.__cachedMethodList||(this.__cachedMethodList=Ss(this,t=>L.check(t)).map(t=>L.parse(t))),this.__cachedMethodList}filterProps(t){return this.collectProps().filter(e=>e.method===t)}self(t){return t&&t.$dt&&t.$dt.is(t.target)}isAltKey(t){return t.altKey}isCtrlKey(t){return t.ctrlKey}isShiftKey(t){return t.shiftKey}isMetaKey(t){return t.metaKey||t.key=="Meta"||t.code.indexOf("Meta")>-1}isMouseLeftButton(t){return t.buttons===1}isMouseRightButton(t){return t.buttons===2}hasMouse(t){return t.pointerType==="mouse"}hasTouch(t){return t.pointerType==="touch"}hasPen(t){return t.pointerType==="pen"}preventDefault(t){return t.preventDefault(),!0}stopPropagation(t){return t.stopPropagation(),!0}}class er extends tr{constructor(t,e={}){super(t,e);u(this,"__storeInstance");u(this,"attributes");u(this,"notEventRedefine");(e==null?void 0:e.store)?this.__storeInstance=e.store:this.__storeInstance=new z,this.notEventRedefine=!0,this.created(),this.initialize(),this.initializeStoreEvent()}setStore(t){this.__storeInstance=t}get $store(){return this.__storeInstance||this.parent.$store}created(){}getRealEventName(t,e){var s=t.indexOf(e);return t.substr(s<0?0:s+e.length)}createLocalCallback(t,e){var s=e.bind(this);return s.displayName=`${this.sourceName}.${t}`,s.source=this.source,s}initializeStoreEvent(){this.filterProps("subscribe").forEach(t=>{const e=t.args.join(" "),s=[],n=[];let a=0,l=0,o=!1,E=!1,m=!1;t.pipes.forEach(T=>{var A,p,R;if(T.type==="function")switch(T.func){case"debounce":a=+(((A=T.args)==null?void 0:A[0])||0);break;case"throttle":l=+(((p=T.args)==null?void 0:p[0])||0);break;case"allTrigger":o=!0;break;case"selfTrigger":E=!0;break;case"frame":m=!0;break;case"params":const b=k((R=T.args)==null?void 0:R[0]);M(b.debounce)&&(a=b.debounce),M(b.throttle)&&(l=b.throttle),M(b.frame)&&(m=b.frame);break}else if(T.type==="keyword"){const b=`${T.value}`;this[b]?s.push(b):n.push(b)}});const c=this[t.originalMethod];[...n,e].filter(Boolean).forEach(T=>{var A=this.createLocalCallback(T,c);this.$store.on(T,A,this,a,l,o,E,s,m)})})}destoryStoreSUBSCRIBE(){this.$store.offAll(this)}destroy(){super.destroy(),this.destoryStoreSUBSCRIBE()}rerender(){super.rerender(),this.initialize(),this.initializeStoreEvent()}emit(t,...e){this.$store.source=this.source,this.$store.sourceContext=this,this.$store.emit(t,...e)}nextTick(t,e=0){setTimeout(()=>{this.$store.nextTick(t)},e)}trigger(t,...e){this.$store.source=this.source,this.$store.trigger(t,...e)}broadcast(t,...e){Object.keys(this.children).forEach(s=>{this.children[s].trigger(t,...e),this.children[s].broadcast(t,...e)})}on(t,e,s=0,n=0,a=!1,l=!1,o=!1){this.$store.on(t,e,this,s,n,a,l,[],o)}off(t,e){this.$store.off(t,e,this)}subscribe(t,e=0,s=0){const n=`subscribe.${Et()}`,a=this.createLocalCallback(n,t);return this.$store.on(n,a,this,e,s,!1,!0),n}}const sr=(r,t={})=>{const e=d.create((t==null?void 0:t.container)||document.body),s=new r(t,Mt(Lt({},t),{store:t.store||new z}));return s.render(e),s};i.AFTER=$,i.ALL_TRIGGER=et,i.ALT=xt,i.ANIMATIONEND=Es,i.ANIMATIONITERATION=ms,i.ANIMATIONSTART=ds,i.ARROW_DOWN=Ht,i.ARROW_LEFT=Gt,i.ARROW_RIGHT=Kt,i.ARROW_UP=Vt,i.BACKSPACE=Xt,i.BEFORE=wt,i.BIND=vs,i.BIND_CHECK_DEFAULT_FUNCTION=nt,i.BIND_CHECK_FUNCTION=it,i.BLUR=ts,i.BRACKET_LEFT=Jt,i.BRACKET_RIGHT=Qt,i.BaseStore=z,i.CALLBACK=rt,i.CAPTURE=ge,i.CHANGE=qe,i.CHANGEINPUT=us,i.CHECKER=f,i.CLICK=Ne,i.COMMAND=It,i.CONFIG=Re,i.CONTEXTMENU=je,i.CONTROL=se,i.CUSTOM=N,i.D1000=fe,i.DEBOUNCE=tt,i.DELAY=ue,i.DELETE=jt,i.DOMDIFF=ce,i.DOUBLECLICK=ye,i.DOUBLETAB=Cs,i.DRAG=$e,i.DRAGEND=Xe,i.DRAGENTER=Ke,i.DRAGEXIT=ze,i.DRAGLEAVE=We,i.DRAGOUT=Ye,i.DRAGOVER=Ge,i.DRAGSTART=Ve,i.DROP=He,i.Dom=d,i.ENTER=Wt,i.EQUAL=qt,i.ESCAPE=Yt,i.EVENT=F,i.FIT=oe,i.FOCUS=Qe,i.FOCUSIN=Je,i.FOCUSOUT=xe,i.FRAME=Ee,i.IF=Ft,i.INPUT=Ze,i.KEY=$t,i.KEYDOWN=Be,i.KEYPRESS=Fe,i.KEYUP=we,i.LEFT_BUTTON=x,i.LOAD=As,i.META=ee,i.MINUS=Zt,i.MOUSE=re,i.MOUSEDOWN=Se,i.MOUSEENTER=_e,i.MOUSELEAVE=Pe,i.MOUSEMOVE=Le,i.MOUSEOUT=ke,i.MOUSEOVER=Me,i.MOUSEUP=Oe,i.NAME_SAPARATOR=D,i.ON=Dt,i.PARAMS=me,i.PASSIVE=he,i.PASTE=es,i.PEN=ne,i.PIPE=Q,i.POINTEREND=cs,i.POINTERENTER=ls,i.POINTERMOVE=hs,i.POINTEROUT=os,i.POINTEROVER=as,i.POINTERSTART=ns,i.PREVENT=Te,i.RAF=ve,i.RESIZE=ss,i.RIGHT_BUTTON=le,i.SAPARATOR=J,i.SCROLL=rs,i.SELF=ae,i.SELF_TRIGGER=st,i.SHIFT=te,i.SPACE=zt,i.STOP=pe,i.SUBMIT=is,i.SUBSCRIBE=be,i.SUBSCRIBE_ALL=Ce,i.SUBSCRIBE_SELF=Ae,i.THROTTLE=de,i.TOUCH=ie,i.TOUCHEND=Ue,i.TOUCHMOVE=De,i.TOUCHSTART=Ie,i.TRANSITIONCANCEL=bs,i.TRANSITIONEND=Ts,i.TRANSITIONRUN=ps,i.TRANSITIONSTART=gs,i.UIElement=er,i.VARIABLE_SAPARATOR=gt,i.WHEEL=fs,i.getRef=Rs,i.getVariable=k,i.hasVariable=Tt,i.initializeGroupVariables=ks,i.makeEventChecker=I,i.normalizeWheelEvent=Ns,i.recoverVariable=W,i.registAlias=Ps,i.registElement=_s,i.retriveAlias=Is,i.retriveElement=bt,i.spreadVariable=pt,i.start=sr,i.variable=K,Object.defineProperty(i,"__esModule",{value:!0}),i[Symbol.toStringTag]="Module"});
