var er=Object.defineProperty,sr=Object.defineProperties;var rr=Object.getOwnPropertyDescriptors;var St=Object.getOwnPropertySymbols;var ir=Object.prototype.hasOwnProperty,nr=Object.prototype.propertyIsEnumerable;var X=(i,m,A)=>m in i?er(i,m,{enumerable:!0,configurable:!0,writable:!0,value:A}):i[m]=A,yt=(i,m)=>{for(var A in m||(m={}))ir.call(m,A)&&X(i,A,m[A]);if(St)for(var A of St(m))nr.call(m,A)&&X(i,A,m[A]);return i},Ot=(i,m)=>sr(i,rr(m));var c=(i,m,A)=>(X(i,typeof m!="symbol"?m+"":m,A),A);(function(i,m){typeof exports=="object"&&typeof module!="undefined"?m(exports):typeof define=="function"&&define.amd?define(["exports"],m):(i=typeof globalThis!="undefined"?globalThis:i||self,m(i.sapa={}))})(this,function(i){"use strict";const m=/^@magic\:([a-zA-Z][a-zA-Z0-9]*)[\W]{1}(.*)*$/g,A="@magic:",y="|",Mt=/(([\$a-z_\-]+)\([^\(\)]*\)|([a-z_\-]+))/gi,q="(",Lt=")";class O{static make(t,...e){return`${A}${t} ${e.join(y)}`}static check(t){return t.match(m)!==null}static parse(t){const e=t.match(m);if(!e)return;const s=e[0].split("@magic:")[1].split(y).map(f=>f.trim());let[a,...n]=s;const[l,...o]=a.split(" "),E=n.map(f=>this.parsePipe(f)).filter(f=>f.value),g={function:[],keyword:[],value:[]};return E.forEach(f=>{f.type==="function"?g.function.push(f):f.type==="keyword"?g.keyword.push(f):g.value.push(f)}),{originalMethod:t,method:l,args:o,pipes:E,keys:g}}static parsePipe(t){const e=t.match(Mt);if(!e)return{type:"value",value:t};const[s]=e;if(s.includes(q)){const[a,n]=s.split(q),[l]=n.split(Lt);return{type:"function",value:s,func:a,args:l.split(",").map(o=>o.trim()).filter(Boolean)}}return{type:"keyword",value:e[0]}}}const k=(r,t=y)=>` ${t} ${r}`,_t="ME@",j=(...r)=>r.join(y),F=(...r)=>_t+j(...r),kt=F,It=F,I=":",Z=" ",Pt={},h=(...r)=>{var t=r.join(I);return(...e)=>{const[s,...a]=e;return O.make("domevent",[t,s].join(" "),...a)}},P=(...r)=>O.make("subscribe",...r),Dt=(...r)=>O.make("callback",...r),u=(r,t=y)=>k(r,t),w=(r,t=y)=>k(`after(${r})`,t),Ut=(r,t=y)=>k(`before(${r})`,t),Bt=u,Ft=u,wt=u("ArrowUp"),$t=u("ArrowDown"),Ht=u("ArrowLeft"),Gt=u("ArrowRight"),Vt=u("Enter"),Kt=u("Space"),Wt=u("Escape"),zt=u("Backspace"),Yt=u("Delete"),Xt=u("Equal"),qt=u("Minus"),jt=u("BracketRight"),Zt=u("BracketLeft"),Qt=u("isAltKey"),Jt=u("isShiftKey"),xt=u("isMetaKey"),te=u("isCtrlKey"),ee=u("hasMouse"),se=u("hasTouch"),re=u("hasPen"),ie=u("self"),Q=u("isMouseLeftButton"),ne=u("isMouseRightButton"),ae=u("fit"),le=u("passive"),oe=u("domdiff"),J=(r=100)=>u(`debounce(${r})`),he=(r=300)=>u(`delay(${r})`),ce=J(1e3),ue=(r=100)=>u(`throttle(${r})`),x=u("allTrigger()"),tt=u("selfTrigger()"),fe=u("frame()"),de=r=>u(`params(${V(r)})`),Ee=u("capture()"),me=w("preventDefault"),ge=w("stopPropagation"),Te=P,pe=(...r)=>P(...r,x),Ce=(...r)=>P(...r,tt),Ae=(r,...t)=>P(`config:${r}`,...t),et=Dt,be=et("requestAnimationFrame"),R=h,Re=h("click"),Ne=h("dblclick"),ve=h("mousedown"),Se=h("mouseup"),ye=h("mousemove"),Oe=h("mouseover"),Me=h("mouseout"),Le=h("mouseenter"),_e=h("mouseleave"),ke=h("touchstart"),Ie=h("touchmove"),Pe=h("touchend"),De=h("keydown"),Ue=h("keyup"),Be=h("keypress"),Fe=h("drag"),we=h("dragstart"),$e=h("drop"),He=h("dragover"),Ge=h("dragenter"),Ve=h("dragleave"),Ke=h("dragexit"),We=h("dragout"),ze=h("dragend"),Ye=h("contextmenu"),Xe=h("change"),qe=h("input"),je=h("focus"),Ze=h("focusin"),Qe=h("focusout"),Je=h("blur"),xe=h("paste"),ts=h("resize"),es=h("scroll"),ss=h("submit"),rs=(...r)=>R("pointerdown")(...r)+Q,is=R("pointerover"),ns=R("pointerenter"),as=R("pointerout"),ls=R("pointermove"),os=R("pointerup"),hs=R("change","input"),cs=R("wheel","mousewheel","DOMMouseScroll"),us=h("animationstart"),fs=h("animationend"),ds=h("animationiteration"),Es=h("transitionstart"),ms=h("transitionend"),gs=h("transitionrun"),Ts=h("transitioncancel"),ps=R("doubletab"),Cs=(r="$el")=>O.make("load",r),As=r=>Pt[r]||"",st=r=>function(){return this.prevState[r]!=this.state[r]},rt=()=>!0,bs=(r="$el")=>O.make("bind",r);function Rs(r){let t=r.deltaX,e=r.deltaY;return t===0&&r.shiftKey&&([e,t]=[t,e]),r.deltaMode===WheelEvent.DOM_DELTA_LINE?e*=8:r.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(e*=24),[it(t,24),it(e,24),0]}function it(r,t){return Math.sign(r)*Math.min(t,Math.abs(r))}var $={addDomEvent(r,t,e,s=!1){r&&r.addEventListener(t,e,s)},removeDomEvent(r,t,e){r&&r.removeEventListener(t,e)},pos(r){return r.touches&&r.touches[0]?r.touches[0]:r},posXY(r){var t=this.pos(r);return{x:t.pageX,y:t.pageY}}};const Ns=()=>!0;function vs(r,t=Ns){let e=r,s=[];do{if(e instanceof Object===!1)break;const n=Object.getOwnPropertyNames(e).filter(l=>r&&N(r[l])&&t(l));s.push.apply(s,n)}while(e=Object.getPrototypeOf(e));return s}function nt(r,t=0){if(t===0)return r;var e=void 0;return function(...s){e&&clearTimeout(e),e=setTimeout(function(){r(...s)},t||300)}}function Ss(r,t){return(...e)=>{requestAnimationFrame(()=>{r.apply(t,e)})}}function at(r,t){var e=void 0;return function(...s){e||(e=setTimeout(function(){r(...s),e=null},t||300))}}function ys(r,t,e){return(...s)=>{e.every(n=>t[n.target].apply(t,s))&&r.apply(t,s)}}function H(r,t){Object.keys(r).forEach((e,s)=>{t(e,r[e],s)})}function Os(r){return typeof r=="undefined"||r===null}function M(r){return Os(r)===!1}function lt(r){return typeof r=="string"}function ot(r){return typeof r=="object"&&!Array.isArray(r)&&!ht(r)&&!lt(r)&&r!==null}function N(r){return typeof r=="function"}function ht(r){return typeof r=="number"}const ct=/[xy]/g;function ut(){var r=new Date().getTime(),t="xxx12-xx-34xx".replace(ct,function(e){var s=(r+Math.random()*16)%16|0;return r=Math.floor(r/16),(e=="x"?s:s&3|8).toString(16)});return t}function ft(){var r=new Date().getTime(),t="idxxxxxxx".replace(ct,function(e){var s=(r+Math.random()*16)%16|0;return r=Math.floor(r/16),(e=="x"?s:s&3|8).toString(16)});return t}const G=new Map,dt={},v=new Map,L=new Map,Et="v:";function V(r,t=""){const e=`${Et}${ft()}`;return v.set(e,r),t&&(L.has(t)||L.set(t,new Set),L.get(t).add(e)),e}function Ms(r){L.has(r)&&(L.get(r).forEach(t=>{v.delete(t)}),L.delete(r))}function Ls(r,t=!0){if(lt(r)===!1)return r;let e=r;return v.has(r)&&(e=v.get(r),t&&v.delete(r)),e}function _(r){return v.has(r)?v.get(r):r}function mt(r){return v.has(r)}function gt(r){return Object.entries(r).map(([t,e])=>`${t}=${V(e)}`).join(" ")}function _s(r={}){Object.keys(r).forEach(t=>{G.has(t)||G.set(t,r[t])})}function ks(r,t){dt[r]=t}function Is(r){return dt[r]}function Tt(r){return G.get(r)}class K{constructor(t){c(this,"cachedCallback");c(this,"callbacks");c(this,"editor");c(this,"source");c(this,"promiseProxy");this.cachedCallback={},this.callbacks={},this.editor=t,this.promiseProxy=new Proxy(this,{get:(e,s)=>this.makePromiseEvent(s)})}getCallbacks(t){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t]}setCallbacks(t,e=[]){this.callbacks[t]=e}on(t,e,s,a=0,n=0,l=!1,o=!1,E=[],g=!1){var f=e;return a>0?f=nt(e,a):n>0&&(f=at(e,n)),E.length&&(f=ys(f,s,E)),g&&(f=Ss(f,s)),this.getCallbacks(t).push({event:t,callback:f,context:s,originalCallback:e,enableAllTrigger:l,enableSelfTrigger:o}),this.debug("add message event",t,s==null?void 0:s.sourceName),()=>{this.off(t,e)}}debug(t,e,s){}off(t,e){this.debug("off message event",t),arguments.length==1?this.setCallbacks(t):arguments.length==2&&this.setCallbacks(t,this.getCallbacks(t).filter(s=>s.originalCallback!==e))}offAll(t){Object.keys(this.callbacks).forEach(e=>{this.setCallbacks(e,this.getCallbacks(e).filter(s=>s.context!==t))}),this.debug("off all message",t.sourceName)}getCachedCallbacks(t){return this.getCallbacks(t)}get promise(){return this.promiseProxy}get p(){return this.promise}makePromiseEvent(t){var e=this.getCachedCallbacks(t);const s=this.source;return(...a)=>Promise.all(e.filter(n=>!n.enableSelfTrigger).filter(n=>n.enableAllTrigger||n.originalCallback.source!==s).map(n=>new Promise((l,o)=>{l(n.callback.apply(n.context,a))})))}sendMessage(t,e,...s){this.sendMessageList(t,[[e,...s]])}sendMessageList(t,e=[]){Promise.resolve().then(()=>{e.forEach(([s,...a])=>{var n=this.getCachedCallbacks(s);if(n&&n.length){const l=n.filter(o=>!o.enableSelfTrigger).filter(o=>o.enableAllTrigger||o.originalCallback.source!==t);for(const o of l){const E=o.callback.apply(o.context,a);if(M(E)){if(E===!1)return;if(N(E)){E();return}}}}})})}nextSendMessage(t,e,...s){Promise.resolve().then(()=>{e(...s)})}triggerMessage(t,e,...s){Promise.resolve().then(()=>{var a=this.getCachedCallbacks(e);if(a)for(var n=0,l=a.length;n<l;n++){const o=a[n];o.originalCallback.source===t&&o.callback.apply(o.context,s)}else console.warn(e," is not valid event")})}emit(t,...e){N(t)?t(...e):Array.isArray(t)?this.sendMessageList(this.source,t):this.sendMessage(this.source,t,...e)}nextTick(t){this.nextSendMessage(this.source,t)}trigger(t,...e){N(t)?t(...e):this.triggerMessage(this.source,t,...e)}}const Ps=(r,t,e)=>{e?(r.setAttribute(t,t),r[t]=e):(r.removeAttribute(t),r[t]=e)},Ds=(r,t,e)=>{typeof e=="boolean"?Ps(r,t,e):r.setAttribute(t,e)},Us=(r,t)=>{r.removeAttribute(t),r[t]=!1},Bs=(r,t)=>{r.removeAttribute(t)},Fs=(r,t,e)=>{typeof e=="boolean"?Us(r,t):t&&Bs(r,t)},ws=(r,t,e,s)=>{e?(!s||e!==s)&&Ds(r,t,e):Fs(r,t,s)},$s=(r,t={},e={})=>{const s=[];s.push.apply(s,Object.keys(t)),s.push.apply(s,Object.keys(e));const a=[...new Set(s)];for(var n=0,l=a.length;n<l;n++){const o=a[n];ws(r,o,t[o],e[o])}};function Hs(r,t){return r.nodeType===Node.TEXT_NODE&&r.textContent!==t.textContent||r.nodeName!==t.nodeName}function pt(r){return(r==null?void 0:r.nodeType)===8?!0:r.nodeType!==Node.TEXT_NODE&&r.getAttribute("data-domdiff-pass")==="true"}function Gs(r){return r.nodeType!==Node.TEXT_NODE&&r.getAttribute("refClass")}function Ct(r){var t={};const e=r.length;for(let s=0;s<e;s++){const a=r[s];t[a.name]=a.value}return t}function At(r,t,e,s,a={}){if(!t)r.appendChild(e.cloneNode(!0));else if(!e)r.removeChild(t);else if(!(pt(t)||pt(e))){if(Hs(e,t)||Gs(e))r.replaceChild(e.cloneNode(!0),t);else if(e.nodeType!==Node.TEXT_NODE&&e.nodeType!==Node.COMMENT_NODE&&e.toString()!=="[object HTMLUnknownElement]"){a.checkPassed&&a.checkPassed(t,e)||$s(t,Ct(e.attributes),Ct(t.attributes));for(var n=D(t),l=D(e),o=Math.max(n.length,l.length),s=0;s<o;s++)At(t,n[s],l[s],s)}}}const D=r=>{var t=r.firstChild;if(!t)return[];var e=[];do e.push(t),t=t.nextSibling;while(t);return e};function W(r,t,e={}){e.checkPassed=N(e.checkPassed)?e.checkPassed:void 0,e.removedElements=[],r=r.el||r,t=t.el||t;for(var s=D(r),a=D(t),n=Math.max(s.length,a.length),l=0;l<n;l++)At(r,s[l],a[l],l,e)}class d{constructor(t,e="",s={}){c(this,"el");if(typeof t!="string")this.el=t;else{var a=document.createElement(t);e&&(a.className=e);for(var n in s)a.setAttribute(n,s[n]);this.el=a}}static create(t,e="",s={}){return new d(t,e,s)}static createByHTML(t){var e=d.create("div"),s=e.html(t).children();return s.length?d.create(s[0].el):null}static getScrollTop(){return Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop)}static getScrollLeft(){return Math.max(window.pageXOffset,document.documentElement.scrollLeft,document.body.scrollLeft)}static parse(t){var e=new DOMParser;return e.parseFromString(t,"text/html")}static body(){return d.create(document.body)}get htmlEl(){return this.el}get inputEl(){return this.el}get svgEl(){return this.el}setAttr(t){return Object.keys(t).forEach(e=>{this.attr(e,t[e])}),this}setAttrNS(t,e="http://www.w3.org/2000/svg"){return Object.keys(t).forEach(s=>{this.attrNS(s,t[s],e)}),this}setProp(t){return Object.keys(t).forEach(e=>{this.htmlEl[e]!=t[e]&&(this.htmlEl[e]=t[e])}),this}data(t,e){return arguments.length===1?this.attr("data-"+t):arguments.length===2?this.attr("data-"+t,e):this}attr(t,e){var s,a;return arguments.length==1?(a=(s=this.htmlEl).getAttribute)==null?void 0:a.call(s,t):(this.htmlEl.getAttribute(t)!=e&&this.htmlEl.setAttribute(t,`${e}`),this)}attrNS(t,e,s="http://www.w3.org/2000/svg"){return arguments.length==1?this.svgEl.getAttributeNS(s,t):(this.svgEl.getAttributeNS(s,t)!=e&&this.svgEl.setAttributeNS(s,t,e),this)}attrKeyValue(t){return{[`${this.htmlEl.getAttribute(t)}`]:this.val()}}attrs(...t){return t.map(e=>this.htmlEl.getAttribute(e))}styles(...t){return t.map(e=>this.htmlEl.style[e])}removeAttr(t){return this.htmlEl.removeAttribute(t),this}removeStyle(t){return this.htmlEl.style.removeProperty(t),this}is(t){return this.htmlEl===(t.el||t)}isTag(t){return this.htmlEl.tagName.toLowerCase()===t.toLowerCase()}closest(t){for(var e=this,s=!1;!(s=e.hasClass(t));)if(e.el.parentNode)e=d.create(e.el.parentNode);else return null;return s?e:null}path(){if(!this.htmlEl)return[];let t=[this],e=this.parent();if(!e.el)return t;for(;e&&(t.unshift(e),e=e.parent(),!!e.el););return t}get $parent(){return this.parent()}parent(){return d.create(this.htmlEl.parentNode)}hasParent(){return!!this.htmlEl.parentNode}removeClass(...t){return this.htmlEl.classList.remove(...t),this}hasClass(t){return this.htmlEl.classList?this.htmlEl.classList.contains(t):!1}addClass(...t){return this.htmlEl.classList.add(...t),this}onlyOneClass(t){var e=this.parent();e.children().forEach(s=>{s.removeClass(t)}),this.addClass(t)}toggleClass(t,e){return this.htmlEl.classList.toggle(t,e),this}html(t){try{return typeof t=="undefined"?this.htmlEl.innerHTML:(typeof t=="string"?Object.assign(this.el,{innerHTML:t}):this.empty().append(t),this)}catch(e){return console.log(e,t),this}}htmlDiff(t){W(this,t)}updateDiff(t,e="div"){W(this,d.create(e).html(t))}updateSVGDiff(t,e="div"){W(this,d.create(e).html(`<svg>${t}</svg>`).firstChild.firstChild)}find(t){return this.htmlEl.querySelector(t)}$(t){var e=this.find(t);return e?d.create(e):null}findAll(t){return Array.from(this.htmlEl.querySelectorAll(t))}$$(t){var e=this.findAll(t);return e.map(s=>d.create(s))}empty(){for(;this.htmlEl.firstChild;)this.htmlEl.removeChild(this.htmlEl.firstChild);return this}append(t){return typeof t=="string"?this.htmlEl.appendChild(document.createTextNode(t)):this.htmlEl.appendChild(t.el||t),this}prepend(t){return typeof t=="string"?this.htmlEl.prepend(document.createTextNode(t)):this.htmlEl.prepend(t.el||t),this}prependHTML(t){var e=d.create("div").html(t);return this.prepend(e.createChildrenFragment()),e}appendHTML(t){var e=d.create("div").html(t);return this.append(e.createChildrenFragment()),e}createChildrenFragment(){const t=this.children();var e=document.createDocumentFragment();return t.forEach(s=>e.appendChild(s.el)),e}appendTo(t){var e=t.el?t.el:t;return e.appendChild(this.htmlEl),this}remove(){return this.htmlEl.parentNode&&this.htmlEl.parentNode.removeChild(this.htmlEl),this}removeChild(t){return this.htmlEl.removeChild(t.el||t),this}text(t){if(typeof t=="undefined")return this.htmlEl.textContent;var e=t;return t instanceof d&&(e=t.text()),this.htmlEl.textContent!==e&&(this.htmlEl.textContent=e),this}css(t,e){const s=this.htmlEl;if(typeof t=="string"&&typeof e!="undefined")t.indexOf("--")===0&&typeof e!="undefined"?s.style.setProperty(t,e):s.style[t]=e;else if(typeof t!="undefined"){if(typeof t=="string")return getComputedStyle(s)[t];Object.entries(t).forEach(([a,n])=>{a.indexOf("--")===0&&typeof n!="undefined"?s.style.setProperty(a,n):s.style[a]=n})}return this}getComputedStyle(...t){var e=getComputedStyle(this.htmlEl),s={};return t.forEach(a=>{s[a]=e[a]}),s}getStyleList(...t){const e=this.htmlEl;for(var s={},a=e.style.length,n=0;n<a;n++){var l=e.style[n];s[l]=e.style[l]}return t.forEach(o=>{s[o]=this.css(o)}),s}cssText(t){const e=this.htmlEl;return typeof t=="undefined"?e.style.cssText:this}cssFloat(t){return parseFloat(this.css(t))}cssInt(t){return parseInt(this.css(t))}px(t,e){return this.css(t,`${e}px`)}rect(){return this.htmlEl.getBoundingClientRect()}bbox(){return this.el.getBBox()}isSVG(){return this.htmlEl.tagName.toUpperCase()==="SVG"}offsetRect(){const t=this.htmlEl;if(this.isSVG()){const e=this.parent().rect(),s=this.rect();return{x:s.x-e.x,y:s.y-e.y,top:s.x-e.x,left:s.y-e.y,width:s.width,height:s.height}}return{x:t.offsetLeft,y:t.offsetTop,top:t.offsetTop,left:t.offsetLeft,width:t.offsetWidth,height:t.offsetHeight}}offset(){var t=this.rect(),e=d.getScrollTop(),s=d.getScrollLeft();return{top:t.top+e,left:t.left+s}}offsetLeft(){return this.offset().left}offsetTop(){return this.offset().top}position(){return this.htmlEl.style.top?{top:parseFloat(this.css("top")),left:parseFloat(this.css("left"))}:this.rect()}size(){return[this.width(),this.height()]}width(){return this.htmlEl.offsetWidth||this.rect().width}contentWidth(){return this.width()-this.cssFloat("padding-left")-this.cssFloat("padding-right")}height(){return this.htmlEl.offsetHeight||this.rect().height}contentHeight(){return this.height()-this.cssFloat("padding-top")-this.cssFloat("padding-bottom")}val(t){if(typeof t=="undefined")return this.inputEl.value;if(typeof t!="undefined"){var e=t;t instanceof d?e=t.val():this.inputEl.value=e}return this}matches(t){return this.htmlEl&&this.htmlEl.matches?this.htmlEl.matches(t)?this:this.parent().matches(t):null}get value(){return this.inputEl.value}get files(){return this.inputEl.files?Array.from(this.inputEl.files):[]}show(t="block"){return this.htmlEl.style.display=t!="none"?t:"block",this}hide(){return this.htmlEl.style.display="none",this}isHide(){return this.htmlEl.style.display==="none"}isShow(){return!this.isHide()}toggle(t){var e=this.isHide();return arguments.length==1?t?this.show():this.hide():e?this.show():this.hide()}scrollIntoView(){this.htmlEl.scrollIntoView()}addScrollLeft(t){return this.htmlEl.scrollLeft+=t,this}addScrollTop(t){return this.htmlEl.scrollTop+=t,this}setScrollTop(t){return this.htmlEl.scrollTop=t,this}setScrollLeft(t){return this.htmlEl.scrollLeft=t,this}scrollTop(){return this.htmlEl===document.body?d.getScrollTop():this.htmlEl.scrollTop}scrollLeft(){return this.htmlEl===document.body?d.getScrollLeft():this.htmlEl.scrollLeft}scrollHeight(){return this.htmlEl.scrollHeight}scrollWidth(){return this.htmlEl.scrollWidth}on(t,e,s){return this.htmlEl.addEventListener(t,e,s),this}off(t,e){return this.htmlEl.removeEventListener(t,e),this}getElement(){return this.htmlEl}createChild(t,e="",s={},a={}){let n=d.create(t,e,s);return n.css(a),this.append(n),n}get firstChild(){return d.create(this.htmlEl.firstElementChild)}children(){var t=this.htmlEl.firstElementChild;if(!t)return[];var e=[];do e.push(d.create(t)),t=t.nextElementSibling;while(t);return e}childLength(){return this.htmlEl.children.length}replace(t){return this.htmlEl.parentNode&&this.htmlEl.parentNode.replaceChild(t.el||t,this.htmlEl),this}replaceChild(t,e){return this.htmlEl.replaceChild(e.el||e,t.el||t),this}checked(t=!1){return arguments.length==0?!!this.inputEl.checked:(this.inputEl.checked=!!t,this)}click(){return this.htmlEl.click(),this}focus(){return this.htmlEl.focus(),this}select(){if(this.attr("contenteditable")==="true"){var t=document.createRange();t.selectNodeContents(this.htmlEl);var e=window.getSelection();e==null||e.removeAllRanges(),e==null||e.addRange(t)}else this.inputEl.select();return this}blur(){return this.htmlEl.blur(),this}}class z{constructor(t,e={}){c(this,"context");c(this,"options");this.context=t,this.options=e}initialize(){}load(){}refresh(){}render(){}getRef(t){return this.context.getRef(t)}run(){}destroy(){}}const Vs={touchstart:!0,touchmove:!0,mousedown:!0,mouseup:!0,mousemove:!0},Ks={doubletab:"touchend"},Ws={doubletab:!0};class zs extends z{constructor(){super(...arguments);c(this,"_domEvents");c(this,"_bindings");c(this,"doubleTab")}initialize(){this.destroy(),!(this._domEvents&&this.context.notEventRedefine)&&(this._domEvents||(this._domEvents=this.context.filterProps("domevent")),this._domEvents.forEach(t=>this.parseDomEvent(t)))}destroy(){this.context.notEventRedefine||this.removeEventAll()}removeEventAll(){var t;(t=this.getBindings())==null||t.forEach(e=>{this.removeDomEvent(e)}),this.initBindings()}removeDomEvent({eventName:t,dom:e,callback:s}){e&&$.removeDomEvent(e,t,s)}getBindings(){return this._bindings||this.initBindings(),this._bindings}addBinding(t){var e;(e=this.getBindings())==null||e.push(t)}initBindings(){this._bindings=[]}matchPath(t,e){return t?t.matches(e)?t:this.matchPath(t.parentElement,e):null}hasDelegate(t,e){return this.matchPath(t.target||t.srcElement,e.delegate)}makeCallback(t,e,s){return t.delegate?this.makeDelegateCallback(t,e,s):this.makeDefaultCallback(t,e,s)}makeDefaultCallback(t,e,s){return a=>{var n=this.runEventCallback(a,t,e,s);if(M(n))return n}}makeDelegateCallback(t,e,s){return a=>{const n=this.hasDelegate(a,t);if(n){a.$dt=d.create(n);var l=this.runEventCallback(a,t,e,s);if(M(l))return l}}}runEventCallback(t,e,s,a){const n=this.context;if(t.xy=$.posXY(t),e.beforeMethods.length&&e.beforeMethods.every(o=>n[o.target].call(n,t,o.param)),this.checkEventType(t,e)){var l=a(t,t.$dt,t.xy);return l!==!1&&e.afterMethods.length&&e.afterMethods.forEach(o=>n[o.target].call(n,t,o.param)),l}}checkEventType(t,e){const s=this.context;var a=!0;e.codes.length&&(a=(t.code?e.codes.indexOf(t.code.toLowerCase())>-1:!1)||(t.key?e.codes.indexOf(t.key.toLowerCase())>-1:!1));var n=!0;return e.checkMethodList.length&&(n=e.checkMethodList.every(l=>{var o=s[l];return N(o)&&o?o.call(s,t):M(o)?!!o:!0})),a&&n}getDefaultDomElement(t){const e=this.context;let s;return typeof t=="string"&&t?s=e.refs[t]||e[t]||window[t]:s=e.el||e.$el||e.$root,s instanceof d?s.getElement():s}getRealEventName(t){return Ks[t]||t}getCustomEventName(t){return Ws[t]?t:""}getDefaultEventObject(t,e,s,a,n){const l={eventName:this.getRealEventName(t),customEventName:this.getCustomEventName(t),callback:n},[o,E,...g]=a.args;return l.dom=this.getDefaultDomElement(e),l.delegate=g.join(Z),l.beforeMethods=[],l.afterMethods=[],l.codes=[],l.checkMethodList=[],a.pipes.forEach(f=>{var p,S,C,B,Rt,Nt;if(f.type==="function")switch(f.func){case"debounce":var T=+(((p=f.args)==null?void 0:p[0])||0);l.callback=nt(n,T);break;case"throttle":var b=+(((S=f.args)==null?void 0:S[0])||0);l.callback=at(n,b);break;case"before":l.beforeMethods.push({target:`${(C=f.args)==null?void 0:C[0]}`,param:(B=f.args)==null?void 0:B[1]});break;case"after":l.afterMethods.push({target:`${(Rt=f.args)==null?void 0:Rt[0]}`,param:(Nt=f.args)==null?void 0:Nt[1]});break}else if(f.type==="keyword"){l.codes.push(`${f.value}`.toLowerCase());const vt=`${f.value}`;this.context[vt]&&l.checkMethodList.push(vt)}}),l}addDomEvent(t,e,s){t.callback=this.makeCallback(t,e,s),this.addBinding(t);var a=!1;e.pipes.forEach(n=>{if(n.type==="keyword")switch(n.value){case"capture":a=!0;break}}),Vs[t.eventName]&&(a={passive:!0,capture:a}),(t==null?void 0:t.dom)&&$.addDomEvent(t==null?void 0:t.dom,t.eventName,t.callback,a)}makeCustomEventCallback(t,e,s){if(t.customEventName==="doubletab"){var a=300;return e.pipes.forEach(n=>{var l;if(n.type==="function")switch(n.func){case"delay":a=+(((l=n.args)==null?void 0:l[0])||0);break}}),(...n)=>{this.doubleTab?(performance.now()-this.doubleTab.time<a&&(s==null||s(...n)),this.doubleTab=null):this.doubleTab={time:performance.now()}}}return s}bindingDomEvent([t,e,...s],a,n){let l=this.getDefaultEventObject(t,e,s,a,n);l.callback=this.makeCustomEventCallback(l,a,l.callback),this.addDomEvent(l,a,l.callback)}getEventNames(t){let e=[];return t.split(I).forEach(s=>{var a=s.split(I);e.push.apply(e,a)}),e}parseDomEvent(t){const e=this.context;var s=t.args;if(s){var a=this.getEventNames(s[0]),n=e[t.originalMethod].bind(e);for(let l=0,o=a.length;l<o;l++)s[0]=a[l],this.bindingDomEvent(s,t,n)}}}const Ys=(r,t)=>{if(ht(t))switch(r){case"width":case"height":case"top":case"left":case"right":case"bottom":return t+"px"}return t},Xs=(r,t,e)=>{if(t==="cssText"){r.cssText(e);return}else if(t==="style"){if(typeof e!="string"){const n={};Object.entries(e).forEach(([l,o])=>{n[l]=Ys(l,o)}),r.css(e)}return}else if(t==="class"){if(Array.isArray(e))r.addClass(...e==null?void 0:e.filter(Boolean));else if(ot(e)){const n=Object.keys(e);for(var s=0,a=n.length;s<a;s++){const l=n[s],o=e[l];r.toggleClass(l,o)}}else r.htmlEl.className=e;return}else if(t==="callback"&&typeof e=="function"){e();return}typeof e=="undefined"?r.removeAttr(t):r.el.nodeName==="TEXTAREA"&&t==="value"||t==="text"||t==="textContent"?r.text(e):t==="innerHTML"||t==="html"?r.html(e):t==="htmlDiff"?r.updateDiff(e):t==="svgDiff"?r.updateSVGDiff(e):t==="value"?r.val(e):r.attr(t,e)};class qs extends z{constructor(){super(...arguments);c(this,"_bindMethods")}load(...t){this.bindData(...t)}bindData(...t){var s;this._bindMethods||(this._bindMethods=this.context.filterProps("bind"));const e=(s=this._bindMethods)==null?void 0:s.filter(a=>t.length?t.indexOf(a.args[0])>-1:!0);e==null||e.forEach(async a=>{const n=this.context[a.originalMethod];let l=null;a.pipes.forEach(p=>{p.type==="keyword"&&(l=this.getRef(`${p.value}`))});let o=rt;typeof l=="string"&&l!==""?o=st(l):typeof l=="function"&&(o=l);const E=a.args[0];let g=this.context.refs[E];const f=typeof o=="function"&&o.call(this.context);if(g&&f){const p=await n.call(this.context,...t);if(!p)return;const S=Object.keys(p);for(var T=0,b=S.length;T<b;T++){const C=S[T],B=p[C];Xs(g,C,B)}}})}destroy(){this._bindMethods=void 0}}class js extends z{constructor(){super(...arguments);c(this,"_callbacks",[]);c(this,"_bindings")}initialize(){this.destroy(),this._callbacks||(this._callbacks=this.context.filterProps("callback")),this._callbacks.forEach(t=>this.parseCallback(t))}destroy(){this.context.notEventRedefine||this.removeCallbackAll()}removeCallbackAll(){this.getBindings().forEach(t=>{this.removeCallback(t)}),this.initBindings()}removeCallback({animationFrameId:t}){cancelAnimationFrame(t)}getBindings(){return this._bindings||this.initBindings(),this._bindings}addBinding(t){this.getBindings().push(t)}initBindings(){this._bindings=[]}makeCallback(t,e){const s=a=>{e(a),t.requestId=requestAnimationFrame(s)};return()=>{t.requestId=requestAnimationFrame(s)}}getDefaultCallbackObject(t,e){const s=this.context;e.filter(n=>!!s[n])}addCallback(t,e){t.callback=this.makeCallback(t,e),this.addBinding(t),t.callback()}bindingCallback(t,e,s){}parseCallback(t){}}const U="ref",bt=d.create("div"),Zs=`[${U}]`,Y="refclass",Qs=`[${Y}]`;class Js{constructor(t,e){c(this,"state");c(this,"prevState");c(this,"children");c(this,"id");c(this,"__tempVariables");c(this,"handlers");c(this,"_loadMethods");c(this,"__cachedMethodList");c(this,"el");c(this,"$el");c(this,"$root");c(this,"refs");c(this,"opt");c(this,"parent");c(this,"props");c(this,"source");c(this,"sourceName");c(this,"childComponents");c(this,"_localTimestamp");c(this,"_$store");this.state={},this.prevState={},this.refs={},this.children={},this._localTimestamp=0,this.id=ut(),this.__tempVariables=new Map,this.handlers=this.initializeHandler(),this.initializeProperty(t,e),this.initComponents()}get $store(){return this._$store}set $store(t){this._$store=t}get _timestamp(){return this._localTimestamp++}get target(){var t;return(t=this.$el)==null?void 0:t.el}initializeProperty(t,e={}){this.opt=t||{},this.parent=this.opt,this.props=e,this.source=ut(),this.sourceName=this.constructor.name}initComponents(){this.childComponents=this.components()}initializeHandler(){return[new qs(this),new zs(this),new js(this)]}initState(){return{}}setState(t={},e=!0){this.prevState=this.state,this.state=Object.assign({},this.state,t),e&&this.load()}toggleState(t,e=!0){this.setState({[t]:!this.state[t]},e)}apply(t){return gt(t)}_reload(t,e){e&&this.render(e),this.props=t,this.state={},this.setState(this.initState(),!1),this.refresh()}render(t){this.$el=this.parseTemplate(`${this.template()}`),this.refs.$el=this.$el,t&&t.append(this.$el),this.load(),this.afterRender()}initialize(){this.state=this.initState()}afterRender(){}components(){return{}}getRef(...t){const e=t.join("");return this.refs[e]}parseTemplate(t,e=!1){Array.isArray(t)&&(t=t.join("")),t=t.trim();const s=bt.html(t).children();for(var a=0,n=s.length;a<n;a++){const T=s[a];var l=T.attr(U);l&&(this.refs[l]=T);for(var o=T.$$(Zs),E={},g=0,f=o.length;g<f;g++){const b=o[g],p=b.attr(U);E[p]?console.warn(`${l} is duplicated. - ${this.sourceName}`,this):E[p]=!0,this.refs[p]=b}}return!e&&s.length?s[0]:d.create(bt.createChildrenFragment())}parsePropertyInfo(t){let e={};for(var s of t.htmlEl.attributes)if(mt(s.nodeName)){const n=_(s.nodeName);ot(n)?e=Object.assign(e,n):e[s.nodeName]=_(s.nodeValue)}else e[s.nodeName]=_(s.nodeValue);const a=t.html();return a&&(e.content=a,e.contentChildren=this.parseContent(e.content)),e}parseSourceName(t){return t.parent?[t.sourceName,...this.parseSourceName(t.parent)]:[t.sourceName]}getEventMachineComponent(t){var e=Tt(t)||this.childComponents[t];return e}createInstanceForComponent(t,e,s={}){return t.__proto__.name==="ProxyComponent"?new t({target:e,props:s}):new t(this,s)}renderComponent({$dom:t,refName:e,component:s,props:a}){var l;var n=null;this.children[e]?(n=this.children[e],n.__timestamp=this._localTimestamp,n._reload(a)):(n=this.createInstanceForComponent(s,t.$parent.el,a),n.__timestamp=this._localTimestamp,this.children[e||n.id]=n,N(n.render)&&n.render()),n.renderTarget?((l=n.$el)==null||l.appendTo(n.renderTarget),t.remove()):n.$el?t.replace(n.$el):t.remove()}parseContent(t,e=[]){return d.create("div").html(t).children().map(s=>this._getComponentInfo(s)).filter(s=>e.length===0?!0:e.includes(s.refClass))}_getComponentInfo(t){const e=t.attr(Y),s=this.getEventMachineComponent(e);if(s){let a=this.parsePropertyInfo(t),n=t.attr(U);return{$dom:t,refClass:e,props:a,refName:n||a.ref,component:s}}else return{notUsed:!0,$dom:t}}getComponentInfoList(t){if(!t)return[];const e=[];return t.$$(Qs).filter(a=>a.path().filter(n=>n.attr(Y)).length===1).forEach(a=>{e.push(this._getComponentInfo(a))}),e}parseComponent(){const t=this.$el;this.getComponentInfoList(t).forEach(s=>{s.notUsed?s.$dom.remove():this.renderComponent(s)}),H(this.children,(s,a)=>{a.__timestamp!==this._localTimestamp&&a.clean()})}clean(){if(this.$el&&!this.$el.hasParent())return H(this.children,(t,e)=>{N(e==null?void 0:e.clean)&&e.clean()}),this.destroy(),this.$el=null,!0}refresh(){this.load()}_afterLoad(){this.runHandlers("initialize"),this.bindData(),this.parseComponent()}async load(...t){this._loadMethods||(this._loadMethods=this.filterProps("load")),await this._loadMethods.filter(s=>t.length===0?!0:s.args[0]===t[0]).forEach(async s=>{const[a,...n]=s.args,l=!!s.keys.domdiff;if(this.refs[a]){var E=await this[s.originalMethod].call(this,...n);Array.isArray(E)&&(E=E.join(""));const g=this.parseTemplate(E,!0);l?this.refs[a].htmlDiff(g):this.refs[a].html(g)}}),this._afterLoad()}runHandlers(t="run",...e){this.handlers.forEach(s=>s[t](...e))}bindData(...t){this.runHandlers("load",...t)}template(){return null}eachChildren(t){!N(t)||H(this.children,(e,s)=>{t(s)})}rerender(){var t=this.$el.parent();this.destroy(),this.render(t)}destroy(){this.eachChildren(t=>{t.destroy()}),this.runHandlers("destroy"),this.$el&&this.$el.remove(),this.$el=null,this.refs={},this.children={}}collectProps(){return this.__cachedMethodList||(this.__cachedMethodList=vs(this,t=>O.check(t)).map(t=>O.parse(t))),this.__cachedMethodList}filterProps(t){return this.collectProps().filter(e=>e.method===t)}self(t){return t&&t.$dt&&t.$dt.is(t.target)}isAltKey(t){return t.altKey}isCtrlKey(t){return t.ctrlKey}isShiftKey(t){return t.shiftKey}isMetaKey(t){return t.metaKey||t.key=="Meta"||t.code.indexOf("Meta")>-1}isMouseLeftButton(t){return t.buttons===1}isMouseRightButton(t){return t.buttons===2}hasMouse(t){return t.pointerType==="mouse"}hasTouch(t){return t.pointerType==="touch"}hasPen(t){return t.pointerType==="pen"}preventDefault(t){return t.preventDefault(),!0}stopPropagation(t){return t.stopPropagation(),!0}}class xs extends Js{constructor(t,e={}){super(t,e);c(this,"__storeInstance");c(this,"attributes");c(this,"notEventRedefine");(e==null?void 0:e.store)?this.__storeInstance=e.store:this.__storeInstance=new K,this.notEventRedefine=!0,this.created(),this.initialize(),this.initializeStoreEvent()}setStore(t){this.__storeInstance=t}get $store(){return this.__storeInstance||this.parent.$store}created(){}getRealEventName(t,e){var s=t.indexOf(e);return t.substr(s<0?0:s+e.length)}createLocalCallback(t,e){var s=e.bind(this);return s.displayName=`${this.sourceName}.${t}`,s.source=this.source,s}initializeStoreEvent(){this.filterProps("subscribe").forEach(t=>{const e=t.args.join(" "),s=[],a=[];let n=0,l=0,o=!1,E=!1,g=!1;t.pipes.forEach(T=>{var b,p,S;if(T.type==="function")switch(T.func){case"debounce":n=+(((b=T.args)==null?void 0:b[0])||0);break;case"throttle":l=+(((p=T.args)==null?void 0:p[0])||0);break;case"allTrigger":o=!0;break;case"selfTrigger":E=!0;break;case"frame":g=!0;break;case"params":const C=_((S=T.args)==null?void 0:S[0]);M(C.debounce)&&(n=C.debounce),M(C.throttle)&&(l=C.throttle),M(C.frame)&&(g=C.frame);break}else if(T.type==="keyword"){const C=`${T.value}`;this[C]?s.push(C):a.push(C)}});const f=this[t.originalMethod];[...a,e].filter(Boolean).forEach(T=>{var b=this.createLocalCallback(T,f);this.$store.on(T,b,this,n,l,o,E,s,g)})})}destoryStoreSUBSCRIBE(){this.$store.offAll(this)}destroy(){super.destroy(),this.destoryStoreSUBSCRIBE()}rerender(){super.rerender(),this.initialize(),this.initializeStoreEvent()}emit(t,...e){this.$store.source=this.source,this.$store.sourceContext=this,this.$store.emit(t,...e)}nextTick(t,e=0){setTimeout(()=>{this.$store.nextTick(t)},e)}trigger(t,...e){this.$store.source=this.source,this.$store.trigger(t,...e)}broadcast(t,...e){Object.keys(this.children).forEach(s=>{this.children[s].trigger(t,...e),this.children[s].broadcast(t,...e)})}on(t,e,s=0,a=0,n=!1,l=!1,o=!1){this.$store.on(t,e,this,s,a,n,l,[],o)}off(t,e){this.$store.off(t,e,this)}subscribe(t,e=0,s=0){const a=`subscribe.${ft()}`,n=this.createLocalCallback(a,t);return this.$store.on(a,n,this,e,s,!1,!0),a}}const tr=(r,t={})=>{const e=d.create((t==null?void 0:t.container)||document.body),s=new r(t,Ot(yt({},t),{store:t.store||new K}));return s.render(e),s};i.AFTER=w,i.ALL_TRIGGER=x,i.ALT=Qt,i.ANIMATIONEND=fs,i.ANIMATIONITERATION=ds,i.ANIMATIONSTART=us,i.ARROW_DOWN=$t,i.ARROW_LEFT=Ht,i.ARROW_RIGHT=Gt,i.ARROW_UP=wt,i.BACKSPACE=zt,i.BEFORE=Ut,i.BIND=bs,i.BIND_CHECK_DEFAULT_FUNCTION=rt,i.BIND_CHECK_FUNCTION=st,i.BLUR=Je,i.BRACKET_LEFT=Zt,i.BRACKET_RIGHT=jt,i.BaseStore=K,i.CALLBACK=et,i.CAPTURE=Ee,i.CHANGE=Xe,i.CHANGEINPUT=hs,i.CHECKER=u,i.CLICK=Re,i.COMMAND=kt,i.CONFIG=Ae,i.CONTEXTMENU=Ye,i.CONTROL=te,i.CUSTOM=R,i.D1000=ce,i.DEBOUNCE=J,i.DELAY=he,i.DELETE=Yt,i.DOMDIFF=oe,i.DOUBLECLICK=Ne,i.DOUBLETAB=ps,i.DRAG=Fe,i.DRAGEND=ze,i.DRAGENTER=Ge,i.DRAGEXIT=Ke,i.DRAGLEAVE=Ve,i.DRAGOUT=We,i.DRAGOVER=He,i.DRAGSTART=we,i.DROP=$e,i.Dom=d,i.ENTER=Vt,i.EQUAL=Xt,i.ESCAPE=Wt,i.EVENT=F,i.FIT=ae,i.FOCUS=je,i.FOCUSIN=Ze,i.FOCUSOUT=Qe,i.FRAME=fe,i.IF=Bt,i.INPUT=qe,i.KEY=Ft,i.KEYDOWN=De,i.KEYPRESS=Be,i.KEYUP=Ue,i.LEFT_BUTTON=Q,i.LOAD=Cs,i.META=xt,i.MINUS=qt,i.MOUSE=ee,i.MOUSEDOWN=ve,i.MOUSEENTER=Le,i.MOUSELEAVE=_e,i.MOUSEMOVE=ye,i.MOUSEOUT=Me,i.MOUSEOVER=Oe,i.MOUSEUP=Se,i.NAME_SAPARATOR=I,i.ON=It,i.PARAMS=de,i.PASSIVE=le,i.PASTE=xe,i.PEN=re,i.PIPE=j,i.POINTEREND=os,i.POINTERENTER=ns,i.POINTERMOVE=ls,i.POINTEROUT=as,i.POINTEROVER=is,i.POINTERSTART=rs,i.PREVENT=me,i.RAF=be,i.RESIZE=ts,i.RIGHT_BUTTON=ne,i.SAPARATOR=Z,i.SCROLL=es,i.SELF=ie,i.SELF_TRIGGER=tt,i.SHIFT=Jt,i.SPACE=Kt,i.STOP=ge,i.SUBMIT=ss,i.SUBSCRIBE=Te,i.SUBSCRIBE_ALL=pe,i.SUBSCRIBE_SELF=Ce,i.THROTTLE=ue,i.TOUCH=se,i.TOUCHEND=Pe,i.TOUCHMOVE=Ie,i.TOUCHSTART=ke,i.TRANSITIONCANCEL=Ts,i.TRANSITIONEND=ms,i.TRANSITIONRUN=gs,i.TRANSITIONSTART=Es,i.UIElement=xs,i.VARIABLE_SAPARATOR=Et,i.WHEEL=cs,i.getRef=As,i.getVariable=_,i.hasVariable=mt,i.initializeGroupVariables=Ms,i.makeEventChecker=k,i.normalizeWheelEvent=Rs,i.recoverVariable=Ls,i.registAlias=ks,i.registElement=_s,i.retriveAlias=Is,i.retriveElement=Tt,i.spreadVariable=gt,i.start=tr,i.variable=V,Object.defineProperty(i,"__esModule",{value:!0}),i[Symbol.toStringTag]="Module"});
